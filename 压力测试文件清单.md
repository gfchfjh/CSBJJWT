# KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ - åŽ‹åŠ›æµ‹è¯•æ–‡ä»¶æ¸…å•

## ðŸ“ æ–‡ä»¶ç»“æž„

```
workspace/
â”œâ”€â”€ åŽ‹åŠ›æµ‹è¯•è„šæœ¬/
â”‚   â”œâ”€â”€ stress_test.py                      # åŽŸæœ‰åŽ‹åŠ›æµ‹è¯•
â”‚   â”œâ”€â”€ comprehensive_stress_test.py        # å…¨é¢åŽ‹åŠ›æµ‹è¯•  
â”‚   â”œâ”€â”€ module_specific_stress_test.py      # æ¨¡å—ä¸“é¡¹æµ‹è¯•
â”‚   â””â”€â”€ demo_stress_test.py                 # æ¼”ç¤ºæµ‹è¯•ï¼ˆæ— éœ€æœåŠ¡ï¼‰
â”‚
â”œâ”€â”€ è¿è¡Œè„šæœ¬/
â”‚   â”œâ”€â”€ run_all_stress_tests.sh             # Linux/macOSè‡ªåŠ¨åŒ–è¿è¡Œ
â”‚   â””â”€â”€ run_all_stress_tests.bat            # Windowsè‡ªåŠ¨åŒ–è¿è¡Œ
â”‚
â”œâ”€â”€ å·¥å…·è„šæœ¬/
â”‚   â””â”€â”€ generate_test_summary.py            # æµ‹è¯•æŠ¥å‘Šæ±‡æ€»ç”Ÿæˆå™¨
â”‚
â”œâ”€â”€ æ–‡æ¡£/
â”‚   â”œâ”€â”€ åŽ‹åŠ›æµ‹è¯•è¯´æ˜Ž.md                      # å®Œæ•´ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ åŽ‹åŠ›æµ‹è¯•å®Œæˆæ€»ç»“.md                  # é¡¹ç›®å®Œæˆæ€»ç»“
â”‚   â””â”€â”€ åŽ‹åŠ›æµ‹è¯•æ–‡ä»¶æ¸…å•.md                  # æœ¬æ–‡ä»¶
â”‚
â””â”€â”€ æµ‹è¯•ç»“æžœ/
    â””â”€â”€ test_results/                       # æµ‹è¯•æŠ¥å‘Šè¾“å‡ºç›®å½•
        â”œâ”€â”€ *.json                          # JSONæ ¼å¼æŠ¥å‘Š
        â”œâ”€â”€ *.md                            # Markdownæ ¼å¼æŠ¥å‘Š
        â””â”€â”€ *.log                           # æµ‹è¯•æ‰§è¡Œæ—¥å¿—
```

---

## ðŸ“„ æ–‡ä»¶è¯´æ˜Ž

### 1. åŽ‹åŠ›æµ‹è¯•è„šæœ¬

#### `stress_test.py` - åŽŸæœ‰åŽ‹åŠ›æµ‹è¯•
**åŠŸèƒ½**:
- APIç«¯ç‚¹å“åº”æµ‹è¯•
- å¹¶å‘è¯·æ±‚æµ‹è¯•ï¼ˆ1-200å¹¶å‘ï¼‰
- æ•°æ®åº“æ€§èƒ½æµ‹è¯•
- æ¶ˆæ¯é˜Ÿåˆ—æ€§èƒ½æµ‹è¯•
- é™æµå™¨æ€§èƒ½æµ‹è¯•
- å›¾ç‰‡å¤„ç†æ€§èƒ½æµ‹è¯•
- æ¶ˆæ¯æ ¼å¼è½¬æ¢æµ‹è¯•

**è¿è¡Œæ–¹å¼**:
```bash
python3 stress_test.py
```

**å‰ç½®æ¡ä»¶**:
- âœ… åŽç«¯æœåŠ¡è¿è¡Œåœ¨ http://127.0.0.1:9527
- âœ… Redisè¿è¡Œåœ¨ 127.0.0.1:6379

---

#### `comprehensive_stress_test.py` - å…¨é¢åŽ‹åŠ›æµ‹è¯•
**åŠŸèƒ½**:
- APIç«¯ç‚¹åŽ‹åŠ›æµ‹è¯•ï¼ˆå¤šå¹¶å‘çº§åˆ«ï¼‰
- æ¶ˆæ¯æ ¼å¼è½¬æ¢åŽ‹åŠ›æµ‹è¯•ï¼ˆå¤šè¿­ä»£æ¬¡æ•°ï¼‰
- Redisé˜Ÿåˆ—åŽ‹åŠ›æµ‹è¯•ï¼ˆå¤šæ‰¹é‡å¤§å°ï¼‰
- é™æµå™¨åŽ‹åŠ›æµ‹è¯•ï¼ˆå¤šç§é…ç½®ï¼‰
- æ•°æ®åº“å¹¶å‘æ“ä½œæµ‹è¯•ï¼ˆå¤šæ“ä½œé‡çº§ï¼‰
- å›¾ç‰‡å¤„ç†åŽ‹åŠ›æµ‹è¯•ï¼ˆå¤šç§å°ºå¯¸ï¼‰
- ç«¯åˆ°ç«¯é›†æˆåŽ‹åŠ›æµ‹è¯•

**ç‰¹ç‚¹**:
- ðŸŽ¨ å½©è‰²è¾“å‡ºï¼Œæ¸…æ™°æ˜“è¯»
- ðŸ“Š è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡
- ðŸ“ˆ è‡ªåŠ¨ç”ŸæˆP50/P90/P99å“åº”æ—¶é—´
- ðŸ“ è‡ªåŠ¨ç”ŸæˆJSONå’ŒMarkdownæŠ¥å‘Š

**è¿è¡Œæ–¹å¼**:
```bash
python3 comprehensive_stress_test.py
```

**é…ç½®å‚æ•°**:
```python
COMPREHENSIVE_TEST_CONFIG = {
    "concurrent_levels": [1, 5, 10, 20, 50, 100],
    "message_batch_sizes": [10, 50, 100, 500, 1000, 5000],
    "formatter_iterations": [1000, 5000, 10000, 50000],
    # ... æ›´å¤šé…ç½®
}
```

---

#### `module_specific_stress_test.py` - æ¨¡å—ä¸“é¡¹æµ‹è¯•
**åŠŸèƒ½**:
- æ¶ˆæ¯éªŒè¯å™¨åŽ‹åŠ›æµ‹è¯•
- è¿‡æ»¤å™¨åŽ‹åŠ›æµ‹è¯•ï¼ˆå…³é”®è¯/ç”¨æˆ·/å¤åˆï¼‰
- åŠ å¯†è§£å¯†åŽ‹åŠ›æµ‹è¯•
- æ—¥å¿—è®°å½•åŽ‹åŠ›æµ‹è¯•
- WebSocketè¿žæŽ¥åŽ‹åŠ›æµ‹è¯•
- ç¼“å­˜ç³»ç»ŸåŽ‹åŠ›æµ‹è¯•
- é”™è¯¯å¤„ç†åŽ‹åŠ›æµ‹è¯•

**ç‰¹ç‚¹**:
- ðŸ” æ·±åº¦æµ‹è¯•ç‰¹å®šåŠŸèƒ½æ¨¡å—
- ðŸ“Š è¯¦ç»†çš„æ€§èƒ½æ•°æ®æ”¶é›†
- ðŸ’¾ è‡ªåŠ¨ä¿å­˜JSONæŠ¥å‘Š

**è¿è¡Œæ–¹å¼**:
```bash
python3 module_specific_stress_test.py
```

---

#### `demo_stress_test.py` - æ¼”ç¤ºæµ‹è¯•
**åŠŸèƒ½**:
- æ¶ˆæ¯æ ¼å¼è½¬æ¢æ€§èƒ½æµ‹è¯•
- å¹¶å‘å¤„ç†èƒ½åŠ›æµ‹è¯•
- å†…å­˜é˜Ÿåˆ—æ€§èƒ½æµ‹è¯•
- é™æµå™¨å‡†ç¡®æ€§æµ‹è¯•
- æ•°æ®åºåˆ—åŒ–æ€§èƒ½æµ‹è¯•
- è¿‡æ»¤å™¨æ€§èƒ½æµ‹è¯•

**ç‰¹ç‚¹**:
- âœ¨ **æ— éœ€åŽç«¯æœåŠ¡**å³å¯è¿è¡Œ
- ðŸ“Š å±•ç¤ºæµ‹è¯•æ¡†æž¶åŠŸèƒ½
- ðŸš€ å¿«é€ŸéªŒè¯æµ‹è¯•çŽ¯å¢ƒ
- ðŸ“ ç”Ÿæˆç¤ºä¾‹æŠ¥å‘Š

**è¿è¡Œæ–¹å¼**:
```bash
python3 demo_stress_test.py
```

**é€‚ç”¨åœºæ™¯**:
- éªŒè¯æµ‹è¯•æ¡†æž¶æ˜¯å¦æ­£å¸¸å·¥ä½œ
- äº†è§£æµ‹è¯•è¾“å‡ºæ ¼å¼
- å¿«é€Ÿæ£€æŸ¥PythonçŽ¯å¢ƒ

---

### 2. è¿è¡Œè„šæœ¬

#### `run_all_stress_tests.sh` - Linux/macOSè‡ªåŠ¨åŒ–è¿è¡Œ
**åŠŸèƒ½**:
- è‡ªåŠ¨æ£€æŸ¥çŽ¯å¢ƒï¼ˆPython/Redis/åŽç«¯æœåŠ¡ï¼‰
- è‡ªåŠ¨å®‰è£…ç¼ºå¤±çš„ä¾èµ–åŒ…
- ä¾æ¬¡è¿è¡Œæ‰€æœ‰åŽ‹åŠ›æµ‹è¯•
- è‡ªåŠ¨æ”¶é›†å’Œæ•´ç†æµ‹è¯•æŠ¥å‘Š
- å½©è‰²è¾“å‡ºï¼Œæ¸…æ™°æ˜¾ç¤ºæµ‹è¯•è¿›åº¦

**è¿è¡Œæ–¹å¼**:
```bash
chmod +x run_all_stress_tests.sh
./run_all_stress_tests.sh
```

**è¾“å‡º**:
- æµ‹è¯•æ—¥å¿—ï¼š`test_results/*.log`
- JSONæŠ¥å‘Šï¼š`test_results/*.json`
- MarkdownæŠ¥å‘Šï¼š`test_results/*.md`

---

#### `run_all_stress_tests.bat` - Windowsè‡ªåŠ¨åŒ–è¿è¡Œ
**åŠŸèƒ½**: ä¸ŽLinuxç‰ˆæœ¬ç›¸åŒ

**è¿è¡Œæ–¹å¼**:
```cmd
run_all_stress_tests.bat
```

---

### 3. å·¥å…·è„šæœ¬

#### `generate_test_summary.py` - æµ‹è¯•æŠ¥å‘Šæ±‡æ€»ç”Ÿæˆå™¨
**åŠŸèƒ½**:
- è¯»å–æ‰€æœ‰æµ‹è¯•ç»“æžœJSONæ–‡ä»¶
- æ±‡æ€»ç”Ÿæˆå®Œæ•´æµ‹è¯•æŠ¥å‘Š
- æå–å…³é”®æ€§èƒ½æŒ‡æ ‡
- ç”Ÿæˆä¼˜åŒ–å»ºè®®

**è¿è¡Œæ–¹å¼**:
```bash
python3 generate_test_summary.py
```

**ç”ŸæˆæŠ¥å‘Š**:
- `test_results/å®Œæ•´æµ‹è¯•æŠ¥å‘Šæ±‡æ€».md` - Markdownæ ¼å¼
- `test_results/æµ‹è¯•ç»“æžœç®€æŠ¥.txt` - æ–‡æœ¬æ ¼å¼

---

### 4. æ–‡æ¡£

#### `åŽ‹åŠ›æµ‹è¯•è¯´æ˜Ž.md` - å®Œæ•´ä½¿ç”¨æŒ‡å—
**å†…å®¹**:
- ðŸ“‹ æµ‹è¯•æ¦‚è§ˆ
- ðŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—
- ðŸ“Š æµ‹è¯•è¦†ç›–èŒƒå›´è¯¦è§£
- ðŸ“ˆ æ€§èƒ½åŸºå‡†å‚è€ƒ
- ðŸ“„ æµ‹è¯•æŠ¥å‘Šè¯´æ˜Ž
- ðŸ”§ è‡ªå®šä¹‰æµ‹è¯•æ–¹æ³•
- ðŸ› æ•…éšœæŽ’æŸ¥æŒ‡å—
- ðŸŽ¯ æœ€ä½³å®žè·µ
- ðŸ“š å‚è€ƒèµ„æ–™

**é€‚ç”¨å¯¹è±¡**: æ‰€æœ‰ç”¨æˆ·

---

#### `åŽ‹åŠ›æµ‹è¯•å®Œæˆæ€»ç»“.md` - é¡¹ç›®å®Œæˆæ€»ç»“
**å†…å®¹**:
- é¡¹ç›®æ¦‚è¿°
- å®Œæˆçš„å·¥ä½œæ¸…å•
- æµ‹è¯•è¦†ç›–èŒƒå›´
- æ¼”ç¤ºæµ‹è¯•ç»“æžœ
- ç”Ÿæˆçš„æ–‡ä»¶åˆ—è¡¨
- ä½¿ç”¨æŒ‡å—
- æ€§èƒ½ä¼˜åŒ–å»ºè®®
- æ³¨æ„äº‹é¡¹
- ä¸‹ä¸€æ­¥è®¡åˆ’

**é€‚ç”¨å¯¹è±¡**: é¡¹ç›®ç®¡ç†è€…ã€å¼€å‘è€…

---

#### `åŽ‹åŠ›æµ‹è¯•æ–‡ä»¶æ¸…å•.md` - æœ¬æ–‡ä»¶
**å†…å®¹**:
- æ–‡ä»¶ç»“æž„
- æ–‡ä»¶è¯´æ˜Ž
- å¿«é€Ÿå‚è€ƒ

**é€‚ç”¨å¯¹è±¡**: å¿«é€ŸæŸ¥é˜…

---

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œæ¼”ç¤ºæµ‹è¯•ï¼ˆæŽ¨èæ–°æ‰‹ï¼‰
```bash
python3 demo_stress_test.py
```
â±ï¸ è€—æ—¶: ~5ç§’  
ðŸ“Š æ— éœ€åŽç«¯æœåŠ¡

### 2. è¿è¡Œå®Œæ•´æµ‹è¯•
```bash
# 1. å¯åŠ¨åŽç«¯æœåŠ¡
cd backend && python -m app.main

# 2. å¯åŠ¨Redis
redis-server

# 3. è¿è¡Œæµ‹è¯•
./run_all_stress_tests.sh  # Linux/macOS
# æˆ–
run_all_stress_tests.bat   # Windows
```
â±ï¸ è€—æ—¶: ~5-10åˆ†é’Ÿ  
ðŸ“Š éœ€è¦å®Œæ•´çŽ¯å¢ƒ

### 3. æŸ¥çœ‹æŠ¥å‘Š
```bash
cd test_results
ls -lh
cat æ¼”ç¤ºåŽ‹åŠ›æµ‹è¯•æŠ¥å‘Š.md
```

---

## ðŸ“Š æµ‹è¯•æ•°æ®ç¤ºä¾‹

åŸºäºŽæ¼”ç¤ºæµ‹è¯•çš„å®žé™…ç»“æžœï¼š

| æµ‹è¯•é¡¹ | æ€§èƒ½ |
|--------|------|
| æ¶ˆæ¯æ ¼å¼è½¬æ¢ | ~970,000 ops/s |
| å¹¶å‘å¤„ç† | ~4,849 msg/s (200å¹¶å‘) |
| é˜Ÿåˆ—å…¥é˜Ÿ | ~695,000 msg/s |
| é˜Ÿåˆ—å‡ºé˜Ÿ | ~892,000 msg/s |
| JSONåºåˆ—åŒ– | ~67,587 ops/s |
| è¿‡æ»¤å™¨ | ~353,631 msg/s |
| é™æµå™¨å‡†ç¡®åº¦ | 99.85% |

---

## ðŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æµ‹è¯•å‚æ•°

ç¼–è¾‘ `comprehensive_stress_test.py`:
```python
COMPREHENSIVE_TEST_CONFIG = {
    "concurrent_levels": [1, 5, 10],        # ä¿®æ”¹å¹¶å‘çº§åˆ«
    "message_batch_sizes": [10, 50, 100],   # ä¿®æ”¹æ‰¹é‡å¤§å°
    # ... å…¶ä»–é…ç½®
}
```

### æ·»åŠ æ–°æµ‹è¯•

åœ¨ä»»ä¸€æµ‹è¯•è„šæœ¬ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•:
```python
async def test_custom_feature(self):
    """è‡ªå®šä¹‰æµ‹è¯•"""
    # æµ‹è¯•ä»£ç 
    pass
```

---

## ðŸ“ˆ æ€§èƒ½åŸºå‡†

### æŽ¨èé…ç½®ä¸‹çš„æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| API QPS (å¹¶å‘100) | >500 |
| æ ¼å¼è½¬æ¢ | >10,000 ops/s |
| Redisé˜Ÿåˆ— | >5,000 msg/s |
| æ•°æ®åº“æŸ¥è¯¢ | >1,000 QPS |
| ç«¯åˆ°ç«¯å»¶è¿Ÿ | <50ms |

---

## ðŸ› æ•…éšœæŽ’æŸ¥

### å¸¸è§é—®é¢˜

1. **åŽç«¯æœåŠ¡æœªè¿è¡Œ**
   ```
   é”™è¯¯: Connection refused
   è§£å†³: cd backend && python -m app.main
   ```

2. **Redisè¿žæŽ¥å¤±è´¥**
   ```
   é”™è¯¯: Error connecting to Redis
   è§£å†³: redis-server
   ```

3. **ä¾èµ–åŒ…ç¼ºå¤±**
   ```
   é”™è¯¯: ModuleNotFoundError
   è§£å†³: pip install aiohttp redis pillow
   ```

4. **æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨**
   ```
   é”™è¯¯: Database file not found
   è§£å†³: é¦–æ¬¡è¿è¡ŒåŽç«¯ä¼šè‡ªåŠ¨åˆ›å»º
   ```

---

## ðŸ“ž èŽ·å–å¸®åŠ©

1. æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£: `åŽ‹åŠ›æµ‹è¯•è¯´æ˜Ž.md`
2. æŸ¥çœ‹æµ‹è¯•æ—¥å¿—: `test_results/*.log`
3. è¿è¡Œæ¼”ç¤ºæµ‹è¯•éªŒè¯çŽ¯å¢ƒ: `python3 demo_stress_test.py`

---

## âœ… æ£€æŸ¥æ¸…å•

ä½¿ç”¨å‰è¯·ç¡®è®¤:

- [ ] Python 3.8+ å·²å®‰è£…
- [ ] ä¾èµ–åŒ…å·²å®‰è£… (`pip install -r backend/requirements.txt`)
- [ ] åŽç«¯æœåŠ¡å¯æ­£å¸¸å¯åŠ¨ï¼ˆå®Œæ•´æµ‹è¯•éœ€è¦ï¼‰
- [ ] RedisæœåŠ¡å¯æ­£å¸¸å¯åŠ¨ï¼ˆå®Œæ•´æµ‹è¯•éœ€è¦ï¼‰
- [ ] æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ï¼ˆæµ‹è¯•æŠ¥å‘Š+æ—¥å¿—çº¦100MBï¼‰

---

**æœ€åŽæ›´æ–°**: 2025-10-22  
**ç‰ˆæœ¬**: 1.0.0  
**çŠ¶æ€**: âœ… å¯ç”¨
