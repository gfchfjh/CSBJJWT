# 🚀 KOOK消息转发系统 - 新功能使用指南

**版本：** v6.5.0（优化版）  
**更新日期：** 2025-10-26

---

## 📖 目录

1. [简化配置向导](#1-简化配置向导)
2. [可视化映射编辑器](#2-可视化映射编辑器)
3. [增强托盘系统](#3-增强托盘系统)
4. [友好错误提示](#4-友好错误提示)
5. [新手引导系统](#5-新手引导系统)
6. [图床管理界面](#6-图床管理界面)
7. [视频教程播放器](#7-视频教程播放器)
8. [增强统计图表](#8-增强统计图表)

---

## 1. 简化配置向导

### 功能说明

新版配置向导将原来的6步简化为**3步核心流程**，大幅缩短配置时间。

### 使用方法

#### 首次启动自动进入

程序首次启动时会自动检测，如果没有配置，会自动跳转到配置向导。

#### 手动进入

访问：`http://localhost:5173/wizard`

### 配置流程

```
步骤1：欢迎使用 + 免责声明
  └─ 阅读并同意免责声明
  
步骤2：登录KOOK
  ├─ 方式1：账号密码登录
  ├─ 方式2：Cookie导入（推荐）
  └─ 方式3：Chrome扩展一键导入
  
步骤3：选择服务器
  ├─ 勾选要监听的服务器
  └─ 勾选要监听的频道
  
完成！
  └─ 进入主界面
  └─ 显示"首次使用引导"
```

### 快速配置（可选）

完成基础向导后，会提示是否进入快速配置：

```
快速配置流程：
  步骤1：配置转发Bot（Discord/Telegram/飞书）
  步骤2：设置频道映射
  步骤3：测试验证
  
完成！开始转发消息
```

访问：`http://localhost:5173/quick-setup`

---

## 2. 可视化映射编辑器

### 功能说明

通过**拖拽**方式建立KOOK频道到目标平台的映射关系，所见即所得。

### 使用方法

1. 进入"频道映射"页面
2. 点击"可视化编辑器"标签
3. 开始拖拽配置

### 操作步骤

#### 建立映射

```
1. 从左侧KOOK频道列表中拖动频道
2. 拖放到右侧对应的Bot卡片中
3. 系统自动创建映射关系
4. 实时显示连接线
```

#### 查看预览

底部"映射预览"区域会实时显示：
- 源频道名称
- 目标平台列表
- 匹配置信度

#### 智能映射

点击"智能映射"按钮，系统会：
- 自动识别同名频道
- 自动匹配相似频道
- 显示匹配置信度
- 生成映射建议

#### 批量操作

- 导出配置：JSON格式
- 导入配置：从文件导入
- 测试所有映射：批量发送测试消息
- 清空映射：重新开始

### 视图切换

支持两种视图模式：
- **可视化编辑器**：拖拽操作（推荐新手）
- **表格模式**：传统列表（适合批量编辑）

---

## 3. 增强托盘系统

### 功能说明

右键点击系统托盘图标，即可查看系统状态和进行快捷操作。

### 状态图标

- 🟢 **绿色**：服务运行中
- 🟡 **黄色**：正在重连
- 🔴 **红色**：发生错误
- ⚪ **灰色**：服务已停止

### 实时统计（7项）

```
📈 今日统计
  ├─ 转发消息：1,234 条
  ├─ 成功率：98.5%
  ├─ 平均延迟：1.2ms
  └─ 队列消息：5 条
  
🔢 配置统计
  ├─ 账号数：2 个
  ├─ Bot数：3 个
  └─ 运行时长：3小时25分钟
```

### 快捷操作（6个）

```
⚡ 快捷操作
  ├─ ▶️/⏸️  启动/停止服务
  ├─ 🔄 重启服务
  ├─ 🧪 测试转发
  ├─ 📺 显示主窗口
  ├─ ⚙️  打开设置
  └─ 📋 查看日志
```

### 自动更新

托盘信息每5秒自动更新一次，始终显示最新状态。

---

## 4. 友好错误提示

### 功能说明

将技术错误翻译成**普通人能理解的语言**，并提供明确的解决方案。

### 错误对话框结构

```
┌──────────────────────────────┐
│ 🌐 浏览器组件未安装          │ ← 用户友好的标题
├──────────────────────────────┤
│ 程序需要Chromium浏览器才能运行│ ← 通俗易懂的说明
│                              │
│ 💡 解决方案：                │
│ 不用担心！点击"自动安装"按钮 │ ← 分步骤的解决方案
│ 程序会自动为您下载安装       │
│                              │
│ [自动安装] [查看日志] [复制] │ ← 操作按钮
└──────────────────────────────┘
```

### 支持的错误类型

1. **环境错误**
   - Chromium未安装 → 自动安装
   - Redis未运行 → 自动启动
   - 端口被占用 → 更改端口

2. **配置错误**
   - Cookie过期 → 重新登录
   - Webhook无效 → 重新配置
   - Bot Token错误 → 检查Token

3. **网络错误**
   - 连接超时 → 网络诊断
   - 限流 → 自动等待

4. **系统错误**
   - 磁盘空间不足 → 清理存储
   - 权限不足 → 请求权限

### 自动修复功能

支持自动修复的错误：
- ✅ Chromium自动安装
- ✅ Redis自动启动
- ✅ 配置自动重置
- ✅ 存储空间清理
- ✅ 数据库自动修复

---

## 5. 新手引导系统

### 功能说明

首次使用时，会有**分步高亮引导**，帮助您快速上手。

### 触发时机

1. **首次进入主界面**
   - 自动触发完整引导（8步）
   
2. **完成基础配置后**
   - 显示"首次使用引导"提示
   - 可选择开始快速配置

3. **手动触发**
   ```vue
   <script setup>
   import { useOnboarding } from '@/composables/useOnboarding'
   
   const { startOnboarding } = useOnboarding()
   
   // 启动引导
   onMounted(() => {
     startOnboarding()
   })
   </script>
   ```

### 引导内容

#### 完整引导（8步）

```
步骤1：主页 - 统计概览
步骤2：服务控制 - 启停服务
步骤3：账号管理 - 添加KOOK账号
步骤4：Bot配置 - 配置转发Bot
步骤5：频道映射 - 设置映射关系
步骤6：过滤规则 - 设置过滤
步骤7：实时日志 - 查看记录
步骤8：系统设置 - 高级配置
```

#### 快速引导（3步）

```
步骤1：添加KOOK账号
步骤2：配置转发Bot
步骤3：设置频道映射
```

#### 功能演示

针对特定功能的演示引导：
- 智能映射演示
- 可视化拖拽演示
- 等等...

### 引导特性

- ✨ 高亮关键元素
- ✨ 提示气泡跟随
- ✨ 显示进度（X/总数）
- ✨ 支持前进/后退
- ✨ 可随时退出

---

## 6. 图床管理界面

### 功能说明

可视化管理图床存储空间，支持清理、预览和统计。

### 访问路径

进入"设置" → "图床管理"  
或访问：`http://localhost:5173/image-storage`

### 主要功能

#### 1. 空间统计（4个卡片）

```
┌─────────┬─────────┬─────────┬─────────┐
│ 💿 总空间 │ 📊 已使用 │ ✨ 剩余  │ 🖼️  图片数│
│   10GB   │  2.3GB  │ 7.7GB  │  1,234 │
│          │  (23%)  │        │        │
└─────────┴─────────┴─────────┴─────────┘
```

#### 2. 使用率进度条

动态颜色显示：
- 🟢 < 60%：绿色（正常）
- 🟡 60-80%：黄色（注意）
- 🔴 > 80%：红色（警告）

#### 3. 图片管理

**网格视图**：
- 缩略图预览
- 悬停显示操作按钮
- 支持放大预览

**列表视图**：
- 详细信息表格
- 文件名、大小、创建时间
- 批量操作

#### 4. 清理功能

**按时间清理**：
```
选择天数：[1天] [3天] [7天] [15天] [30天]
预计释放：约 1.2GB
```

**清空所有**：
- 一键清空所有缓存图片
- 危险操作，需二次确认

#### 5. 快捷操作

- 📁 打开存储文件夹
- 🔄 刷新数据
- ⬇️ 下载图片
- 🗑️ 删除图片

---

## 7. 视频教程播放器

### 功能说明

应用内直接观看视频教程，无需跳转到外部网站。

### 使用方法

#### 访问方式

1. 主界面点击"帮助"按钮
2. 选择"视频教程"
3. 选择想看的教程

#### 或直接使用组件

```vue
<template>
  <VideoTutorial video-id="quick-start" />
</template>
```

### 教程库（8个）

```
入门级：
  ├─ 快速入门指南（5:32）
  ├─ Cookie获取与导入（3:45）
  ├─ Discord Webhook配置（2:18）
  └─ Telegram Bot创建（4:12）
  
中级：
  ├─ 飞书自建应用配置（6:28）
  └─ 智能映射功能演示（3:56）
  
高级：
  ├─ 高级过滤规则设置（5:18）
  └─ 常见问题排查（7:42）
```

### 播放器功能

- ▶️ 播放/暂停
- ⏩ 快进/快退
- 🔊 音量调节
- 📺 全屏模式
- 📋 字幕（如有）
- 🔁 自动播放下一个
- 📝 显示教程描述
- 👁️ 观看次数统计

### 相关推荐

播放器右侧显示相关视频，点击即可切换。

---

## 8. 增强统计图表

### 功能说明

多维度可视化展示系统运行数据。

### 访问路径

主页下方即可看到图表  
或访问：`http://localhost:5173/home`

### 图表类型

#### 1. 转发趋势图（折线图）

```
📈 转发趋势
  
时间范围：[最近24小时] [最近7天] [最近30天]
  
图例：
  ━━ 总消息数（蓝色）
  ━━ 成功（绿色）
  ━━ 失败（红色）
```

#### 2. 平台分布图（饼图）

```
🎯 平台分布

Discord: 45% (450条)
Telegram: 35% (350条)
飞书: 20% (200条)
```

#### 3. 成功率图（柱状图）

```
✅ 成功率统计

Discord:  ████████████████░░ 98.5%
Telegram: ███████████████░░░ 97.2%
飞书:     ██████████████░░░░ 95.8%
```

#### 4. 24小时热力图

```
🔥 24小时活动热力图

00:00 ████░░░░░░░░░░░░░░░░░░░░ 24:00
      │    高峰    │   低谷   │
```

#### 5. 频道排行榜（横向柱状图）

```
🏆 频道转发排行榜

1. 🥇 公告频道  ████████████████ 1,234
2. 🥈 活动频道  ██████████████   987
3. 🥉 更新日志  ████████████     765
4.    技术讨论  ██████████       543
5.    反馈建议  ████████         321
```

### 图表特性

- ✨ 响应式设计（自适应窗口大小）
- ✨ 交互式提示（鼠标悬停显示详情）
- ✨ 图例控制（点击切换显示/隐藏）
- ✨ 自动刷新（每30秒更新数据）
- ✨ 美观配色（渐变色+阴影）

---

## 🎓 最佳实践

### 新手入门流程

```
1. 首次启动程序
   └─ 自动进入配置向导
   
2. 完成3步配置（5分钟）
   ├─ 同意免责声明
   ├─ 登录KOOK账号
   └─ 选择服务器和频道
   
3. 查看"首次使用引导"
   └─ 选择"开始快速配置"或"先看看"
   
4. 如果选择快速配置（5分钟）
   ├─ 配置Discord/Telegram/飞书
   ├─ 使用可视化编辑器建立映射
   └─ 运行测试验证
   
5. 完成！启动转发服务
   └─ 在主页点击"启动服务"
   
6. 查看实时日志
   └─ 观察转发记录和成功率
```

### 高级用户技巧

1. **使用智能映射**
   - 节省90%配置时间
   - 自动识别同名频道

2. **设置过滤规则**
   - 关键词黑白名单
   - 用户黑白名单
   - 消息类型过滤

3. **查看统计图表**
   - 了解转发趋势
   - 找出高峰时段
   - 优化映射配置

4. **定期清理图床**
   - 建议7天清理一次
   - 释放磁盘空间

5. **导出配置备份**
   - 定期备份映射配置
   - 方便恢复和迁移

---

## 🐛 常见问题

### Q1: 配置向导可以重新运行吗？

A: 可以！访问 `/wizard` 路径即可重新进入向导。

### Q2: 可视化映射的连接线不显示？

A: 尝试刷新页面或调整窗口大小。

### Q3: 托盘图标不显示统计信息？

A: 确保后端服务正在运行，托盘每5秒自动更新。

### Q4: 错误对话框的"自动修复"没反应？

A: 检查错误是否支持自动修复，有些错误需要手动操作。

### Q5: 新手引导如何重新触发？

A: 清除localStorage中的`onboarding_completed`标记：
```javascript
localStorage.removeItem('onboarding_completed')
```

### Q6: 视频教程加载失败？

A: 确保视频文件已放置到`/videos/tutorials/`目录。

### Q7: 图表数据不更新？

A: 图表每30秒自动刷新，或手动刷新页面。

---

## 📞 获取帮助

- 📖 [完整文档](V6_DOCUMENTATION_INDEX.md)
- ❓ [常见问题FAQ](docs/tutorials/FAQ-常见问题.md)
- 🐛 [报告Bug](https://github.com/gfchfjh/CSBJJWT/issues)
- 💬 [讨论区](https://github.com/gfchfjh/CSBJJWT/discussions)

---

**祝您使用愉快！** 🎉
