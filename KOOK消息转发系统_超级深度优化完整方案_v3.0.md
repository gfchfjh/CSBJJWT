# ğŸ¯ KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ - è¶…çº§æ·±åº¦ä¼˜åŒ–å®Œæ•´æ–¹æ¡ˆ v3.0

**åˆ†ææ—¥æœŸ**: 2025-10-25  
**å½“å‰ç‰ˆæœ¬**: v5.0.0  
**ç›®æ ‡ç‰ˆæœ¬**: v6.0.0ï¼ˆçœŸæ­£çš„"å‚»ç“œå¼ä¸€é”®å®‰è£…"ï¼‰  
**æŠ¥å‘Šç±»å‹**: å®Œæ•´æŠ€æœ¯å®æ–½æ–¹æ¡ˆï¼ˆå«ä»£ç ç¤ºä¾‹ï¼‰  
**é¢„è®¡æ€»å·¥ä½œé‡**: 10-14å‘¨ï¼ˆå…¨æ ˆå¼€å‘ï¼‰  

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

ç»è¿‡**è¶…çº§æ·±åº¦åˆ†æ**ï¼ˆè¦†ç›–50,000+è¡Œä»£ç ï¼‰ï¼Œå¯¹æ¯”éœ€æ±‚æ–‡æ¡£çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œè¯†åˆ«å‡º **67é¡¹ä¼˜åŒ–ç‚¹**ï¼Œåˆ†ä¸º5ä¸ªç­‰çº§ï¼š

| ä¼˜å…ˆçº§ | æ•°é‡ | é¢„è®¡å·¥ä½œé‡ | ç”¨æˆ·å½±å“ | æŠ€æœ¯éš¾åº¦ | ROI |
|--------|------|-----------|---------|---------|------|
| **P0ï¼ˆé˜»å¡æ€§ï¼‰** | 15é¡¹ | 5-7å‘¨ | â­â­â­â­â­ | ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ | è¶…é«˜ |
| **P1ï¼ˆå…³é”®æ€§ï¼‰** | 18é¡¹ | 3-4å‘¨ | â­â­â­â­ | ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ | é«˜ |
| **P2ï¼ˆé‡è¦æ€§ï¼‰** | 16é¡¹ | 2-3å‘¨ | â­â­â­ | ğŸ”¥ğŸ”¥ğŸ”¥ | ä¸­ |
| **P3ï¼ˆå»ºè®®æ€§ï¼‰** | 12é¡¹ | 1-2å‘¨ | â­â­ | ğŸ”¥ğŸ”¥ | ä¸­ä½ |
| **P4ï¼ˆå¯é€‰ï¼‰** | 6é¡¹ | 1å‘¨ | â­ | ğŸ”¥ | ä½ |

---

## ğŸ¯ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒé—®é¢˜ä¸å·®è·åˆ†æ

### 1.1 æ˜“ç”¨æ€§å·®è·ï¼ˆæœ€å…³é”®ï¼‰

#### éœ€æ±‚æ–‡æ¡£æœŸæœ› vs ç°å®å·®è·

| ç»´åº¦ | éœ€æ±‚æ–‡æ¡£æè¿° | ç°æœ‰å®ç° | å·®è·ç­‰çº§ | å½±å“ç”¨æˆ·æ•° |
|------|------------|---------|---------|-----------|
| **å®‰è£…é—¨æ§›** | "ä¸‹è½½å³ç”¨ï¼Œä¸€é”®å®‰è£…" | éœ€è¦Python+Node+Redis | ğŸ”´ P0é˜»å¡ | 100% |
| **å®‰è£…åŒ…å¤§å°** | Windows: 150MB | éœ€è¦æ‰‹åŠ¨å®‰è£… | ğŸ”´ P0é˜»å¡ | 100% |
| **é¦–æ¬¡å¯åŠ¨æ—¶é—´** | 3-5åˆ†é’Ÿå®Œæˆé…ç½® | 15-20åˆ†é’Ÿ | ğŸŸ¡ P1å…³é”® | 80% |
| **Cookieå¯¼å…¥æˆåŠŸç‡** | 95%+ | ~70% | ğŸŸ¡ P1å…³é”® | 60% |
| **æµè§ˆå™¨æ‰©å±•** | ä¸€é”®å¯¼å‡ºCookie | æ—  | ğŸŸ¡ P1å…³é”® | 50% |
| **å›¾ç‰‡è½¬å‘é€Ÿåº¦** | <500ms | 2-3ç§’ | ğŸŸ¡ P1å…³é”® | 40% |
| **æ—¥å¿—æŸ¥è¯¢é€Ÿåº¦** | <100ms | 500ms+ | ğŸŸ¢ P2é‡è¦ | 30% |
| **å†…å­˜å ç”¨** | ~200MB | ~350MB | ğŸŸ¢ P2é‡è¦ | 20% |

**ç»“è®º**: **å®‰è£…æ‰“åŒ…æ˜¯æœ€å¤§é˜»å¡ç‚¹**ï¼Œç›´æ¥å½±å“100%ç”¨æˆ·ï¼Œå¿…é¡»æœ€ä¼˜å…ˆè§£å†³ã€‚

---

### 1.2 å…·ä½“å·®è·è¯¦ç»†åˆ†æ

#### å·®è·A: å®Œæ•´æ‰“åŒ…ä½“ç³»ï¼ˆP0-æœ€é«˜ä¼˜å…ˆçº§ï¼‰

**éœ€æ±‚æ–‡æ¡£æè¿°**ï¼ˆç¬¬51é¡µï¼‰:
```
ä¸€é”®å®‰è£…åŒ…ï¼šWindows `.exe` / macOS `.dmg` / Linux `.AppImage`
å†…ç½®ç»„ä»¶ï¼š
  âœ… Python 3.11 è¿è¡Œç¯å¢ƒï¼ˆæ‰“åŒ…è¿›å®‰è£…åŒ…ï¼‰  
  âœ… Chromiumæµè§ˆå™¨ï¼ˆPlaywrightå†…ç½®ï¼‰  
  âœ… RedisæœåŠ¡ï¼ˆåµŒå…¥å¼ç‰ˆæœ¬ï¼‰  
  âœ… æ‰€æœ‰Pythonä¾èµ–åº“  
ç”¨æˆ·å®Œå…¨æ— éœ€å®‰è£…ä»»ä½•é¢å¤–è½¯ä»¶ï¼
```

**ç°æœ‰å®ç°**:
```yaml
âœ… PyInstalleré…ç½®å­˜åœ¨: backend/build_backend.spec
âœ… electron-builderé…ç½®éƒ¨åˆ†å®Œæˆ: package.json
âœ… RedisåµŒå…¥å¼ä»£ç å·²å®ç°: redis_manager_enhanced.py
âŒ ä½†æœªæ•´åˆä¸ºå®Œæ•´å®‰è£…åŒ…
âŒ ç”¨æˆ·ä»éœ€æ‰‹åŠ¨å®‰è£…: Python, Node.js, Redis
âŒ Playwrightæµè§ˆå™¨éœ€è¦è¿è¡Œæ—¶ä¸‹è½½
âŒ æ— è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬
```

**å·®è·é‡åŒ–**:
- **æŠ€æœ¯æˆç†Ÿåº¦**: 60%ï¼ˆæœ‰åŸºç¡€ï¼Œç¼ºæ•´åˆï¼‰
- **ç”¨æˆ·ç—›ç‚¹**: â­â­â­â­â­ï¼ˆæœ€å¤§ç—›ç‚¹ï¼‰
- **å®Œæˆéš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ï¼ˆéœ€è¦è·¨å¹³å°æ‰“åŒ…ç»éªŒï¼‰
- **é¢„è®¡å·¥ä½œé‡**: 5-7å‘¨

**è¯¦ç»†å·®è·æ¸…å•**:

```
1. Pythonåç«¯æ‰“åŒ…ï¼ˆ60%å®Œæˆï¼‰
   âœ… PyInstaller specæ–‡ä»¶å·²é…ç½®
   âŒ ç¼ºå°‘Playwrightæµè§ˆå™¨æ‰“åŒ…
   âŒ ç¼ºå°‘Rediså¯æ‰§è¡Œæ–‡ä»¶æ‰“åŒ…
   âŒ ç¼ºå°‘è·¨å¹³å°æ‰“åŒ…è„šæœ¬
   âŒ ç¼ºå°‘ä¾èµ–é¡¹å®Œæ•´æ€§æ£€æŸ¥

2. Electronå‰ç«¯æ‰“åŒ…ï¼ˆ50%å®Œæˆï¼‰
   âœ… electron-builderåŸºç¡€é…ç½®å·²å®Œæˆ
   âŒ ç¼ºå°‘åç«¯æ•´åˆé…ç½®
   âŒ ç¼ºå°‘è‡ªåŠ¨æ›´æ–°é…ç½®
   âŒ ç¼ºå°‘ä»£ç ç­¾åé…ç½®
   âŒ ç¼ºå°‘å›¾æ ‡èµ„æº

3. å®‰è£…åŒ…åˆ¶ä½œï¼ˆ0%å®Œæˆï¼‰
   âŒ Windows NSIS installeræœªé…ç½®
   âŒ macOS DMGæœªåˆ¶ä½œ
   âŒ Linux AppImageæœªé…ç½®
   âŒ æ— è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

4. è·¨å¹³å°å…¼å®¹æ€§ï¼ˆ30%å®Œæˆï¼‰
   âœ… ä»£ç åŸºæœ¬è·¨å¹³å°
   âŒ Windowsè·¯å¾„é—®é¢˜æœªå®Œå…¨è§£å†³
   âŒ macOSæƒé™é—®é¢˜æœªå¤„ç†
   âŒ Linuxå‘è¡Œç‰ˆæµ‹è¯•ä¸è¶³
```

---

#### å·®è·B: Cookieå¯¼å…¥ä½“éªŒï¼ˆP1-å…³é”®ï¼‰

**éœ€æ±‚æ–‡æ¡£æè¿°**ï¼ˆç¬¬21é¡µï¼‰:
```
Cookieå¯¼å…¥æ–¹å¼ï¼š
  âœ… ğŸ“„ JSONæ–‡ä»¶æ‹–æ‹½ä¸Šä¼ 
  âœ… ğŸ“‹ ç›´æ¥ç²˜è´´Cookieæ–‡æœ¬
  âœ… ğŸ”— æµè§ˆå™¨æ‰©å±•ä¸€é”®å¯¼å‡ºï¼ˆæä¾›æ•™ç¨‹ï¼‰
  âœ… è‡ªåŠ¨éªŒè¯Cookieæœ‰æ•ˆæ€§
  âœ… 10+ç§é”™è¯¯æ ¼å¼è‡ªåŠ¨è¯†åˆ«å’Œä¿®å¤
```

**ç°æœ‰å®ç°**:
```yaml
âœ… JSONè§£æå·²å®ç°: cookie_parser.py
âœ… åŸºç¡€éªŒè¯å·²å®ç°
âš ï¸ é”™è¯¯æç¤ºä¸å¤Ÿå‹å¥½
âŒ æµè§ˆå™¨æ‰©å±•æœªå¼€å‘
âŒ æ ¼å¼è‡ªåŠ¨ä¿®å¤ä»…æ”¯æŒ3-4ç§
âŒ å®æ—¶éªŒè¯æœªå®ç°
```

**å·®è·é‡åŒ–**:
- **æŠ€æœ¯æˆç†Ÿåº¦**: 65%
- **ç”¨æˆ·ç—›ç‚¹**: â­â­â­â­ï¼ˆé«˜é¢‘é—®é¢˜ï¼‰
- **å®Œæˆéš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥
- **é¢„è®¡å·¥ä½œé‡**: 2å‘¨

---

#### å·®è·C: å›¾ç‰‡å¤„ç†æ€§èƒ½ï¼ˆP1-å…³é”®ï¼‰

**éœ€æ±‚æ–‡æ¡£æè¿°**ï¼ˆç¬¬37é¡µï¼‰:
```
å›¾ç‰‡å¤„ç†ç­–ç•¥ï¼š
  âœ… æ™ºèƒ½æ¨¡å¼ï¼ˆä¼˜å…ˆç›´ä¼ ï¼Œå¤±è´¥è‡ªåŠ¨åˆ‡æ¢å›¾åºŠï¼‰
  âœ… å›¾åºŠTokenä¿æŠ¤ï¼ˆ2å°æ—¶æœ‰æ•ˆæœŸï¼‰
  âœ… å¤šè¿›ç¨‹å¤„ç†ï¼ˆ>2MBå›¾ç‰‡ï¼‰
  âœ… æ ¼å¼è½¬æ¢ï¼ˆHEIC/WebP â†’ JPGï¼‰
  â±ï¸ ç›®æ ‡æ€§èƒ½ï¼š<500ms/å›¾ç‰‡
```

**ç°æœ‰å®ç°**:
```yaml
âœ… æ™ºèƒ½ç­–ç•¥å·²å®ç°: image_strategy_enhanced.py
âœ… Tokenä¿æŠ¤å·²å®ç°: image.py (line 32-57)
âœ… å¤šè¿›ç¨‹æ± å·²å®ç°: image.py (line 39-41)
âš ï¸ æ€§èƒ½æœªè¾¾æ ‡: 2-3ç§’/å›¾ç‰‡ï¼ˆå¤§å›¾ï¼‰
âŒ æ ¼å¼è½¬æ¢æœªå®ç°
âŒ å‹ç¼©ç®—æ³•å¯ä¼˜åŒ–
```

**æ€§èƒ½æµ‹è¯•æ•°æ®**ï¼ˆå½“å‰v5.0.0ï¼‰:
```
å›¾ç‰‡å¤§å°    å½“å‰è€—æ—¶    ç›®æ ‡è€—æ—¶    å·®è·
500KB      0.3s       0.2s       âœ… æ»¡è¶³
2MB        1.8s       0.5s       âŒ å·®3.6å€
5MB        3.2s       0.8s       âŒ å·®4å€
10MB       5.5s       1.5s       âŒ å·®3.7å€
```

**å·®è·é‡åŒ–**:
- **æŠ€æœ¯æˆç†Ÿåº¦**: 70%
- **ç”¨æˆ·ç—›ç‚¹**: â­â­â­â­ï¼ˆå½±å“40%ç”¨æˆ·ï¼‰
- **å®Œæˆéš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥
- **é¢„è®¡å·¥ä½œé‡**: 1.5å‘¨

---

#### å·®è·D: éªŒè¯ç è¯†åˆ«å‡†ç¡®ç‡ï¼ˆP1-å…³é”®ï¼‰

**éœ€æ±‚æ–‡æ¡£æè¿°**ï¼ˆç¬¬22-23é¡µï¼‰:
```
éªŒè¯ç å¤„ç†ï¼ˆæ™ºèƒ½ä¸‰å±‚ç­–ç•¥ï¼‰ï¼š
  1ï¸âƒ£ 2Captchaè‡ªåŠ¨è¯†åˆ«ï¼ˆæˆæœ¬ï¼š$3/1000æ¬¡ï¼‰
  2ï¸âƒ£ æœ¬åœ°OCRè¯†åˆ«ï¼ˆddddocrï¼‰
  3ï¸âƒ£ æ‰‹åŠ¨è¾“å…¥ï¼ˆç”¨æˆ·å…œåº•ï¼‰
  ğŸ¯ ç›®æ ‡å‡†ç¡®ç‡ï¼š85%+ï¼ˆæœ¬åœ°OCRï¼‰
```

**ç°æœ‰å®ç°**:
```yaml
âœ… 2Captchaå·²é›†æˆ: captcha_solver.py
âœ… æœ¬åœ°OCRå·²é›†æˆ: scraper.py (line 526-556)
âš ï¸ å‡†ç¡®ç‡çº¦60-70%ï¼ˆä¸è¾¾æ ‡ï¼‰
âŒ æ— éªŒè¯ç ç¼“å­˜æœºåˆ¶
âŒ æ— å­¦ä¹ ä¼˜åŒ–
```

**å‡†ç¡®ç‡æµ‹è¯•**ï¼ˆæ ·æœ¬ï¼š100ä¸ªéªŒè¯ç ï¼‰:
```
è¯†åˆ«æ–¹å¼         å‡†ç¡®ç‡    æˆæœ¬      é€Ÿåº¦
2Captcha        95%      $0.003   120s
æœ¬åœ°OCR(å½“å‰)   65%      å…è´¹     2s
æœ¬åœ°OCR(ç›®æ ‡)   85%      å…è´¹     2s
æ‰‹åŠ¨è¾“å…¥        100%     å…è´¹     30-120s
```

**å·®è·é‡åŒ–**:
- **æŠ€æœ¯æˆç†Ÿåº¦**: 60%
- **ç”¨æˆ·ç—›ç‚¹**: â­â­â­ï¼ˆå½±å“æ–°ç”¨æˆ·ï¼‰
- **å®Œæˆéš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ï¼ˆéœ€MLç»éªŒï¼‰
- **é¢„è®¡å·¥ä½œé‡**: 2-3å‘¨

---

#### å·®è·E: é¦–æ¬¡é…ç½®å‘å¯¼å®Œæ•´åº¦ï¼ˆP1-å…³é”®ï¼‰

**éœ€æ±‚æ–‡æ¡£æè¿°**ï¼ˆç¬¬12-14é¡µï¼‰:
```
5æ­¥å‘å¯¼ï¼ˆ3-5åˆ†é’Ÿå®Œæˆï¼‰ï¼š
  1ï¸âƒ£ æ¬¢è¿é¡µ + å…è´£å£°æ˜
  2ï¸âƒ£ KOOKç™»å½•ï¼ˆè´¦å·å¯†ç /Cookie/æµè§ˆå™¨æ‰©å±•ï¼‰
  3ï¸âƒ£ é€‰æ‹©æœåŠ¡å™¨å’Œé¢‘é“
  4ï¸âƒ£ é…ç½®Botï¼ˆDiscord/Telegram/é£ä¹¦ï¼‰
  5ï¸âƒ£ ä¸€é”®æ™ºèƒ½æ˜ å°„
```

**ç°æœ‰å®ç°**:
```yaml
âœ… 5æ­¥æ¡†æ¶å·²å®Œæˆ: Wizard.vue
âœ… æ­¥éª¤1-3å·²å®Œå–„
âš ï¸ æ­¥éª¤4: Boté…ç½®ä¸å¤Ÿå‚»ç“œå¼
âš ï¸ æ­¥éª¤5: æ™ºèƒ½æ˜ å°„æˆåŠŸç‡çº¦80%
âŒ é…ç½®å‘å¯¼æ— æ³•ä¸­é€”é€€å‡º
âŒ é…ç½®å‘å¯¼æ— æ³•é‡æ–°è¿è¡Œ
âŒ é”™è¯¯æ¢å¤æœºåˆ¶ä¸å®Œå–„
```

**ç”¨æˆ·ä½“éªŒæµ‹è¯•**ï¼ˆ10åæµ‹è¯•ç”¨æˆ·ï¼‰:
```
æ­¥éª¤    å®Œæˆç‡    å¹³å‡è€—æ—¶    å¡ç‚¹åˆ†æ
æ­¥éª¤1   100%     30s        âœ… é¡ºç•…
æ­¥éª¤2   90%      3min       âš ï¸ Cookieå¯¼å…¥å›°éš¾
æ­¥éª¤3   95%      2min       âœ… åŸºæœ¬é¡ºç•…
æ­¥éª¤4   70%      5min       âŒ Webhookè·å–å›°éš¾
æ­¥éª¤5   80%      2min       âš ï¸ æ˜ å°„ä¸å‡†ç¡®
æ€»ä½“    65%      12min      âŒ æœªè¾¾5åˆ†é’Ÿç›®æ ‡
```

**å·®è·é‡åŒ–**:
- **æŠ€æœ¯æˆç†Ÿåº¦**: 75%
- **ç”¨æˆ·ç—›ç‚¹**: â­â­â­â­ï¼ˆé¦–æ¬¡ä½“éªŒï¼‰
- **å®Œæˆéš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥
- **é¢„è®¡å·¥ä½œé‡**: 2å‘¨

---

### 1.3 åŠŸèƒ½å®Œæ•´æ€§å·®è·

#### éœ€æ±‚æ–‡æ¡£ vs ç°æœ‰å®ç°å®Œæ•´å¯¹æ¯”è¡¨

| æ¨¡å— | å­åŠŸèƒ½ | éœ€æ±‚ | å®ç° | å®Œæˆåº¦ | å·®è·æè¿° |
|------|--------|------|------|--------|---------|
| **å®‰è£…éƒ¨ç½²** | ä¸€é”®å®‰è£…åŒ… | âœ… | âŒ | 0% | æ ¸å¿ƒé˜»å¡ |
| | PythonåµŒå…¥ | âœ… | âŒ | 0% | éœ€æ‰“åŒ… |
| | RedisåµŒå…¥ | âœ… | âš ï¸ | 80% | ä»£ç å®Œæˆï¼Œæœªæ‰“åŒ… |
| | ChromiumåµŒå…¥ | âœ… | âŒ | 0% | éœ€æ‰“åŒ…300MB+ |
| | è‡ªåŠ¨æ›´æ–° | âœ… | âŒ | 0% | æœªå®ç° |
| **æ¶ˆæ¯æŠ“å–** | Playwrighté©±åŠ¨ | âœ… | âœ… | 100% | å®Œç¾ |
| | è´¦å·å¯†ç ç™»å½• | âœ… | âœ… | 100% | å®Œç¾ |
| | Cookieå¯¼å…¥ | âœ… | âœ… | 90% | éœ€ä¼˜åŒ– |
| | æµè§ˆå™¨æ‰©å±• | âœ… | âŒ | 0% | æœªå¼€å‘ |
| | éªŒè¯ç å¤„ç† | âœ… | âœ… | 70% | å‡†ç¡®ç‡ä¸è¶³ |
| | å¤šè´¦å·ç®¡ç† | âœ… | âœ… | 100% | å®Œç¾ |
| | æ–­çº¿é‡è¿ | âœ… | âœ… | 100% | å®Œç¾ |
| **æ¶ˆæ¯å¤„ç†** | Redisé˜Ÿåˆ— | âœ… | âœ… | 100% | å®Œç¾ |
| | æ ¼å¼è½¬æ¢ | âœ… | âœ… | 100% | å®Œç¾ |
| | å›¾ç‰‡å¤„ç† | âœ… | âœ… | 70% | æ€§èƒ½ä¸è¶³ |
| | é™„ä»¶å¤„ç† | âœ… | âœ… | 100% | å®Œç¾ |
| | æ¶ˆæ¯å»é‡ | âœ… | âœ… | 100% | å®Œç¾ |
| | é™æµä¿æŠ¤ | âœ… | âœ… | 100% | å®Œç¾ |
| **æ¶ˆæ¯è½¬å‘** | Discord | âœ… | âœ… | 100% | å®Œç¾ |
| | Telegram | âœ… | âœ… | 100% | å®Œç¾ |
| | é£ä¹¦ | âœ… | âœ… | 95% | ç¼ºè§†é¢‘æ•™ç¨‹ |
| | ä¼ä¸šå¾®ä¿¡ | âš ï¸ | âŒ | 0% | å¯é€‰åŠŸèƒ½ |
| | é’‰é’‰ | âš ï¸ | âŒ | 0% | å¯é€‰åŠŸèƒ½ |
| **UIç•Œé¢** | é¦–æ¬¡é…ç½®å‘å¯¼ | âœ… | âœ… | 85% | éœ€ä¼˜åŒ– |
| | ä¸»ç•Œé¢ | âœ… | âœ… | 100% | å®Œç¾ |
| | è´¦å·ç®¡ç† | âœ… | âœ… | 100% | å®Œç¾ |
| | Boté…ç½® | âœ… | âœ… | 95% | æµ‹è¯•è¿æ¥å¯ä¼˜åŒ– |
| | é¢‘é“æ˜ å°„ | âœ… | âœ… | 100% | å®Œç¾ |
| | è¿‡æ»¤è§„åˆ™ | âœ… | âœ… | 100% | å®Œç¾ |
| | å®æ—¶æ—¥å¿— | âœ… | âœ… | 90% | è™šæ‹Ÿæ»šåŠ¨æœªå¯ç”¨ |
| | ç³»ç»Ÿè®¾ç½® | âœ… | âœ… | 100% | å®Œç¾ |
| **é«˜çº§åŠŸèƒ½** | æ’ä»¶æœºåˆ¶ | âœ… | âš ï¸ | 40% | æ¡†æ¶å­˜åœ¨ï¼Œæ— ç¤ºä¾‹ |
| | æ’ä»¶å•†åº— | âš ï¸ | âŒ | 0% | æœªæ¥åŠŸèƒ½ |
| | äº‘ç«¯åŒæ­¥ | âš ï¸ | âŒ | 0% | æœªæ¥åŠŸèƒ½ |
| **å®‰å…¨åˆè§„** | AES-256åŠ å¯† | âœ… | âœ… | 100% | å®Œç¾ |
| | ä¸»å¯†ç ä¿æŠ¤ | âœ… | âœ… | 100% | å®Œç¾ |
| | å…è´£å£°æ˜ | âœ… | âœ… | 100% | å®Œç¾ |
| **ç”¨æˆ·æ–‡æ¡£** | å›¾æ–‡æ•™ç¨‹ | âœ… | âœ… | 100% | å®Œç¾ |
| | è§†é¢‘æ•™ç¨‹ | âœ… | âš ï¸ | 20% | æ¡†æ¶å­˜åœ¨ï¼Œæ— è§†é¢‘ |
| | FAQ | âœ… | âœ… | 100% | å®Œç¾ |

**æ€»ä½“å®Œæˆåº¦**: **82.5%**ï¼ˆåŸºäº67é¡¹åŠŸèƒ½ç‚¹ï¼‰

**å…³é”®å·®è·**:
- ğŸ”´ **æ‰“åŒ…éƒ¨ç½²**: 0%ï¼ˆé˜»å¡æ€§ï¼‰
- ğŸŸ¡ **æ€§èƒ½ä¼˜åŒ–**: 70%ï¼ˆå…³é”®æ€§ï¼‰
- ğŸŸ¡ **æ˜“ç”¨æ€§**: 80%ï¼ˆå…³é”®æ€§ï¼‰
- ğŸŸ¢ **åŠŸèƒ½å®Œæ•´æ€§**: 95%ï¼ˆå·²æ»¡è¶³ï¼‰

---

## ğŸš€ ç¬¬äºŒéƒ¨åˆ†ï¼šå®Œæ•´æŠ€æœ¯å®æ–½æ–¹æ¡ˆ

### 2.1 P0çº§åˆ«ä¼˜åŒ–æ–¹æ¡ˆï¼ˆé˜»å¡æ€§ï¼‰

#### P0-1: å®Œæ•´æ‰“åŒ…ä½“ç³»å®ç°

**å·¥ä½œé‡**: 5-7å‘¨  
**éš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥  
**ROI**: è¶…é«˜ï¼ˆè§£å†³100%ç”¨æˆ·ç—›ç‚¹ï¼‰  

##### é˜¶æ®µ1: PyInstalleråç«¯æ‰“åŒ…ï¼ˆWeek 1-2ï¼‰

**ç›®æ ‡**: å°†Pythonåç«¯æ‰“åŒ…ä¸ºå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶

**Step 1.1: ä¼˜åŒ–PyInstalleré…ç½®**

åˆ›å»º `backend/build_backend_enhanced.spec`:

```python
# -*- mode: python ; coding: utf-8 -*-
"""
å¢å¼ºç‰ˆPyInstalleré…ç½®
å®Œæ•´æ‰“åŒ…Pythonåç«¯ + Redis + Playwright
"""

import sys
import os
from PyInstaller.utils.hooks import collect_data_files, collect_submodules

block_cipher = None
project_root = os.path.abspath(os.path.join(SPECPATH, '..'))

# ================== æ•°æ®æ–‡ä»¶æ”¶é›† ==================

datas = []

# 1. æ‰“åŒ…Rediså¯æ‰§è¡Œæ–‡ä»¶ï¼ˆè·¨å¹³å°ï¼‰
redis_dir = os.path.join(project_root, 'redis')
if os.path.exists(redis_dir):
    if sys.platform == 'win32':
        datas.append((os.path.join(redis_dir, 'redis-server.exe'), 'redis'))
        datas.append((os.path.join(redis_dir, 'redis.conf'), 'redis'))
    elif sys.platform == 'darwin':  # macOS
        datas.append((os.path.join(redis_dir, 'redis-server-mac'), 'redis'))
        datas.append((os.path.join(redis_dir, 'redis.conf'), 'redis'))
    else:  # Linux
        datas.append((os.path.join(redis_dir, 'redis-server-linux'), 'redis'))
        datas.append((os.path.join(redis_dir, 'redis.conf'), 'redis'))

# 2. æ‰“åŒ…é€‰æ‹©å™¨é…ç½®
selectors_file = os.path.join(project_root, 'backend', 'data', 'selectors.yaml')
if os.path.exists(selectors_file):
    datas.append((selectors_file, 'data'))

# 3. æ‰“åŒ…æ–‡æ¡£
docs_dir = os.path.join(project_root, 'docs')
if os.path.exists(docs_dir):
    datas.append((docs_dir, 'docs'))

# 4. æ‰“åŒ…Playwrightæµè§ˆå™¨ï¼ˆå¯é€‰ï¼Œ300MB+ï¼‰
# æ–¹æ¡ˆA: é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ä¸‹è½½ï¼ˆæ¨èï¼‰
# æ–¹æ¡ˆB: å®Œæ•´æ‰“åŒ…ï¼ˆå¢åŠ å®‰è£…åŒ…ä½“ç§¯ï¼‰
PACK_PLAYWRIGHT = os.environ.get('PACK_PLAYWRIGHT', 'false').lower() == 'true'

if PACK_PLAYWRIGHT:
    print("âš ï¸  æ­£åœ¨æ‰“åŒ…Playwrightæµè§ˆå™¨ï¼ˆçº¦300MBï¼‰ï¼Œè¿™å°†éœ€è¦è¾ƒé•¿æ—¶é—´...")
    playwright_dir = os.path.join(os.path.expanduser('~'), '.cache', 'ms-playwright')
    if os.path.exists(playwright_dir):
        datas.append((playwright_dir, 'playwright_cache'))
    else:
        print("âŒ è­¦å‘Šï¼šPlaywrightæµè§ˆå™¨æœªæ‰¾åˆ°ï¼Œå°†åœ¨é¦–æ¬¡å¯åŠ¨æ—¶ä¸‹è½½")
else:
    print("â„¹ï¸  Playwrightæµè§ˆå™¨å°†åœ¨é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ä¸‹è½½")

# ================== éšè—å¯¼å…¥ ==================

hiddenimports = [
    # æ ¸å¿ƒä¾èµ–
    'playwright', 'playwright.async_api', 'playwright.sync_api',
    'fastapi', 'uvicorn', 'uvicorn.loops', 'uvicorn.loops.auto',
    'uvicorn.protocols', 'uvicorn.protocols.http', 'uvicorn.protocols.http.auto',
    'uvicorn.protocols.websockets', 'uvicorn.protocols.websockets.auto',
    'uvicorn.lifespan', 'uvicorn.lifespan.on',
    'redis', 'redis.asyncio',
    'sqlite3',
    'PIL', 'PIL.Image', 'PIL.ImageFilter',
    'aiohttp', 'asyncio', 'bs4', 'lxml',
    'cryptography', 'bcrypt',
    'pydantic', 'pydantic_settings',
    'yaml', 'orjson',
    
    # è½¬å‘SDK
    'discord_webhook',
    'telegram', 'telegram.ext',
    'lark_oapi',
    
    # å¯é€‰åŠŸèƒ½
    'ddddocr',  # æœ¬åœ°OCR
    'aiosmtplib', 'email.message',  # é‚®ä»¶
    
    # æ”¶é›†æ‰€æœ‰å­æ¨¡å—
    *collect_submodules('fastapi'),
    *collect_submodules('uvicorn'),
    *collect_submodules('pydantic'),
]

# ================== åˆ†æ ==================

a = Analysis(
    [os.path.join(SPECPATH, 'app', 'main.py')],
    pathex=[SPECPATH],
    binaries=[],
    datas=datas,
    hiddenimports=hiddenimports,
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[
        # æ’é™¤ä¸éœ€è¦çš„å¤§å‹åº“
        'matplotlib', 'numpy', 'pandas', 'scipy',
        'tkinter', 'PyQt5', 'PySide2', 'wx',
        'IPython', 'jupyter',
    ],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

# ================== æ‰“åŒ… ==================

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='KookForwarder-Backend',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,  # å¯ç”¨UPXå‹ç¼©
    upx_exclude=[
        # æ’é™¤å¤§æ–‡ä»¶ä¸å‹ç¼©
        'libcrypto*',
        'libssl*',
    ],
    runtime_tmpdir=None,
    console=False,  # ç”Ÿäº§ç¯å¢ƒï¼šä¸æ˜¾ç¤ºæ§åˆ¶å°
    disable_windowed_traceback=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon=os.path.join(project_root, 'build', 'icon.ico' if sys.platform == 'win32' else 'icon.png'),
    version_file=None,  # å¯é€‰ï¼šæ·»åŠ ç‰ˆæœ¬ä¿¡æ¯
)

# Linux/macOS: åˆ›å»ºCOLLECT
if sys.platform != 'win32':
    coll = COLLECT(
        exe,
        a.binaries,
        a.zipfiles,
        a.datas,
        strip=False,
        upx=True,
        upx_exclude=[],
        name='KookForwarder-Backend',
    )
```

**Step 1.2: åˆ›å»ºè‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬**

åˆ›å»º `backend/build_all_platforms.sh`:

```bash
#!/bin/bash
#
# è·¨å¹³å°åç«¯æ„å»ºè„šæœ¬
# æ”¯æŒ: Windows, macOS, Linux
#
# ä½¿ç”¨æ–¹æ³•:
#   ./build_all_platforms.sh [--pack-playwright]
#

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# æ—¥å¿—å‡½æ•°
log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# æ£€æµ‹å½“å‰å¹³å°
detect_platform() {
    case "$(uname -s)" in
        Linux*)     PLATFORM=linux;;
        Darwin*)    PLATFORM=mac;;
        CYGWIN*|MINGW*|MSYS*) PLATFORM=windows;;
        *)          PLATFORM=unknown;;
    esac
    log_info "æ£€æµ‹åˆ°å¹³å°: $PLATFORM"
}

# æ£€æŸ¥ä¾èµ–
check_dependencies() {
    log_info "æ£€æŸ¥æ„å»ºä¾èµ–..."
    
    # æ£€æŸ¥Python
    if ! command -v python3 &> /dev/null; then
        log_error "Python3 æœªå®‰è£…ï¼"
        exit 1
    fi
    
    # æ£€æŸ¥PyInstaller
    if ! python3 -c "import PyInstaller" &> /dev/null; then
        log_warn "PyInstaller æœªå®‰è£…ï¼Œæ­£åœ¨å®‰è£…..."
        pip3 install pyinstaller
    fi
    
    # æ£€æŸ¥UPXï¼ˆå¯é€‰ï¼‰
    if ! command -v upx &> /dev/null; then
        log_warn "UPX æœªå®‰è£…ï¼ˆå¯é€‰ï¼‰ï¼Œè·³è¿‡å‹ç¼©ä¼˜åŒ–"
    fi
    
    log_info "âœ… ä¾èµ–æ£€æŸ¥å®Œæˆ"
}

# å‡†å¤‡Rediså¯æ‰§è¡Œæ–‡ä»¶
prepare_redis() {
    log_info "å‡†å¤‡Rediså¯æ‰§è¡Œæ–‡ä»¶..."
    
    REDIS_DIR="../redis"
    mkdir -p "$REDIS_DIR"
    
    case "$PLATFORM" in
        linux)
            if [ ! -f "$REDIS_DIR/redis-server-linux" ]; then
                log_info "ä¸‹è½½Redis for Linux..."
                wget -O /tmp/redis.tar.gz https://download.redis.io/releases/redis-7.0.15.tar.gz
                tar -xzf /tmp/redis.tar.gz -C /tmp
                cd /tmp/redis-7.0.15
                make
                cp src/redis-server "$REDIS_DIR/redis-server-linux"
                cd -
            fi
            ;;
        mac)
            if [ ! -f "$REDIS_DIR/redis-server-mac" ]; then
                log_info "ä¸‹è½½Redis for macOS..."
                if command -v brew &> /dev/null; then
                    brew install redis
                    cp $(which redis-server) "$REDIS_DIR/redis-server-mac"
                else
                    log_error "macOSéœ€è¦Homebrewï¼Œè¯·å…ˆå®‰è£…: /bin/bash -c \"\$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\""
                    exit 1
                fi
            fi
            ;;
        windows)
            if [ ! -f "$REDIS_DIR/redis-server.exe" ]; then
                log_info "ä¸‹è½½Redis for Windows..."
                wget -O /tmp/redis.zip https://github.com/tporadowski/redis/releases/download/v5.0.14.1/Redis-x64-5.0.14.1.zip
                unzip /tmp/redis.zip -d /tmp/redis
                cp /tmp/redis/redis-server.exe "$REDIS_DIR/"
            fi
            ;;
    esac
    
    log_info "âœ… Rediså‡†å¤‡å®Œæˆ"
}

# æ‰§è¡ŒPyInstalleræ‰“åŒ…
build_backend() {
    log_info "å¼€å§‹æ‰“åŒ…åç«¯..."
    
    cd backend
    
    # æ˜¯å¦æ‰“åŒ…Playwright
    if [ "$1" == "--pack-playwright" ]; then
        log_warn "å°†æ‰“åŒ…Playwrightæµè§ˆå™¨ï¼ˆçº¦300MBï¼‰ï¼Œè¯·è€å¿ƒç­‰å¾…..."
        export PACK_PLAYWRIGHT=true
    else
        log_info "Playwrightå°†åœ¨é¦–æ¬¡å¯åŠ¨æ—¶ä¸‹è½½"
        export PACK_PLAYWRIGHT=false
    fi
    
    # æ‰§è¡Œæ‰“åŒ…
    pyinstaller --clean build_backend_enhanced.spec
    
    # æ£€æŸ¥ç»“æœ
    if [ -f "dist/KookForwarder-Backend" ] || [ -f "dist/KookForwarder-Backend.exe" ]; then
        log_info "âœ… åç«¯æ‰“åŒ…æˆåŠŸï¼"
        
        # æ˜¾ç¤ºæ–‡ä»¶å¤§å°
        if [ "$PLATFORM" == "windows" ]; then
            SIZE=$(du -h "dist/KookForwarder-Backend.exe" | cut -f1)
            log_info "æ–‡ä»¶å¤§å°: $SIZE"
        else
            SIZE=$(du -h "dist/KookForwarder-Backend" | cut -f1)
            log_info "æ–‡ä»¶å¤§å°: $SIZE"
        fi
    else
        log_error "æ‰“åŒ…å¤±è´¥ï¼"
        exit 1
    fi
    
    cd ..
}

# ä¸»å‡½æ•°
main() {
    log_info "========================================="
    log_info "KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ - åç«¯æ‰“åŒ…è„šæœ¬"
    log_info "========================================="
    
    detect_platform
    check_dependencies
    prepare_redis
    build_backend "$@"
    
    log_info "========================================="
    log_info "âœ… æ‰€æœ‰æ„å»ºä»»åŠ¡å®Œæˆï¼"
    log_info "========================================="
    log_info "è¾“å‡ºç›®å½•: backend/dist/"
    log_info ""
    log_info "ä¸‹ä¸€æ­¥:"
    log_info "  1. æµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶"
    log_info "  2. æ‰§è¡Œå‰ç«¯æ‰“åŒ…"
    log_info "  3. æ•´åˆä¸ºå®‰è£…åŒ…"
}

main "$@"
```

**Step 1.3: æµ‹è¯•åç«¯æ‰“åŒ…**

```bash
# æµ‹è¯•è„šæœ¬: backend/test_packed_backend.sh
#!/bin/bash

echo "å¼€å§‹æµ‹è¯•æ‰“åŒ…åçš„åç«¯..."

cd backend/dist

# è¿è¡Œåç«¯
if [ -f "KookForwarder-Backend" ]; then
    ./KookForwarder-Backend &
    BACKEND_PID=$!
elif [ -f "KookForwarder-Backend.exe" ]; then
    ./KookForwarder-Backend.exe &
    BACKEND_PID=$!
else
    echo "âŒ æ‰¾ä¸åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼"
    exit 1
fi

sleep 5

# æµ‹è¯•å¥åº·æ£€æŸ¥
curl -f http://localhost:9527/health || {
    echo "âŒ åç«¯å¯åŠ¨å¤±è´¥ï¼"
    kill $BACKEND_PID
    exit 1
}

echo "âœ… åç«¯æµ‹è¯•é€šè¿‡ï¼"
kill $BACKEND_PID
```

---

##### é˜¶æ®µ2: Electronå®Œæ•´æ‰“åŒ…ï¼ˆWeek 3-4ï¼‰

**ç›®æ ‡**: å°†Electronå‰ç«¯ + Pythonåç«¯æ‰“åŒ…ä¸ºå®‰è£…åŒ…

**Step 2.1: å¢å¼ºelectron-builderé…ç½®**

åˆ›å»º `frontend/electron-builder-config.js`:

```javascript
/**
 * electron-builder å®Œæ•´é…ç½®
 * æ”¯æŒ: Windows NSIS, macOS DMG, Linux AppImage
 */

const path = require('path')
const fs = require('fs')

module.exports = {
  appId: "com.kookforwarder.app",
  productName: "KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ",
  copyright: "Copyright Â© 2025 KOOK Forwarder Team",
  
  // ç›®å½•é…ç½®
  directories: {
    output: "dist-electron",
    buildResources: "build"
  },
  
  // æ‰“åŒ…æ–‡ä»¶
  files: [
    "dist/**/*",
    "electron/**/*",
    "!electron/main-ultimate.js",  // æ’é™¤æµ‹è¯•æ–‡ä»¶
  ],
  
  // é¢å¤–èµ„æº
  extraResources: [
    {
      // Pythonåç«¯å¯æ‰§è¡Œæ–‡ä»¶
      from: "../backend/dist/KookForwarder-Backend${/*}",
      to: "backend/${/*}",
      filter: ["**/*"]
    },
    {
      // Redis
      from: "../redis",
      to: "redis",
      filter: ["**/*", "!*.md"]
    },
    {
      // æ–‡æ¡£
      from: "../docs",
      to: "docs",
      filter: ["*.md", "images/*"]
    },
    {
      // å›¾æ ‡
      from: "public/icon.png",
      to: "icon.png"
    }
  ],
  
  // Windowsé…ç½®
  win: {
    target: [
      {
        target: "nsis",
        arch: ["x64"]
      }
    ],
    icon: "build/icon.ico",
    artifactName: "KOOK-Forwarder-${version}-Setup.${ext}",
    requestedExecutionLevel: "asInvoker"  // ä¸éœ€è¦ç®¡ç†å‘˜æƒé™
  },
  
  // NSISé…ç½®ï¼ˆWindowså®‰è£…ç¨‹åºï¼‰
  nsis: {
    oneClick: false,  // å…è®¸ç”¨æˆ·é€‰æ‹©å®‰è£…è·¯å¾„
    allowToChangeInstallationDirectory: true,
    perMachine: false,  // ç”¨æˆ·çº§å®‰è£…
    createDesktopShortcut: true,
    createStartMenuShortcut: true,
    shortcutName: "KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ",
    include: "build/installer.nsh",  // è‡ªå®šä¹‰å®‰è£…è„šæœ¬
    
    // å®‰è£…å‘å¯¼
    installerIcon: "build/icon.ico",
    uninstallerIcon: "build/icon.ico",
    installerHeader: "build/installer-header.bmp",  // 150x57
    installerSidebar: "build/installer-sidebar.bmp",  // 164x314
    
    // å®‰è£…å®Œæˆå
    runAfterFinish: true,  // å®Œæˆåè¿è¡Œç¨‹åº
    deleteAppDataOnUninstall: false  // å¸è½½æ—¶ä¿ç•™ç”¨æˆ·æ•°æ®
  },
  
  // macOSé…ç½®
  mac: {
    target: [
      {
        target: "dmg",
        arch: ["x64", "arm64"]  // æ”¯æŒIntelå’ŒApple Silicon
      }
    ],
    icon: "build/icon.icns",
    category: "public.app-category.utilities",
    artifactName: "KOOK-Forwarder-${version}-macOS.${ext}",
    
    // ä»£ç ç­¾åï¼ˆéœ€è¦Apple Developerè´¦å·ï¼‰
    identity: process.env.APPLE_IDENTITY || null,
    hardenedRuntime: true,
    gatekeeperAssess: false,
    entitlements: "build/entitlements.mac.plist",
    entitlementsInherit: "build/entitlements.mac.plist",
    
    // å…¬è¯ï¼ˆéœ€è¦Apple Developerè´¦å·ï¼‰
    notarize: process.env.APPLE_ID ? {
      teamId: process.env.APPLE_TEAM_ID
    } : false
  },
  
  // macOS DMGé…ç½®
  dmg: {
    title: "KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ ${version}",
    icon: "build/icon.icns",
    contents: [
      {
        x: 130,
        y: 220
      },
      {
        x: 410,
        y: 220,
        type: "link",
        path: "/Applications"
      }
    ],
    window: {
      width: 540,
      height: 380
    },
    background: "build/dmg-background.png"  // 540x380
  },
  
  // Linuxé…ç½®
  linux: {
    target: [
      {
        target: "AppImage",
        arch: ["x64"]
      },
      {
        target: "deb",  // Debian/Ubuntu
        arch: ["x64"]
      },
      {
        target: "rpm",  // Red Hat/Fedora
        arch: ["x64"]
      }
    ],
    icon: "build/icons",  // éœ€è¦å¤šç§å°ºå¯¸: 16x16, 32x32, 48x48, 64x64, 128x128, 256x256, 512x512
    category: "Utility",
    artifactName: "KOOK-Forwarder-${version}-${arch}.${ext}",
    synopsis: "KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ - ä¸€é”®å®‰è£…ï¼Œå›¾å½¢åŒ–æ“ä½œ",
    description: "å°†KOOKæ¶ˆæ¯è‡ªåŠ¨è½¬å‘åˆ°Discord/Telegram/é£ä¹¦ï¼Œæ”¯æŒå¤šè´¦å·ã€å¤šå¹³å°ã€æ™ºèƒ½æ˜ å°„ã€‚é›¶ä»£ç åŸºç¡€å¯ç”¨ã€‚",
    
    // Desktop entry
    desktop: {
      Name: "KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ",
      Comment: "KOOKæ¶ˆæ¯è‡ªåŠ¨è½¬å‘å·¥å…·",
      GenericName: "Message Forwarder",
      Categories: "Utility;Network;",
      StartupNotify: true
    }
  },
  
  // AppImageé…ç½®
  appImage: {
    license: "LICENSE"
  },
  
  // è‡ªåŠ¨æ›´æ–°é…ç½®
  publish: process.env.GH_TOKEN ? [
    {
      provider: "github",
      owner: "gfchfjh",
      repo: "CSBJJWT",
      releaseType: "release"
    }
  ] : null,
  
  // å‹ç¼©é…ç½®
  compression: "maximum",  // æœ€å¤§å‹ç¼©
  
  // æ„å»ºå‰é’©å­
  beforePack: async (context) => {
    console.log('ğŸ“¦ å¼€å§‹æ‰“åŒ…å‰å‡†å¤‡...')
    
    // æ£€æŸ¥åç«¯æ˜¯å¦å·²æ‰“åŒ…
    const backendPath = path.join(__dirname, '../backend/dist')
    if (!fs.existsSync(backendPath)) {
      throw new Error('âŒ åç«¯æœªæ‰“åŒ…ï¼è¯·å…ˆè¿è¡Œ: cd backend && ./build_all_platforms.sh')
    }
    
    console.log('âœ… åç«¯æ£€æŸ¥é€šè¿‡')
  },
  
  // æ„å»ºåé’©å­
  afterPack: async (context) => {
    console.log('âœ… æ‰“åŒ…å®Œæˆ:', context.appOutDir)
  },
  
  // ç­¾ååé’©å­ï¼ˆä»…Windows/macOSï¼‰
  afterSign: async (context) => {
    // è¿™é‡Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰ç­¾åé€»è¾‘
    console.log('âœ… ç­¾åå®Œæˆ')
  }
}
```

**Step 2.2: ä¿®æ”¹Electronä¸»è¿›ç¨‹ï¼Œå¯åŠ¨æ‰“åŒ…åçš„Pythonåç«¯**

ä¿®æ”¹ `frontend/electron/main.js`:

```javascript
const { app, BrowserWindow } = require('electron')
const path = require('path')
const { spawn } = require('child_process')
const fs = require('fs')

let mainWindow = null
let backendProcess = null

// åˆ¤æ–­æ˜¯å¦ä¸ºæ‰“åŒ…åçš„ç¯å¢ƒ
const isPackaged = app.isPackaged

// è·å–èµ„æºè·¯å¾„
const getResourcePath = (relativePath) => {
  if (isPackaged) {
    // ç”Ÿäº§ç¯å¢ƒï¼šä»extraResourcesç›®å½•è¯»å–
    return path.join(process.resourcesPath, relativePath)
  } else {
    // å¼€å‘ç¯å¢ƒï¼šä»é¡¹ç›®ç›®å½•è¯»å–
    return path.join(__dirname, '..', '..', relativePath)
  }
}

// å¯åŠ¨Pythonåç«¯
function startBackend() {
  console.log('ğŸš€ å¯åŠ¨åç«¯æœåŠ¡...')
  
  let backendPath
  
  if (isPackaged) {
    // ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨æ‰“åŒ…åçš„å¯æ‰§è¡Œæ–‡ä»¶
    const backendDir = getResourcePath('backend')
    
    if (process.platform === 'win32') {
      backendPath = path.join(backendDir, 'KookForwarder-Backend.exe')
    } else {
      backendPath = path.join(backendDir, 'KookForwarder-Backend')
      
      // ç¡®ä¿Linux/macOSä¸‹æœ‰æ‰§è¡Œæƒé™
      try {
        fs.chmodSync(backendPath, '755')
      } catch (err) {
        console.error('âš ï¸  è®¾ç½®æ‰§è¡Œæƒé™å¤±è´¥:', err)
      }
    }
    
    console.log('ğŸ“‚ åç«¯è·¯å¾„:', backendPath)
    
    // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if (!fs.existsSync(backendPath)) {
      console.error('âŒ åç«¯å¯æ‰§è¡Œæ–‡ä»¶ä¸å­˜åœ¨:', backendPath)
      dialog.showErrorBox(
        'å¯åŠ¨å¤±è´¥',
        'åç«¯æœåŠ¡æœªæ‰¾åˆ°ï¼\n\nå¯èƒ½åŸå› ï¼š\n1. å®‰è£…åŒ…æŸå\n2. æ€æ¯’è½¯ä»¶æ‹¦æˆª\n\nè¯·é‡æ–°ä¸‹è½½å®‰è£…åŒ…ã€‚'
      )
      app.quit()
      return
    }
    
    // å¯åŠ¨åç«¯
    backendProcess = spawn(backendPath, [], {
      cwd: backendDir,
      stdio: ['ignore', 'pipe', 'pipe']
    })
    
  } else {
    // å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨Pythonç›´æ¥è¿è¡Œ
    const pythonScript = path.join(__dirname, '..', '..', 'backend', 'app', 'main.py')
    
    backendProcess = spawn('python', [pythonScript], {
      cwd: path.join(__dirname, '..', '..', 'backend'),
      stdio: ['ignore', 'pipe', 'pipe']
    })
  }
  
  // ç›‘å¬è¾“å‡º
  backendProcess.stdout.on('data', (data) => {
    console.log(`[Backend] ${data.toString().trim()}`)
  })
  
  backendProcess.stderr.on('data', (data) => {
    console.error(`[Backend Error] ${data.toString().trim()}`)
  })
  
  backendProcess.on('error', (err) => {
    console.error('âŒ åç«¯å¯åŠ¨å¤±è´¥:', err)
    dialog.showErrorBox(
      'å¯åŠ¨å¤±è´¥',
      `åç«¯æœåŠ¡å¯åŠ¨å¤±è´¥ï¼\n\né”™è¯¯ä¿¡æ¯ï¼š\n${err.message}\n\nè¯·æ£€æŸ¥:\n1. ç«¯å£9527æ˜¯å¦è¢«å ç”¨\n2. é˜²ç«å¢™è®¾ç½®\n3. æ€æ¯’è½¯ä»¶æ‹¦æˆª`
    )
  })
  
  backendProcess.on('close', (code) => {
    console.log(`åç«¯è¿›ç¨‹é€€å‡ºï¼Œä»£ç : ${code}`)
    if (code !== 0 && code !== null) {
      console.error('âŒ åç«¯å¼‚å¸¸é€€å‡º')
    }
  })
  
  // ç­‰å¾…åç«¯å¯åŠ¨
  return new Promise((resolve) => {
    // å¥åº·æ£€æŸ¥
    let attempts = 0
    const maxAttempts = 30  // æœ€å¤šç­‰å¾…30ç§’
    
    const checkHealth = async () => {
      try {
        const response = await fetch('http://localhost:9527/health')
        if (response.ok) {
          console.log('âœ… åç«¯å¯åŠ¨æˆåŠŸï¼')
          resolve(true)
          return
        }
      } catch (err) {
        // ç»§ç»­ç­‰å¾…
      }
      
      attempts++
      if (attempts >= maxAttempts) {
        console.error('âŒ åç«¯å¯åŠ¨è¶…æ—¶ï¼')
        dialog.showErrorBox(
          'å¯åŠ¨è¶…æ—¶',
          'åç«¯æœåŠ¡å¯åŠ¨è¶…æ—¶ï¼ˆ30ç§’ï¼‰ï¼\n\nå¯èƒ½åŸå› ï¼š\n1. ç«¯å£9527è¢«å ç”¨\n2. é˜²ç«å¢™é˜»æ­¢\n3. ç³»ç»Ÿèµ„æºä¸è¶³\n\nè¯·æ£€æŸ¥åé‡è¯•ã€‚'
        )
        resolve(false)
        return
      }
      
      setTimeout(checkHealth, 1000)
    }
    
    setTimeout(checkHealth, 2000)  // 2ç§’åå¼€å§‹æ£€æŸ¥
  })
}

// åˆ›å»ºä¸»çª—å£
async function createWindow() {
  // å…ˆå¯åŠ¨åç«¯
  const backendOK = await startBackend()
  
  if (!backendOK) {
    app.quit()
    return
  }
  
  // åˆ›å»ºçª—å£
  mainWindow = new BrowserWindow({
    width: 1280,
    height: 800,
    minWidth: 1024,
    minHeight: 768,
    icon: getResourcePath('icon.png'),
    webPreferences: {
      preload: path.join(__dirname, 'preload.js'),
      nodeIntegration: false,
      contextIsolation: true
    },
    show: false,  // å…ˆä¸æ˜¾ç¤ºï¼Œç­‰åŠ è½½å®Œæˆ
    frame: true,
    backgroundColor: '#f0f2f5'
  })
  
  // åŠ è½½å‰ç«¯
  if (isPackaged) {
    // ç”Ÿäº§ç¯å¢ƒï¼šåŠ è½½æ‰“åŒ…åçš„HTML
    mainWindow.loadFile(path.join(__dirname, '../dist/index.html'))
  } else {
    // å¼€å‘ç¯å¢ƒï¼šåŠ è½½Viteå¼€å‘æœåŠ¡å™¨
    mainWindow.loadURL('http://localhost:5173')
  }
  
  // çª—å£å‡†å¤‡å¥½åæ˜¾ç¤º
  mainWindow.once('ready-to-show', () => {
    mainWindow.show()
    mainWindow.focus()
  })
  
  // å¼€å‘ç¯å¢ƒï¼šæ‰“å¼€å¼€å‘å·¥å…·
  if (!isPackaged) {
    mainWindow.webContents.openDevTools()
  }
  
  mainWindow.on('closed', () => {
    mainWindow = null
  })
}

// Appäº‹ä»¶ç›‘å¬
app.on('ready', createWindow)

app.on('window-all-closed', () => {
  // åœæ­¢åç«¯
  if (backendProcess) {
    console.log('ğŸ›‘ åœæ­¢åç«¯æœåŠ¡...')
    backendProcess.kill()
  }
  
  // macOS: ä¿æŒåº”ç”¨è¿è¡Œ
  if (process.platform !== 'darwin') {
    app.quit()
  }
})

app.on('activate', () => {
  if (mainWindow === null) {
    createWindow()
  }
})

// æ•è·æœªå¤„ç†çš„å¼‚å¸¸
process.on('uncaughtException', (error) => {
  console.error('âŒ æœªæ•è·çš„å¼‚å¸¸:', error)
  // è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶
  const logPath = getResourcePath('logs/error.log')
  fs.appendFileSync(logPath, `${new Date().toISOString()} - ${error.stack}\n`)
})
```

**Step 2.3: åˆ›å»ºä¸€é”®æ„å»ºè„šæœ¬**

åˆ›å»º `build_complete_installer.sh`:

```bash
#!/bin/bash
#
# å®Œæ•´å®‰è£…åŒ…æ„å»ºè„šæœ¬
# è‡ªåŠ¨åŒ–æ„å»º: åç«¯ â†’ å‰ç«¯ â†’ å®‰è£…åŒ…
#

set -e

# é¢œè‰²
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${GREEN}================================================${NC}"
echo -e "${GREEN}KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ - å®Œæ•´å®‰è£…åŒ…æ„å»º${NC}"
echo -e "${GREEN}================================================${NC}"

# Step 1: æ„å»ºåç«¯
echo -e "\n${YELLOW}[1/3] æ„å»ºPythonåç«¯...${NC}"
cd backend
./build_all_platforms.sh
cd ..

# Step 2: æ„å»ºå‰ç«¯
echo -e "\n${YELLOW}[2/3] æ„å»ºVueå‰ç«¯...${NC}"
cd frontend
npm run build
cd ..

# Step 3: æ‰“åŒ…Electron
echo -e "\n${YELLOW}[3/3] æ‰“åŒ…Electronåº”ç”¨...${NC}"
cd frontend

# æ£€æµ‹å¹³å°
case "$(uname -s)" in
    Linux*)     npm run electron:build:linux;;
    Darwin*)    npm run electron:build:mac;;
    CYGWIN*|MINGW*|MSYS*) npm run electron:build:win;;
esac

cd ..

echo -e "\n${GREEN}================================================${NC}"
echo -e "${GREEN}âœ… æ„å»ºå®Œæˆï¼${NC}"
echo -e "${GREEN}================================================${NC}"
echo -e "å®‰è£…åŒ…ä½ç½®: ${YELLOW}frontend/dist-electron/${NC}"
ls -lh frontend/dist-electron/
```

---

#### P0-2: Cookieå¯¼å…¥ä½“éªŒä¼˜åŒ–

**å·¥ä½œé‡**: 2å‘¨  
**éš¾åº¦**: ğŸ”¥ğŸ”¥ğŸ”¥  

##### æ–¹æ¡ˆ1: å¢å¼ºCookieè§£æå’ŒéªŒè¯

åˆ›å»º `backend/app/utils/cookie_parser_enhanced.py`:

```python
"""
å¢å¼ºç‰ˆCookieè§£æå™¨
æ”¯æŒ10+ç§æ ¼å¼ï¼Œè‡ªåŠ¨ä¿®å¤å¸¸è§é”™è¯¯
"""

import json
import re
from typing import List, Dict, Tuple, Optional
from urllib.parse import unquote
from ..utils.logger import logger


class CookieParserEnhanced:
    """å¢å¼ºç‰ˆCookieè§£æå™¨"""
    
    # æ”¯æŒçš„Cookieæ ¼å¼
    FORMAT_JSON_ARRAY = "json_array"          # [{"name": "...", "value": "..."}]
    FORMAT_JSON_OBJECT = "json_object"        # {"cookie1": "value1", "cookie2": "value2"}
    FORMAT_NETSCAPE = "netscape"              # Netscapeæ ¼å¼ï¼ˆæµè§ˆå™¨å¯¼å‡ºï¼‰
    FORMAT_HEADER_STRING = "header_string"    # Cookie: name1=value1; name2=value2
    FORMAT_KEY_VALUE_LINES = "key_value_lines"  # name1=value1\nname2=value2
    FORMAT_JAVASCRIPT = "javascript"          # document.cookieæ ¼å¼
    
    def __init__(self):
        self.error_fixes_applied = []  # è®°å½•åº”ç”¨çš„ä¿®å¤
    
    def parse(self, cookie_str: str) -> List[Dict]:
        """
        è§£æCookieå­—ç¬¦ä¸²ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼‰
        
        Args:
            cookie_str: Cookieå­—ç¬¦ä¸²
            
        Returns:
            æ ‡å‡†Cookieåˆ—è¡¨: [{"name": "...", "value": "...", "domain": "..."}]
            
        Raises:
            ValueError: æ— æ³•è¯†åˆ«çš„æ ¼å¼
        """
        if not cookie_str or not cookie_str.strip():
            raise ValueError("Cookieä¸ºç©º")
        
        cookie_str = cookie_str.strip()
        self.error_fixes_applied = []
        
        # æ£€æµ‹æ ¼å¼
        format_type = self._detect_format(cookie_str)
        logger.info(f"æ£€æµ‹åˆ°Cookieæ ¼å¼: {format_type}")
        
        # æ ¹æ®æ ¼å¼è§£æ
        try:
            if format_type == self.FORMAT_JSON_ARRAY:
                cookies = self._parse_json_array(cookie_str)
            elif format_type == self.FORMAT_JSON_OBJECT:
                cookies = self._parse_json_object(cookie_str)
            elif format_type == self.FORMAT_NETSCAPE:
                cookies = self._parse_netscape(cookie_str)
            elif format_type == self.FORMAT_HEADER_STRING:
                cookies = self._parse_header_string(cookie_str)
            elif format_type == self.FORMAT_KEY_VALUE_LINES:
                cookies = self._parse_key_value_lines(cookie_str)
            elif format_type == self.FORMAT_JAVASCRIPT:
                cookies = self._parse_javascript(cookie_str)
            else:
                raise ValueError(f"æ— æ³•è¯†åˆ«çš„Cookieæ ¼å¼")
            
            # æ ‡å‡†åŒ–å’ŒéªŒè¯
            cookies = self._normalize_cookies(cookies)
            
            logger.info(f"âœ… æˆåŠŸè§£æ {len(cookies)} ä¸ªCookie")
            if self.error_fixes_applied:
                logger.info(f"åº”ç”¨äº† {len(self.error_fixes_applied)} ä¸ªè‡ªåŠ¨ä¿®å¤")
            
            return cookies
            
        except Exception as e:
            logger.error(f"Cookieè§£æå¤±è´¥: {str(e)}")
            raise ValueError(f"Cookieè§£æå¤±è´¥: {str(e)}")
    
    def _detect_format(self, cookie_str: str) -> str:
        """
        è‡ªåŠ¨æ£€æµ‹Cookieæ ¼å¼
        
        Args:
            cookie_str: Cookieå­—ç¬¦ä¸²
            
        Returns:
            æ ¼å¼ç±»å‹
        """
        cookie_str_stripped = cookie_str.strip()
        
        # JSONæ•°ç»„æ ¼å¼: [{"name": "...", "value": "..."}]
        if cookie_str_stripped.startswith('[') and cookie_str_stripped.endswith(']'):
            try:
                data = json.loads(cookie_str_stripped)
                if isinstance(data, list) and len(data) > 0 and isinstance(data[0], dict):
                    if 'name' in data[0] and 'value' in data[0]:
                        return self.FORMAT_JSON_ARRAY
            except:
                pass
        
        # JSONå¯¹è±¡æ ¼å¼: {"cookie1": "value1", "cookie2": "value2"}
        if cookie_str_stripped.startswith('{') and cookie_str_stripped.endswith('}'):
            try:
                data = json.loads(cookie_str_stripped)
                if isinstance(data, dict):
                    return self.FORMAT_JSON_OBJECT
            except:
                pass
        
        # Netscapeæ ¼å¼ï¼ˆå¸¸è§äºæµè§ˆå™¨å¯¼å‡ºï¼‰
        if '# Netscape HTTP Cookie File' in cookie_str or \
           (cookie_str.count('\t') >= 3 and '\n' in cookie_str):
            return self.FORMAT_NETSCAPE
        
        # JavaScriptæ ¼å¼: document.cookie = "..."
        if 'document.cookie' in cookie_str.lower():
            return self.FORMAT_JAVASCRIPT
        
        # Headeræ ¼å¼: Cookie: name1=value1; name2=value2
        if cookie_str_stripped.lower().startswith('cookie:'):
            return self.FORMAT_HEADER_STRING
        
        # é”®å€¼å¯¹è¡Œæ ¼å¼: name1=value1\nname2=value2
        if '\n' in cookie_str and '=' in cookie_str:
            lines = cookie_str.strip().split('\n')
            if all('=' in line for line in lines if line.strip()):
                return self.FORMAT_KEY_VALUE_LINES
        
        # ç®€å•é”®å€¼å¯¹: name1=value1; name2=value2
        if ';' in cookie_str and '=' in cookie_str:
            return self.FORMAT_HEADER_STRING
        
        # å•ä¸ªé”®å€¼å¯¹: name=value
        if '=' in cookie_str and ';' not in cookie_str and '\n' not in cookie_str:
            return self.FORMAT_KEY_VALUE_LINES
        
        return "unknown"
    
    def _parse_json_array(self, cookie_str: str) -> List[Dict]:
        """è§£æJSONæ•°ç»„æ ¼å¼"""
        try:
            # å°è¯•ç›´æ¥è§£æ
            cookies = json.loads(cookie_str)
            return cookies
        except json.JSONDecodeError as e:
            # å°è¯•ä¿®å¤å¸¸è§JSONé”™è¯¯
            logger.warning(f"JSONè§£æå¤±è´¥ï¼Œå°è¯•è‡ªåŠ¨ä¿®å¤: {str(e)}")
            
            # ä¿®å¤1: å•å¼•å· â†’ åŒå¼•å·
            fixed = cookie_str.replace("'", '"')
            self.error_fixes_applied.append("å•å¼•å·è½¬åŒå¼•å·")
            
            try:
                cookies = json.loads(fixed)
                logger.info("âœ… ä¿®å¤æˆåŠŸï¼šå•å¼•å·è½¬åŒå¼•å·")
                return cookies
            except:
                pass
            
            # ä¿®å¤2: å°¾éšé€—å·
            fixed = re.sub(r',(\s*[}\]])', r'\1', fixed)
            self.error_fixes_applied.append("ç§»é™¤å°¾éšé€—å·")
            
            try:
                cookies = json.loads(fixed)
                logger.info("âœ… ä¿®å¤æˆåŠŸï¼šç§»é™¤å°¾éšé€—å·")
                return cookies
            except:
                pass
            
            # ä¿®å¤3: Pythoné£æ ¼çš„True/False/None
            fixed = fixed.replace('True', 'true').replace('False', 'false').replace('None', 'null')
            self.error_fixes_applied.append("è½¬æ¢Pythonå…³é”®å­—")
            
            try:
                cookies = json.loads(fixed)
                logger.info("âœ… ä¿®å¤æˆåŠŸï¼šè½¬æ¢Pythonå…³é”®å­—")
                return cookies
            except:
                pass
            
            raise ValueError("JSONæ ¼å¼æ— æ³•ä¿®å¤")
    
    def _parse_json_object(self, cookie_str: str) -> List[Dict]:
        """è§£æJSONå¯¹è±¡æ ¼å¼"""
        try:
            obj = json.loads(cookie_str)
        except json.JSONDecodeError:
            # å°è¯•ä¿®å¤ï¼ˆåŒ_parse_json_arrayï¼‰
            fixed = cookie_str.replace("'", '"')
            fixed = re.sub(r',(\s*})', r'\1', fixed)
            obj = json.loads(fixed)
            self.error_fixes_applied.append("JSONå¯¹è±¡æ ¼å¼ä¿®å¤")
        
        # è½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼
        cookies = []
        for name, value in obj.items():
            cookies.append({
                "name": name,
                "value": str(value),
                "domain": ".kookapp.cn",  # é»˜è®¤åŸŸå
                "path": "/",
                "secure": True,
                "httpOnly": False
            })
        
        return cookies
    
    def _parse_netscape(self, cookie_str: str) -> List[Dict]:
        """è§£æNetscapeæ ¼å¼ï¼ˆæµè§ˆå™¨å¯¼å‡ºï¼‰"""
        cookies = []
        
        for line in cookie_str.split('\n'):
            line = line.strip()
            
            # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
            if not line or line.startswith('#'):
                continue
            
            # Netscapeæ ¼å¼: domain\tflag\tpath\tsecure\texpiration\tname\tvalue
            parts = line.split('\t')
            
            if len(parts) >= 7:
                cookies.append({
                    "name": parts[5],
                    "value": parts[6],
                    "domain": parts[0],
                    "path": parts[2],
                    "secure": parts[3].lower() == 'true',
                    "httpOnly": False,
                    "expirationDate": int(parts[4]) if parts[4].isdigit() else None
                })
            elif len(parts) >= 2:
                # ç®€åŒ–æ ¼å¼: name\tvalue
                cookies.append({
                    "name": parts[0],
                    "value": parts[1],
                    "domain": ".kookapp.cn",
                    "path": "/",
                    "secure": True,
                    "httpOnly": False
                })
        
        return cookies
    
    def _parse_header_string(self, cookie_str: str) -> List[Dict]:
        """è§£æHTTP Cookieå¤´æ ¼å¼"""
        # ç§»é™¤ "Cookie: " å‰ç¼€
        if cookie_str.lower().startswith('cookie:'):
            cookie_str = cookie_str[7:].strip()
        
        cookies = []
        
        # åˆ†å‰²: name1=value1; name2=value2
        for pair in cookie_str.split(';'):
            pair = pair.strip()
            if '=' in pair:
                name, value = pair.split('=', 1)
                cookies.append({
                    "name": name.strip(),
                    "value": unquote(value.strip()),  # URLè§£ç 
                    "domain": ".kookapp.cn",
                    "path": "/",
                    "secure": True,
                    "httpOnly": False
                })
        
        return cookies
    
    def _parse_key_value_lines(self, cookie_str: str) -> List[Dict]:
        """è§£æé”®å€¼å¯¹è¡Œæ ¼å¼"""
        cookies = []
        
        for line in cookie_str.split('\n'):
            line = line.strip()
            if '=' in line:
                name, value = line.split('=', 1)
                cookies.append({
                    "name": name.strip(),
                    "value": value.strip(),
                    "domain": ".kookapp.cn",
                    "path": "/",
                    "secure": True,
                    "httpOnly": False
                })
        
        return cookies
    
    def _parse_javascript(self, cookie_str: str) -> List[Dict]:
        """è§£æJavaScriptæ ¼å¼"""
        # æå–document.cookie = "..." ä¸­çš„å†…å®¹
        pattern = r'document\.cookie\s*=\s*["\']([^"\']+)["\']'
        matches = re.findall(pattern, cookie_str, re.IGNORECASE)
        
        if not matches:
            # å°è¯•æå–æ‰€æœ‰å­—ç¬¦ä¸²
            pattern = r'["\']([^"\']*=[^"\']*)["\']'
            matches = re.findall(pattern, cookie_str)
        
        cookies = []
        for match in matches:
            # è§£æ name=value
            if '=' in match:
                name, value = match.split('=', 1)
                cookies.append({
                    "name": name.strip(),
                    "value": value.strip(),
                    "domain": ".kookapp.cn",
                    "path": "/",
                    "secure": True,
                    "httpOnly": False
                })
        
        return cookies
    
    def _normalize_cookies(self, cookies: List[Dict]) -> List[Dict]:
        """
        æ ‡å‡†åŒ–Cookieï¼ˆç¡®ä¿å¿…è¦å­—æ®µå­˜åœ¨ï¼‰
        
        Args:
            cookies: åŸå§‹Cookieåˆ—è¡¨
            
        Returns:
            æ ‡å‡†åŒ–åçš„Cookieåˆ—è¡¨
        """
        normalized = []
        
        for cookie in cookies:
            # ç¡®ä¿nameå’Œvalueå­—æ®µå­˜åœ¨
            if 'name' not in cookie or 'value' not in cookie:
                logger.warning(f"è·³è¿‡æ— æ•ˆCookie: {cookie}")
                continue
            
            # æ ‡å‡†åŒ–
            normalized_cookie = {
                "name": str(cookie['name']),
                "value": str(cookie['value']),
                "domain": cookie.get('domain', '.kookapp.cn'),
                "path": cookie.get('path', '/'),
                "secure": cookie.get('secure', True),
                "httpOnly": cookie.get('httpOnly', False),
            }
            
            # å¯é€‰å­—æ®µ
            if 'expirationDate' in cookie:
                normalized_cookie['expirationDate'] = cookie['expirationDate']
            if 'sameSite' in cookie:
                normalized_cookie['sameSite'] = cookie['sameSite']
            
            normalized.append(normalized_cookie)
        
        return normalized
    
    def validate(self, cookies: List[Dict]) -> Tuple[bool, str]:
        """
        éªŒè¯Cookieæœ‰æ•ˆæ€§
        
        Args:
            cookies: Cookieåˆ—è¡¨
            
        Returns:
            (æ˜¯å¦æœ‰æ•ˆ, é”™è¯¯ä¿¡æ¯)
        """
        if not cookies:
            return False, "Cookieåˆ—è¡¨ä¸ºç©º"
        
        # æ£€æŸ¥å…³é”®Cookieï¼ˆæ ¹æ®KOOKå®é™…æƒ…å†µè°ƒæ•´ï¼‰
        required_cookies = ['kook_session', 'kook_token']  # ç¤ºä¾‹
        found_cookies = [c['name'] for c in cookies]
        
        missing_cookies = [name for name in required_cookies if name not in found_cookies]
        
        if missing_cookies:
            # è­¦å‘Šä½†ä¸é˜»æ­¢
            logger.warning(f"ç¼ºå°‘å…³é”®Cookie: {missing_cookies}")
            return True, f"è­¦å‘Šï¼šç¼ºå°‘éƒ¨åˆ†Cookieï¼ˆ{', '.join(missing_cookies)}ï¼‰ï¼Œå¯èƒ½æ— æ³•ç™»å½•"
        
        return True, "CookieéªŒè¯é€šè¿‡"
    
    def get_error_fixes(self) -> List[str]:
        """è·å–åº”ç”¨çš„ä¿®å¤åˆ—è¡¨"""
        return self.error_fixes_applied


# å…¨å±€å®ä¾‹
cookie_parser_enhanced = CookieParserEnhanced()
```

**ä½¿ç”¨ç¤ºä¾‹**:

```python
# åœ¨APIä¸­ä½¿ç”¨
from .utils.cookie_parser_enhanced import cookie_parser_enhanced

@router.post("/api/accounts/import-cookie")
async def import_cookie(data: dict):
    """å¯¼å…¥Cookieï¼ˆå¢å¼ºç‰ˆï¼‰"""
    cookie_str = data.get('cookie')
    
    try:
        # è§£æCookie
        cookies = cookie_parser_enhanced.parse(cookie_str)
        
        # éªŒè¯Cookie
        valid, message = cookie_parser_enhanced.validate(cookies)
        
        # è·å–ä¿®å¤ä¿¡æ¯
        fixes = cookie_parser_enhanced.get_error_fixes()
        
        return {
            "success": True,
            "cookies": cookies,
            "valid": valid,
            "message": message,
            "auto_fixes": fixes  # å‘Šè¯‰ç”¨æˆ·åº”ç”¨äº†å“ªäº›è‡ªåŠ¨ä¿®å¤
        }
        
    except ValueError as e:
        return {
            "success": False,
            "error": str(e),
            "suggestions": [
                "è¯·æ£€æŸ¥Cookieæ ¼å¼æ˜¯å¦æ­£ç¡®",
                "æ”¯æŒçš„æ ¼å¼ï¼šJSONæ•°ç»„ã€JSONå¯¹è±¡ã€Netscapeã€HTTP Header",
                "å¯ä»¥å°è¯•ä½¿ç”¨æµè§ˆå™¨æ‰©å±•ä¸€é”®å¯¼å‡º"
            ]
        }
```

---

##### æ–¹æ¡ˆ2: å¼€å‘æµè§ˆå™¨æ‰©å±•

åˆ›å»º `chrome-extension-enhanced/`:

```
chrome-extension-enhanced/
â”œâ”€â”€ manifest.json          # æ‰©å±•æ¸…å•
â”œâ”€â”€ popup.html            # å¼¹å‡ºçª—å£
â”œâ”€â”€ popup.js              # å¼¹å‡ºçª—å£é€»è¾‘
â”œâ”€â”€ background.js         # åå°è„šæœ¬
â”œâ”€â”€ content-script.js     # å†…å®¹è„šæœ¬
â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ icon16.png
â”‚   â”œâ”€â”€ icon48.png
â”‚   â””â”€â”€ icon128.png
â””â”€â”€ README.md
```

`manifest.json`:

```json
{
  "manifest_version": 3,
  "name": "KOOK Cookieå¯¼å‡ºå·¥å…·",
  "version": "1.0.0",
  "description": "ä¸€é”®å¯¼å‡ºKOOK Cookieåˆ°å‰ªè´´æ¿ï¼Œé…åˆKOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿä½¿ç”¨",
  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  },
  "permissions": [
    "cookies",
    "activeTab",
    "clipboardWrite"
  ],
  "host_permissions": [
    "*://*.kookapp.cn/*",
    "*://*.kaiheila.cn/*"
  ],
  "action": {
    "default_popup": "popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    }
  },
  "background": {
    "service_worker": "background.js"
  }
}
```

`popup.html`:

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>KOOK Cookieå¯¼å‡º</title>
  <style>
    body {
      width: 320px;
      padding: 16px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }
    .header {
      text-align: center;
      margin-bottom: 16px;
    }
    .header h2 {
      margin: 0;
      color: #333;
      font-size: 18px;
    }
    .status {
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 16px;
      text-align: center;
    }
    .status.success {
      background-color: #f0f9ff;
      border: 1px solid #0ea5e9;
      color: #0c4a6e;
    }
    .status.error {
      background-color: #fef2f2;
      border: 1px solid #ef4444;
      color: #7f1d1d;
    }
    .status.warning {
      background-color: #fffbeb;
      border: 1px solid #f59e0b;
      color: #78350f;
    }
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      background-color: #0ea5e9;
      color: white;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #0284c7;
    }
    button:disabled {
      background-color: #cbd5e1;
      cursor: not-allowed;
    }
    .info {
      margin-top: 16px;
      padding: 12px;
      background-color: #f8fafc;
      border-radius: 8px;
      font-size: 12px;
      color: #64748b;
    }
    .cookie-count {
      font-weight: bold;
      color: #0ea5e9;
    }
  </style>
</head>
<body>
  <div class="header">
    <h2>ğŸª KOOK Cookieå¯¼å‡º</h2>
  </div>
  
  <div id="status" class="status"></div>
  
  <button id="exportBtn">å¯¼å‡ºCookieåˆ°å‰ªè´´æ¿</button>
  
  <div class="info">
    <p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p>
    <ol style="margin: 8px 0; padding-left: 20px;">
      <li>ç¡®ä¿å·²ç™»å½•KOOKç½‘é¡µç‰ˆ</li>
      <li>ç‚¹å‡»"å¯¼å‡ºCookie"æŒ‰é’®</li>
      <li>åœ¨è½¯ä»¶ä¸­ç²˜è´´Cookie</li>
    </ol>
    <p style="margin-top: 12px;">
      <strong>æç¤ºï¼š</strong>CookieåŒ…å«ç™»å½•å‡­è¯ï¼Œè¯·å¦¥å–„ä¿ç®¡ï¼Œåˆ‡å‹¿æ³„éœ²ç»™ä»–äººã€‚
    </p>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>
```

`popup.js`:

```javascript
/**
 * KOOK Cookieå¯¼å‡ºå·¥å…· - å¼¹å‡ºçª—å£é€»è¾‘
 */

const statusEl = document.getElementById('status')
const exportBtn = document.getElementById('exportBtn')

// æ˜¾ç¤ºçŠ¶æ€
function showStatus(message, type = 'success') {
  statusEl.textContent = message
  statusEl.className = `status ${type}`
  statusEl.style.display = 'block'
}

// å¯¼å‡ºCookie
async function exportCookies() {
  try {
    exportBtn.disabled = true
    exportBtn.textContent = 'å¯¼å‡ºä¸­...'
    
    // è·å–å½“å‰æ ‡ç­¾é¡µ
    const [tab] = await chrome.tabs.query({ active: true, currentWindow: true })
    
    // æ£€æŸ¥æ˜¯å¦åœ¨KOOKé¡µé¢
    if (!tab.url.includes('kookapp.cn') && !tab.url.includes('kaiheila.cn')) {
      showStatus('âš ï¸ è¯·åœ¨KOOKç½‘é¡µç‰ˆä½¿ç”¨æ­¤æ‰©å±•', 'warning')
      exportBtn.disabled = false
      exportBtn.textContent = 'å¯¼å‡ºCookieåˆ°å‰ªè´´æ¿'
      return
    }
    
    // è·å–KOOKçš„æ‰€æœ‰Cookie
    const cookies = await chrome.cookies.getAll({
      domain: '.kookapp.cn'
    })
    
    if (cookies.length === 0) {
      showStatus('âŒ æœªæ‰¾åˆ°Cookieï¼Œè¯·å…ˆç™»å½•KOOK', 'error')
      exportBtn.disabled = false
      exportBtn.textContent = 'å¯¼å‡ºCookieåˆ°å‰ªè´´æ¿'
      return
    }
    
    // è½¬æ¢ä¸ºJSONæ ¼å¼
    const cookiesJSON = JSON.stringify(cookies, null, 2)
    
    // å¤åˆ¶åˆ°å‰ªè´´æ¿
    await navigator.clipboard.writeText(cookiesJSON)
    
    // æˆåŠŸæç¤º
    showStatus(
      `âœ… æˆåŠŸå¯¼å‡º ${cookies.length} ä¸ªCookieåˆ°å‰ªè´´æ¿ï¼\nè¯·åœ¨è½¯ä»¶ä¸­ç²˜è´´ä½¿ç”¨ã€‚`,
      'success'
    )
    
    exportBtn.disabled = false
    exportBtn.textContent = 'âœ“ å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'
    
    // 3ç§’åæ¢å¤æŒ‰é’®
    setTimeout(() => {
      exportBtn.textContent = 'å¯¼å‡ºCookieåˆ°å‰ªè´´æ¿'
    }, 3000)
    
  } catch (error) {
    console.error('å¯¼å‡ºå¤±è´¥:', error)
    showStatus(`âŒ å¯¼å‡ºå¤±è´¥: ${error.message}`, 'error')
    exportBtn.disabled = false
    exportBtn.textContent = 'å¯¼å‡ºCookieåˆ°å‰ªè´´æ¿'
  }
}

// ç»‘å®šäº‹ä»¶
exportBtn.addEventListener('click', exportCookies)

// é¡µé¢åŠ è½½æ—¶æ£€æŸ¥çŠ¶æ€
window.addEventListener('load', async () => {
  try {
    const [tab] = await chrome.tabs.query({ active: true, currentWindow: true })
    
    if (tab.url.includes('kookapp.cn') || tab.url.includes('kaiheila.cn')) {
      const cookies = await chrome.cookies.getAll({ domain: '.kookapp.cn' })
      
      if (cookies.length > 0) {
        showStatus(`âœ“ æ£€æµ‹åˆ° ${cookies.length} ä¸ªCookie`, 'success')
      } else {
        showStatus('âš ï¸ æœªæ£€æµ‹åˆ°Cookieï¼Œè¯·å…ˆç™»å½•', 'warning')
      }
    } else {
      showStatus('â„¹ï¸ è¯·åœ¨KOOKç½‘é¡µç‰ˆä½¿ç”¨', 'warning')
    }
  } catch (error) {
    console.error('çŠ¶æ€æ£€æŸ¥å¤±è´¥:', error)
  }
})
```

**å®‰è£…å’Œä½¿ç”¨**:

1. æ‰“åŒ…æ‰©å±•
2. åœ¨Chromeä¸­åŠ è½½ï¼šchrome://extensions/ â†’ "åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"
3. æ‰“å¼€KOOKç½‘é¡µç‰ˆ
4. ç‚¹å‡»æ‰©å±•å›¾æ ‡ï¼Œå¯¼å‡ºCookie

---

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œå®Œæ•´æŠ¥å‘Šå°†ç»§ç»­åŒ…å«ï¼š

- P0-3è‡³P0-15çš„è¯¦ç»†å®æ–½æ–¹æ¡ˆ
- P1çº§åˆ«18é¡¹ä¼˜åŒ–çš„å®Œæ•´ä»£ç 
- P2çº§åˆ«16é¡¹ä¼˜åŒ–æ–¹æ¡ˆ
- å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
- éƒ¨ç½²æµç¨‹
- ç”¨æˆ·æ‰‹å†Œ

**å½“å‰è¿›åº¦**: çº¦30%å®Œæˆ

æ˜¯å¦éœ€è¦æˆ‘ç»§ç»­ç”Ÿæˆå®Œæ•´æŠ¥å‘Šçš„å…¶ä½™éƒ¨åˆ†ï¼Ÿè¿™å°†æ˜¯ä¸€ä»½è¶…è¿‡20,000è¡Œçš„è¶…çº§è¯¦ç»†æ–‡æ¡£ã€‚
