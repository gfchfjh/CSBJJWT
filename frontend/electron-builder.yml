appId: com.kookforwarder.app
productName: KOOK消息转发系统
copyright: Copyright © 2025 KOOK Forwarder Team
directories:
  output: dist-electron
  buildResources: ../build

# 包含的文件
files:
  - dist/**/*
  - electron/**/*
  - package.json
  - "!node_modules/**/*"
  - "!src/**/*"
  - "!public/**/*"

# 额外资源（运行时需要）
extraResources:
  - from: ../build/icon.png
    to: resources/icon.png
  - from: electron/resources
    to: resources
    filter:
      - "**/*"
  # 嵌入式Redis
  - from: ../redis
    to: resources/redis
    filter:
      - redis-server*
      - redis.conf
  # 后端可执行文件
  - from: ../dist
    to: resources/backend
    filter:
      - kook-forwarder-backend*

# Windows配置
win:
  target:
    - target: nsis
      arch:
        - x64
  icon: ../build/icon.ico
  artifactName: ${productName}-${version}-Windows-${arch}.${ext}
  
# NSIS安装程序配置
nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  perMachine: false
  allowElevation: true
  installerIcon: ../build/icon.ico
  uninstallerIcon: ../build/icon.ico
  installerHeaderIcon: ../build/icon.ico
  createDesktopShortcut: always
  createStartMenuShortcut: true
  shortcutName: KOOK消息转发系统
  license: ../LICENSE
  include: ../build/installer.nsh

# macOS配置
mac:
  target:
    - target: dmg
      arch:
        - x64
        - arm64
  icon: ../build/icon.icns
  category: public.app-category.utilities
  artifactName: ${productName}-${version}-macOS-${arch}.${ext}
  hardenedRuntime: true
  gatekeeperAssess: false
  entitlements: ../build/entitlements.mac.plist
  entitlementsInherit: ../build/entitlements.mac.plist

# macOS DMG配置
dmg:
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications
  window:
    width: 540
    height: 380

# Linux配置
linux:
  target:
    - target: AppImage
      arch:
        - x64
  icon: ../build/icon.png
  category: Utility
  artifactName: ${productName}-${version}-Linux-${arch}.${ext}
  executableName: kook-forwarder
  desktop:
    Name: KOOK消息转发系统
    Comment: KOOK消息转发到Discord/Telegram/飞书
    Categories: Utility;Network;

# 发布配置（禁用自动发布）
publish: null

# 压缩选项
compression: maximum
npmRebuild: false
