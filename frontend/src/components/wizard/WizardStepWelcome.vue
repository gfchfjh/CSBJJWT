<template>
  <div class="step-welcome">
    <div class="welcome-header">
      <h1 class="welcome-title">ğŸ‰ æ¬¢è¿ä½¿ç”¨KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ</h1>
      <p class="welcome-subtitle">v6.3.0 å‚»ç“œå¼ä¸€é”®å®‰è£…ç‰ˆ</p>
      <p class="welcome-description">æœ¬å‘å¯¼å°†å¼•å¯¼æ‚¨å®ŒæˆåŸºç¡€é…ç½®ï¼Œé¢„è®¡è€—æ—¶ï¼š3-5åˆ†é’Ÿ</p>
    </div>

    <!-- âœ… P0-1ä¼˜åŒ–å®Œæˆï¼šå¼ºåˆ¶æ»šåŠ¨é˜…è¯»çš„å…è´£å£°æ˜ -->
    <div class="disclaimer-wrapper">
      <div class="disclaimer-header">
        <el-icon :size="32" color="#E6A23C"><WarningFilled /></el-icon>
        <h2>å…è´£å£°æ˜ä¸ä½¿ç”¨åè®®</h2>
        <el-tag type="danger" size="large">å¿…è¯»</el-tag>
      </div>

      <div 
        ref="disclaimerScrollRef"
        class="disclaimer-scroll-area"
        :class="{ 'force-read': !hasScrolledToBottom }"
        @scroll="handleScroll"
      >
        <div class="disclaimer-content">
          <p class="disclaimer-intro">
            <strong>åœ¨ä½¿ç”¨æœ¬è½¯ä»¶ä¹‹å‰ï¼Œè¯·æ‚¨åŠ¡å¿…ä»”ç»†é˜…è¯»å¹¶å……åˆ†ç†è§£ä»¥ä¸‹å…¨éƒ¨æ¡æ¬¾ã€‚</strong>
            æœ¬å£°æ˜å…·æœ‰æ³•å¾‹æ•ˆåŠ›ï¼Œä¸€æ—¦æ‚¨å¼€å§‹ä½¿ç”¨æœ¬è½¯ä»¶ï¼Œå³è§†ä¸ºæ‚¨å·²å®Œå…¨ç†è§£å¹¶åŒæ„éµå®ˆæœ¬å£°æ˜çš„æ‰€æœ‰å†…å®¹ã€‚
          </p>

          <div class="disclaimer-section">
            <h3>ä¸€ã€è½¯ä»¶æ€§è´¨ä¸ç”¨é€”</h3>
            <ol>
              <li>æœ¬è½¯ä»¶æ˜¯ä¸€æ¬¾<strong>æ¶ˆæ¯è½¬å‘å·¥å…·</strong>ï¼Œé€šè¿‡æµè§ˆå™¨è‡ªåŠ¨åŒ–æŠ€æœ¯æŠ“å–KOOKå¹³å°çš„æ¶ˆæ¯ï¼Œå¹¶è½¬å‘è‡³å…¶ä»–å¹³å°ï¼ˆDiscordã€Telegramã€é£ä¹¦ç­‰ï¼‰ã€‚</li>
              <li>æœ¬è½¯ä»¶<strong>ä»…ä¾›ä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’ŒæŠ€æœ¯äº¤æµä½¿ç”¨</strong>ï¼Œä¸å¾—ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚</li>
              <li>æœ¬è½¯ä»¶ä¸º<strong>å¼€æºè½¯ä»¶</strong>ï¼Œé‡‡ç”¨MITè®¸å¯è¯å‘å¸ƒï¼Œæºä»£ç å®Œå…¨å…¬å¼€ã€‚</li>
            </ol>
          </div>

          <div class="disclaimer-section disclaimer-warning">
            <h3>äºŒã€é‡è¦é£é™©æç¤º âš ï¸</h3>
            <ol>
              <li>
                <strong class="risk-high">ã€è´¦å·é£é™©ã€‘</strong>
                æœ¬è½¯ä»¶é€šè¿‡æµè§ˆå™¨è‡ªåŠ¨åŒ–æŠ€æœ¯æŠ“å–KOOKæ¶ˆæ¯ï¼Œè¯¥è¡Œä¸º<strong>å¯èƒ½è¿åKOOKå¹³å°çš„æœåŠ¡æ¡æ¬¾</strong>ã€‚
                ä½¿ç”¨æœ¬è½¯ä»¶å¯èƒ½å¯¼è‡´æ‚¨çš„KOOKè´¦å·è¢«<strong>è­¦å‘Šã€é™åˆ¶æˆ–æ°¸ä¹…å°ç¦</strong>ã€‚
              </li>
              <li>
                <strong class="risk-high">ã€æ³•å¾‹é£é™©ã€‘</strong>
                è½¬å‘ä»–äººå‘å¸ƒçš„æ¶ˆæ¯å†…å®¹ï¼Œå¯èƒ½æ¶‰åŠ<strong>ä¾µçŠ¯è‘—ä½œæƒã€éšç§æƒã€è‚–åƒæƒ</strong>ç­‰æ³•å¾‹é—®é¢˜ã€‚
                è¯·ç¡®ä¿æ‚¨æœ‰æƒè½¬å‘ç›¸å…³å†…å®¹ï¼Œå¦åˆ™å¯èƒ½æ‰¿æ‹…æ³•å¾‹è´£ä»»ã€‚
              </li>
              <li>
                <strong class="risk-medium">ã€éšç§é£é™©ã€‘</strong>
                æœ¬è½¯ä»¶éœ€è¦æ‚¨çš„KOOKç™»å½•å‡­è¯ï¼ˆCookieæˆ–è´¦å·å¯†ç ï¼‰ï¼Œè¯·<strong>å¦¥å–„ä¿ç®¡</strong>ï¼Œä¸è¦ä¸ä»–äººåˆ†äº«ã€‚
                å¼€å‘è€…<strong>ä¸ä¼šæ”¶é›†</strong>æ‚¨çš„ä»»ä½•ä¸ªäººä¿¡æ¯ï¼Œæ‰€æœ‰æ•°æ®å‡å­˜å‚¨åœ¨æœ¬åœ°ã€‚
              </li>
              <li>
                <strong class="risk-medium">ã€ç¨³å®šæ€§é£é™©ã€‘</strong>
                KOOKå¹³å°å¯èƒ½éšæ—¶æ›´æ–°å…¶ç½‘é¡µç»“æ„æˆ–APIï¼Œå¯¼è‡´æœ¬è½¯ä»¶æ— æ³•æ­£å¸¸å·¥ä½œã€‚
                å¼€å‘è€…ä¼šå°½åŠ›ç»´æŠ¤ï¼Œä½†<strong>ä¸ä¿è¯100%å¯ç”¨</strong>ã€‚
              </li>
              <li>
                <strong class="risk-low">ã€å…¼å®¹æ€§é£é™©ã€‘</strong>
                æœ¬è½¯ä»¶åœ¨ä¸åŒæ“ä½œç³»ç»Ÿã€ä¸åŒç½‘ç»œç¯å¢ƒä¸‹çš„è¡¨ç°å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚
              </li>
            </ol>
          </div>

          <div class="disclaimer-section">
            <h3>ä¸‰ã€æˆæƒä¸é™åˆ¶</h3>
            <ol>
              <li><strong>æˆæƒåœºæ™¯</strong>ï¼šæ‚¨åº”å½“ä»…åœ¨ä»¥ä¸‹åœºæ™¯ä½¿ç”¨æœ¬è½¯ä»¶ï¼š
                <ul>
                  <li>æ‚¨æ˜¯KOOKæœåŠ¡å™¨çš„<strong>æ‰€æœ‰è€…æˆ–ç®¡ç†å‘˜</strong>ï¼Œä¸”å·²è·å¾—æˆå‘˜çš„åŒæ„</li>
                  <li>ç”¨äº<strong>ä¸ªäººå­¦ä¹ å’Œç ”ç©¶</strong>ç›®çš„ï¼Œä¸ä¼ æ’­æˆ–å…¬å¼€è½¬å‘å†…å®¹</li>
                  <li>ç”¨äº<strong>å¤‡ä»½è‡ªå·±å‘å¸ƒçš„å†…å®¹</strong></li>
                </ul>
              </li>
              <li><strong>ç¦æ­¢è¡Œä¸º</strong>ï¼šä¸¥ç¦ä½¿ç”¨æœ¬è½¯ä»¶è¿›è¡Œä»¥ä¸‹è¡Œä¸ºï¼š
                <ul>
                  <li>æœªç»æˆæƒæŠ“å–ä»–äººçš„ç§å¯†å¯¹è¯æˆ–æ•æ„Ÿä¿¡æ¯</li>
                  <li>ç”¨äºå•†ä¸šç›ˆåˆ©ã€å¹¿å‘Šæ¨å¹¿æˆ–å…¶ä»–å•†ä¸šç›®çš„</li>
                  <li>ä¼ æ’­è¿æ³•è¿è§„ã€æ·«ç§½è‰²æƒ…ã€æš´åŠ›è¡€è…¥ç­‰æœ‰å®³ä¿¡æ¯</li>
                  <li>æ¶æ„éªšæ‰°ã€è¯½è°¤ã€ä¾µçŠ¯ä»–äººåˆæ³•æƒç›Š</li>
                  <li>ç ´åã€å¹²æ‰°KOOKæˆ–å…¶ä»–å¹³å°çš„æ­£å¸¸è¿è¥</li>
                </ul>
              </li>
            </ol>
          </div>

          <div class="disclaimer-section">
            <h3>å››ã€å…è´£æ¡æ¬¾</h3>
            <ol>
              <li><strong>å¼€å‘è€…ä¸æ‰¿æ‹…è´£ä»»</strong>ï¼š
                <ul>
                  <li>å› ä½¿ç”¨æœ¬è½¯ä»¶å¯¼è‡´çš„<strong>ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±</strong>ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè´¦å·å°ç¦ã€æ•°æ®ä¸¢å¤±ã€æ³•å¾‹çº çº·ç­‰</li>
                  <li>å› è½¯ä»¶ç¼ºé™·ã€é”™è¯¯ã€ä¸­æ–­å¯¼è‡´çš„ä»»ä½•æŸå¤±</li>
                  <li>å› ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆKOOKã€Discordã€Telegramç­‰ï¼‰æ”¿ç­–å˜åŒ–å¯¼è‡´çš„ä¸å¯ç”¨</li>
                  <li>å› æ‚¨è¿åæ³•å¾‹æ³•è§„æˆ–å¹³å°è§„åˆ™å¯¼è‡´çš„ä»»ä½•åæœ</li>
                </ul>
              </li>
              <li><strong>æ— ä¿è¯å£°æ˜</strong>ï¼š
                æœ¬è½¯ä»¶æŒ‰"åŸæ ·"æä¾›ï¼Œå¼€å‘è€…<strong>ä¸æä¾›ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„ä¿è¯</strong>ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºé€‚é”€æ€§ã€é€‚ç”¨æ€§ã€å‡†ç¡®æ€§ã€å¯é æ€§ã€å®‰å…¨æ€§ç­‰ã€‚
              </li>
              <li><strong>ç¬¬ä¸‰æ–¹æœåŠ¡</strong>ï¼š
                æœ¬è½¯ä»¶ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆRedisã€Playwrightã€Chromiumç­‰ï¼‰ï¼Œè¿™äº›æœåŠ¡çš„é—®é¢˜ä¸åœ¨å¼€å‘è€…æ§åˆ¶èŒƒå›´å†…ã€‚
              </li>
            </ol>
          </div>

          <div class="disclaimer-section">
            <h3>äº”ã€ç”¨æˆ·ä¹‰åŠ¡ä¸è´£ä»»</h3>
            <ol>
              <li>æ‚¨åº”å½“<strong>å¹´æ»¡18å‘¨å²</strong>ï¼Œå…·æœ‰å®Œå…¨æ°‘äº‹è¡Œä¸ºèƒ½åŠ›ã€‚</li>
              <li>æ‚¨åº”å½“<strong>éµå®ˆæ‰€åœ¨å›½å®¶/åœ°åŒºçš„æ³•å¾‹æ³•è§„</strong>ï¼Œä»¥åŠKOOKç­‰å¹³å°çš„æœåŠ¡æ¡æ¬¾ã€‚</li>
              <li>æ‚¨åº”å½“<strong>è‡ªè¡Œæ‰¿æ‹…</strong>å› ä½¿ç”¨æœ¬è½¯ä»¶è€Œäº§ç”Ÿçš„æ‰€æœ‰é£é™©å’Œè´£ä»»ã€‚</li>
              <li>æ‚¨åº”å½“<strong>å°Šé‡ä»–äººçš„åˆæ³•æƒç›Š</strong>ï¼Œä¸å¾—ä¾µçŠ¯ä»–äººçš„éšç§ã€è‘—ä½œæƒç­‰ã€‚</li>
              <li>å¦‚æœå‘ç°æœ¬è½¯ä»¶å­˜åœ¨å®‰å…¨æ¼æ´æˆ–è¿æ³•è¿è§„å†…å®¹ï¼Œåº”åŠæ—¶å‘å¼€å‘è€…æŠ¥å‘Šã€‚</li>
            </ol>
          </div>

          <div class="disclaimer-section">
            <h3>å…­ã€çŸ¥è¯†äº§æƒ</h3>
            <ol>
              <li>æœ¬è½¯ä»¶çš„è‘—ä½œæƒå½’å¼€å‘è€…æ‰€æœ‰ï¼Œå—è‘—ä½œæƒæ³•å’Œå›½é™…æ¡çº¦ä¿æŠ¤ã€‚</li>
              <li>æœ¬è½¯ä»¶é‡‡ç”¨<strong>MITå¼€æºè®¸å¯è¯</strong>ï¼Œæ‚¨å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹ã€åˆ†å‘ï¼Œä½†éœ€ä¿ç•™åŸä½œè€…ç‰ˆæƒå£°æ˜ã€‚</li>
              <li>æœ¬è½¯ä»¶ä¸­ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“å’Œç»„ä»¶ï¼Œå…¶è‘—ä½œæƒå½’å„è‡ªä½œè€…æ‰€æœ‰ã€‚</li>
            </ol>
          </div>

          <div class="disclaimer-section">
            <h3>ä¸ƒã€åè®®å˜æ›´ä¸ç»ˆæ­¢</h3>
            <ol>
              <li>å¼€å‘è€…ä¿ç•™<strong>éšæ—¶ä¿®æ”¹æœ¬å£°æ˜</strong>çš„æƒåˆ©ï¼Œä¿®æ”¹åçš„å£°æ˜å°†åœ¨è½¯ä»¶æ›´æ–°æ—¶ç”Ÿæ•ˆã€‚</li>
              <li>å¦‚æ‚¨ä¸åŒæ„ä¿®æ”¹åçš„å£°æ˜ï¼Œåº”ç«‹å³<strong>åœæ­¢ä½¿ç”¨æœ¬è½¯ä»¶</strong>ã€‚</li>
              <li>å¼€å‘è€…å¯éšæ—¶<strong>åœæ­¢ç»´æŠ¤æˆ–å…³é—­æœ¬è½¯ä»¶</strong>ï¼Œæ— éœ€äº‹å…ˆé€šçŸ¥ã€‚</li>
            </ol>
          </div>

          <div class="disclaimer-section disclaimer-final">
            <h3>å…«ã€æœ€ç»ˆå£°æ˜</h3>
            <p>
              æœ¬å£°æ˜çš„è§£é‡Šæƒå½’å¼€å‘è€…æ‰€æœ‰ã€‚å¦‚æœ¬å£°æ˜çš„ä»»ä½•æ¡æ¬¾è¢«è®¤å®šä¸ºæ— æ•ˆæˆ–ä¸å¯æ‰§è¡Œï¼Œ
              è¯¥æ¡æ¬¾åº”åœ¨æœ€å°å¿…è¦èŒƒå›´å†…è¢«ä¿®æ”¹æˆ–åˆ é™¤ï¼Œæœ¬å£°æ˜çš„å…¶ä½™æ¡æ¬¾ä»ç„¶æœ‰æ•ˆã€‚
            </p>
            <p class="disclaimer-emphasis">
              <strong>å†æ¬¡æé†’ï¼šä½¿ç”¨æœ¬è½¯ä»¶å³è¡¨ç¤ºæ‚¨å·²å®Œå…¨ç†è§£å¹¶åŒæ„æœ¬å£°æ˜çš„æ‰€æœ‰å†…å®¹ï¼Œ
              å¹¶è‡ªæ„¿æ‰¿æ‹…ä½¿ç”¨æœ¬è½¯ä»¶çš„æ‰€æœ‰é£é™©ã€‚å¦‚æœæ‚¨ä¸åŒæ„æœ¬å£°æ˜çš„ä»»ä½•å†…å®¹ï¼Œ
              è¯·ç«‹å³ç‚¹å‡»"æ‹’ç»å¹¶é€€å‡º"æŒ‰é’®ï¼Œå¸è½½æœ¬è½¯ä»¶ã€‚</strong>
            </p>
          </div>

          <div class="scroll-hint" v-show="!hasScrolledToBottom">
            <el-icon :size="24" class="scroll-icon"><ArrowDown /></el-icon>
            <p>è¯·å‘ä¸‹æ»šåŠ¨é˜…è¯»å®Œæ•´å£°æ˜</p>
          </div>
        </div>
      </div>

      <!-- åªæœ‰æ»šåŠ¨åˆ°åº•éƒ¨æ‰æ˜¾ç¤º -->
      <div class="agreement-section" v-show="hasScrolledToBottom">
        <el-alert
          type="warning"
          :closable="false"
          show-icon
        >
          <p><strong>è¯·ç¡®è®¤æ‚¨å·²å®Œæ•´é˜…è¯»å¹¶ç†è§£ä¸Šè¿°å…è´£å£°æ˜</strong></p>
        </el-alert>

        <el-checkbox 
          v-model="agreed" 
          size="large"
          class="agreement-checkbox"
        >
          <strong>
            â˜‘ï¸ æˆ‘å·²å¹´æ»¡18å‘¨å²ï¼Œå·²ä»”ç»†é˜…è¯»ã€å……åˆ†ç†è§£å¹¶å®Œå…¨åŒæ„ä¸Šè¿°å…è´£å£°æ˜ä¸ä½¿ç”¨åè®®çš„å…¨éƒ¨å†…å®¹ï¼Œ
            è‡ªæ„¿æ‰¿æ‹…ä½¿ç”¨æœ¬è½¯ä»¶çš„æ‰€æœ‰é£é™©å’Œè´£ä»»
          </strong>
        </el-checkbox>

        <el-alert
          type="info"
          :closable="false"
          style="margin-top: 15px"
        >
          <p>
            ğŸ’¡ <strong>æ¸©é¦¨æç¤º</strong>ï¼šå‹¾é€‰ä¸Šè¿°å¤é€‰æ¡†å³è¡¨ç¤ºæ‚¨å·²åšå‡ºæ³•å¾‹æ‰¿è¯ºï¼Œ
            è¯·åŠ¡å¿…ç¡®ä¿æ‚¨çœŸæ­£ç†è§£å¹¶æ¥å—æ‰€æœ‰æ¡æ¬¾ã€‚
          </p>
        </el-alert>
      </div>

      <!-- æç¤ºï¼šæœªæ»šåŠ¨åˆ°åº•éƒ¨æ—¶æ˜¾ç¤º -->
      <el-alert
        v-show="!hasScrolledToBottom"
        type="warning"
        title="è¯·å…ˆé˜…è¯»å®Œæ•´çš„å…è´£å£°æ˜"
        :closable="false"
        show-icon
        style="margin-top: 20px"
      >
        æ‚¨éœ€è¦æ»šåŠ¨åˆ°å…è´£å£°æ˜åº•éƒ¨ï¼Œå®Œæ•´é˜…è¯»æ‰€æœ‰å†…å®¹åæ‰èƒ½ç»§ç»­ã€‚
      </el-alert>
    </div>

    <!-- é…ç½®å‰å‡†å¤‡ -->
    <div class="welcome-tips" v-show="hasScrolledToBottom && agreed">
      <el-alert
        title="ğŸ“‹ é…ç½®å‰å‡†å¤‡"
        type="info"
        :closable="false"
        show-icon
      >
        <ul>
          <li>æ‚¨éœ€è¦å‡†å¤‡<strong>KOOKè´¦å·çš„Cookie</strong>æˆ–è´¦å·å¯†ç </li>
          <li>è‡³å°‘é…ç½®<strong>ä¸€ä¸ªè½¬å‘ç›®æ ‡</strong>ï¼ˆDiscord/Telegram/é£ä¹¦ï¼‰</li>
          <li>ç¡®ä¿æ‚¨æœ‰æƒè½¬å‘ç›¸å…³é¢‘é“çš„æ¶ˆæ¯å†…å®¹</li>
          <li>é…ç½®å®Œæˆåå¯ä»¥éšæ—¶åœ¨è®¾ç½®ä¸­ä¿®æ”¹</li>
        </ul>
      </el-alert>
    </div>

    <!-- æ“ä½œæŒ‰é’® -->
    <div class="action-buttons">
      <el-button
        type="primary"
        size="large"
        :disabled="!agreed || !hasScrolledToBottom"
        @click="handleNext"
      >
        <el-icon><CircleCheck /></el-icon>
        åŒæ„å¹¶ç»§ç»­é…ç½®
      </el-button>
      
      <el-button 
        type="danger"
        size="large" 
        @click="handleReject"
      >
        <el-icon><CircleClose /></el-icon>
        æ‹’ç»å¹¶é€€å‡ºåº”ç”¨
      </el-button>
    </div>

    <!-- é˜…è¯»è¿›åº¦æç¤º -->
    <div class="progress-hint" v-show="!hasScrolledToBottom">
      <el-progress 
        :percentage="scrollProgress" 
        :color="scrollProgress === 100 ? '#67C23A' : '#E6A23C'"
      >
        <template #default="{ percentage }">
          <span class="percentage-value">{{ percentage }}%</span>
        </template>
      </el-progress>
      <p class="progress-text">
        å·²é˜…è¯» {{ scrollProgress }}%ï¼Œè¯·ç»§ç»­å‘ä¸‹æ»šåŠ¨
      </p>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { ElMessageBox, ElMessage } from 'element-plus'
import { 
  WarningFilled, 
  CircleCheck, 
  CircleClose, 
  ArrowDown 
} from '@element-plus/icons-vue'

const agreed = ref(false)
const hasScrolledToBottom = ref(false)
const disclaimerScrollRef = ref(null)
const scrollProgress = ref(0)

const emit = defineEmits(['next', 'reject'])

// âœ… P0-1å®Œæˆï¼šç›‘å¬æ»šåŠ¨äº‹ä»¶
const handleScroll = (event) => {
  const element = event.target
  const scrollTop = element.scrollTop
  const scrollHeight = element.scrollHeight
  const clientHeight = element.clientHeight
  
  // è®¡ç®—æ»šåŠ¨è¿›åº¦
  const progress = Math.round((scrollTop / (scrollHeight - clientHeight)) * 100)
  scrollProgress.value = Math.min(progress, 100)
  
  // åˆ¤æ–­æ˜¯å¦æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆå…è®¸5pxè¯¯å·®ï¼‰
  if (scrollHeight - scrollTop - clientHeight < 5) {
    hasScrolledToBottom.value = true
  }
}

const handleNext = () => {
  if (!hasScrolledToBottom.value) {
    ElMessage.warning('è¯·å…ˆæ»šåŠ¨åˆ°å…è´£å£°æ˜åº•éƒ¨ï¼Œå®Œæ•´é˜…è¯»æ‰€æœ‰å†…å®¹')
    return
  }
  
  if (!agreed.value) {
    ElMessage.warning('è¯·å‹¾é€‰åŒæ„åè®®åç»§ç»­')
    return
  }
  
  // äºŒæ¬¡ç¡®è®¤
  ElMessageBox.confirm(
    'è¯·å†æ¬¡ç¡®è®¤ï¼šæ‚¨å·²å®Œæ•´é˜…è¯»å¹¶ç†è§£å…è´£å£°æ˜çš„æ‰€æœ‰å†…å®¹ï¼Œè‡ªæ„¿æ‰¿æ‹…ä½¿ç”¨æœ¬è½¯ä»¶çš„æ‰€æœ‰é£é™©ï¼Ÿ',
    'æœ€ç»ˆç¡®è®¤',
    {
      confirmButtonText: 'ç¡®è®¤åŒæ„',
      cancelButtonText: 'æˆ‘å†çœ‹çœ‹',
      type: 'warning',
      distinguishCancelAndClose: true
    }
  ).then(() => {
    // è®°å½•ç”¨æˆ·åŒæ„æ—¶é—´
    const agreementTime = new Date().toISOString()
    localStorage.setItem('disclaimer_agreed', 'true')
    localStorage.setItem('disclaimer_agreed_time', agreementTime)
    localStorage.setItem('disclaimer_version', '6.3.0')
    
    ElMessage.success('âœ… å·²ç¡®è®¤ï¼Œå¼€å§‹é…ç½®å‘å¯¼')
    emit('next')
  }).catch((action) => {
    if (action === 'cancel') {
      ElMessage.info('è¯·ä»”ç»†é˜…è¯»å…è´£å£°æ˜')
    }
  })
}

// âœ… P0-1å®Œæˆï¼šæ‹’ç»æ—¶çœŸæ­£é€€å‡ºåº”ç”¨
const handleReject = () => {
  ElMessageBox.confirm(
    'æ‚¨æ‹’ç»äº†å…è´£å£°æ˜ï¼Œåº”ç”¨å°†ç«‹å³å…³é—­ã€‚\n\nå¦‚éœ€ä½¿ç”¨æœ¬è½¯ä»¶ï¼Œè¯·é‡æ–°å¯åŠ¨å¹¶åŒæ„å…è´£å£°æ˜ã€‚',
    'é€€å‡ºåº”ç”¨',
    {
      confirmButtonText: 'ç¡®å®šé€€å‡º',
      cancelButtonText: 'æˆ‘å†æƒ³æƒ³',
      type: 'error',
      distinguishCancelAndClose: true
    }
  ).then(() => {
    // è®°å½•æ‹’ç»
    localStorage.setItem('disclaimer_rejected', 'true')
    localStorage.setItem('disclaimer_rejected_time', new Date().toISOString())
    
    // å°è¯•å…³é—­Electronçª—å£
    if (window.electron && window.electron.quit) {
      window.electron.quit()
    } else if (window.electron && window.electron.closeWindow) {
      window.electron.closeWindow()
    } else {
      // å¦‚æœä¸æ˜¯Electronç¯å¢ƒï¼Œå…³é—­çª—å£
      window.close()
      
      // å¦‚æœæ— æ³•å…³é—­ï¼Œæ˜¾ç¤ºæç¤º
      setTimeout(() => {
        ElMessage.error('æ— æ³•è‡ªåŠ¨å…³é—­çª—å£ï¼Œè¯·æ‰‹åŠ¨å…³é—­æµè§ˆå™¨æ ‡ç­¾é¡µ')
      }, 100)
    }
  }).catch(() => {
    // ç”¨æˆ·å–æ¶ˆ
  })
}
</script>

<style scoped>
/* âœ… P0-1å®Œæˆï¼šå…¨æ–°æ ·å¼ç³»ç»Ÿ */

.step-welcome {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
}

.welcome-header {
  text-align: center;
  margin-bottom: 30px;
  padding: 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.welcome-title {
  font-size: 32px;
  margin: 0 0 10px 0;
  font-weight: bold;
}

.welcome-subtitle {
  font-size: 16px;
  margin: 0 0 10px 0;
  opacity: 0.9;
}

.welcome-description {
  font-size: 14px;
  margin: 0;
  opacity: 0.8;
}

.disclaimer-wrapper {
  background: white;
  border-radius: 12px;
  padding: 30px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
  margin-bottom: 30px;
}

.disclaimer-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin-bottom: 25px;
  padding-bottom: 20px;
  border-bottom: 2px solid #E6A23C;
}

.disclaimer-header h2 {
  margin: 0;
  font-size: 24px;
  color: #E6A23C;
}

.disclaimer-scroll-area {
  max-height: 500px;
  overflow-y: auto;
  border: 2px solid #DCDFE6;
  border-radius: 8px;
  padding: 25px;
  background: #FAFAFA;
  position: relative;
  scroll-behavior: smooth;
}

/* å¼ºåˆ¶é˜…è¯»æ ·å¼ */
.disclaimer-scroll-area.force-read {
  border-color: #E6A23C;
  background: linear-gradient(to bottom, 
    rgba(230, 162, 60, 0.05) 0%, 
    transparent 100%);
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.disclaimer-scroll-area::-webkit-scrollbar {
  width: 10px;
}

.disclaimer-scroll-area::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 5px;
}

.disclaimer-scroll-area::-webkit-scrollbar-thumb {
  background: #E6A23C;
  border-radius: 5px;
}

.disclaimer-scroll-area::-webkit-scrollbar-thumb:hover {
  background: #D89E36;
}

.disclaimer-content {
  text-align: left;
  line-height: 1.8;
  color: #303133;
}

.disclaimer-intro {
  font-size: 15px;
  padding: 15px;
  background: #FFF7E6;
  border-left: 4px solid #E6A23C;
  margin-bottom: 25px;
  border-radius: 4px;
}

.disclaimer-section {
  margin-bottom: 30px;
  padding: 20px;
  background: white;
  border-radius: 8px;
  border: 1px solid #EBEEF5;
}

.disclaimer-section h3 {
  color: #409EFF;
  font-size: 18px;
  margin: 0 0 15px 0;
  padding-bottom: 10px;
  border-bottom: 2px solid #409EFF;
}

.disclaimer-warning h3 {
  color: #F56C6C;
  border-bottom-color: #F56C6C;
}

.disclaimer-section ol {
  margin: 0;
  padding-left: 25px;
}

.disclaimer-section li {
  margin: 12px 0;
  line-height: 1.8;
}

.disclaimer-section ul {
  margin: 8px 0;
  padding-left: 25px;
  list-style-type: disc;
}

.disclaimer-section ul li {
  margin: 6px 0;
}

.risk-high {
  color: #F56C6C;
  background: #FEF0F0;
  padding: 2px 8px;
  border-radius: 4px;
}

.risk-medium {
  color: #E6A23C;
  background: #FDF6EC;
  padding: 2px 8px;
  border-radius: 4px;
}

.risk-low {
  color: #909399;
  background: #F4F4F5;
  padding: 2px 8px;
  border-radius: 4px;
}

.disclaimer-final {
  background: #FFF7E6;
  border: 2px solid #E6A23C;
}

.disclaimer-emphasis {
  font-size: 15px;
  color: #F56C6C;
  font-weight: bold;
  padding: 15px;
  background: #FEF0F0;
  border-radius: 4px;
  margin-top: 15px;
  text-align: center;
}

.scroll-hint {
  position: sticky;
  bottom: 0;
  left: 0;
  right: 0;
  text-align: center;
  padding: 15px;
  background: linear-gradient(to bottom, transparent, rgba(250, 250, 250, 0.95));
  animation: bounce 2s infinite;
}

.scroll-icon {
  color: #E6A23C;
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}

.scroll-hint p {
  margin: 5px 0 0 0;
  color: #E6A23C;
  font-weight: bold;
}

.agreement-section {
  margin: 25px 0;
  padding: 20px;
  background: #F0F9FF;
  border-radius: 8px;
  border: 2px solid #409EFF;
}

.agreement-checkbox {
  display: block;
  margin: 20px 0;
  padding: 15px;
  background: white;
  border-radius: 8px;
  border: 2px solid #67C23A;
}

.agreement-checkbox :deep(.el-checkbox__label) {
  line-height: 1.8;
  white-space: normal;
  word-break: break-word;
}

.welcome-tips {
  margin: 30px 0;
}

.welcome-tips ul {
  margin: 10px 0;
  padding-left: 25px;
}

.welcome-tips li {
  margin: 8px 0;
  line-height: 1.6;
}

.action-buttons {
  margin-top: 30px;
  text-align: center;
  display: flex;
  justify-content: center;
  gap: 20px;
}

.action-buttons .el-button {
  min-width: 200px;
  height: 50px;
  font-size: 16px;
}

.progress-hint {
  margin-top: 20px;
  padding: 15px;
  background: #F4F4F5;
  border-radius: 8px;
  text-align: center;
}

.progress-text {
  margin: 10px 0 0 0;
  color: #606266;
  font-size: 14px;
}

.percentage-value {
  font-weight: bold;
  font-size: 14px;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .step-welcome {
    padding: 10px;
  }
  
  .welcome-title {
    font-size: 24px;
  }
  
  .disclaimer-scroll-area {
    max-height: 400px;
  }
  
  .action-buttons {
    flex-direction: column;
  }
  
  .action-buttons .el-button {
    width: 100%;
  }
}
</style>
