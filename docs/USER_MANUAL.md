# KOOK消息转发系统 - 用户手册

**版本**: v2.0  
**更新时间**: 2025-10-30

---

## 📖 目录

1. [系统介绍](#系统介绍)
2. [快速开始](#快速开始)
3. [功能详解](#功能详解)
4. [常见问题](#常见问题)
5. [故障排查](#故障排查)
6. [高级功能](#高级功能)

---

## 系统介绍

KOOK消息转发系统是一款自动化消息转发工具，支持将KOOK平台的消息实时转发到Discord、Telegram、飞书等多个平台。

### 核心特性

- ✅ **多账号支持** - 同时监听多个KOOK账号
- ✅ **多平台转发** - 支持Discord、Telegram、飞书
- ✅ **智能映射** - 可视化频道映射配置
- ✅ **消息过滤** - 灵活的过滤规则系统
- ✅ **实时监控** - 实时日志和性能监控
- ✅ **自动重试** - 失败消息自动重试
- ✅ **插件系统** - 支持功能扩展

---

## 快速开始

### 安装系统

#### Windows
1. 下载 `KOOK-Forwarder-v2.0-Windows-x64.exe`
2. 双击运行安装程序
3. 按提示完成安装
4. 启动应用

#### macOS
1. 下载 `KOOK-Forwarder-v2.0-macOS.dmg`
2. 打开DMG文件
3. 拖动应用到"应用程序"文件夹
4. 首次打开需要右键 → 打开

#### Linux
1. 下载 `KOOK-Forwarder-v2.0-Linux.AppImage`
2. 赋予执行权限: `chmod +x KOOK-Forwarder-v2.0-Linux.AppImage`
3. 运行: `./KOOK-Forwarder-v2.0-Linux.AppImage`

### 首次配置（3步向导）

#### 第1步：添加KOOK账号

**方式一：Cookie导入（推荐）**
1. 点击"Cookie导入"
2. 安装Chrome扩展（可选）
3. 或手动粘贴Cookie
4. 点击"验证并添加"

**方式二：密码登录**
1. 输入KOOK邮箱
2. 输入密码
3. 如遇验证码，按提示输入
4. 点击"登录"

#### 第2步：配置Bot

**Discord Webhook:**
1. 在Discord频道设置中创建Webhook
2. 复制Webhook URL
3. 粘贴到系统中
4. 点击"测试连接"

**Telegram Bot:**
1. 与 @BotFather 对话创建Bot
2. 获取Bot Token
3. 将Bot添加到目标群组
4. 使用"自动获取Chat ID"功能
5. 或手动输入Chat ID

**飞书自建应用:**
1. 在飞书开放平台创建应用
2. 获取App ID和App Secret
3. 将机器人添加到群组
4. 填入系统配置

#### 第3步：映射频道

**智能映射（推荐）:**
1. 点击"智能映射"
2. 系统自动匹配同名频道
3. 确认映射关系
4. 点击"保存"

**手动映射:**
1. 选择KOOK频道
2. 选择目标平台和Bot
3. 选择目标频道
4. 点击"添加映射"

---

## 功能详解

### 账号管理

#### 添加账号
- 支持Cookie导入和密码登录
- 可添加多个账号
- 实时显示在线状态

#### 账号操作
- **重新连接** - 手动触发重连
- **查看服务器** - 查看监听的服务器和频道
- **编辑** - 修改账号信息
- **删除** - 移除账号

#### 连接状态
- 🟢 在线 - 正常工作
- 🟡 重连中 - 正在尝试重连
- 🔴 离线 - 连接失败

### Bot配置

#### 支持的平台
- **Discord** - 使用Webhook方式
- **Telegram** - 使用Bot API
- **飞书** - 使用自建应用

#### 配置教程
系统内置分步教程：
1. 图文说明
2. 视频教程链接
3. 常见问题解答

### 频道映射

#### 映射类型
- **一对一** - 一个KOOK频道对应一个目标
- **一对多** - 一个KOOK频道对应多个目标

#### 可视化编辑器
- 拖拽式操作
- 实时预览
- 自动布局
- 导入导出配置

### 过滤规则

#### 规则类型
1. **关键词过滤**
   - 黑名单：包含关键词不转发
   - 白名单：仅转发包含关键词的消息

2. **用户过滤**
   - 黑名单用户：不转发指定用户消息
   - 白名单用户：仅转发指定用户消息

3. **消息类型过滤**
   - 文本消息
   - 图片消息
   - 视频消息
   - 文件附件
   - 表情反应

4. **正则表达式**
   - 支持复杂匹配规则
   - 内置测试工具

### 实时监控

#### 日志查看
- 实时消息转发日志
- 成功/失败状态
- 错误信息详情
- 延迟统计

#### 性能监控
- CPU和内存使用率
- 平均响应时间
- 消息吞吐量
- 队列长度

#### 统计分析
- 总消息数
- 成功率
- 平台分布
- 时间趋势

---

## 常见问题

### 1. KOOK账号显示离线？

**可能原因:**
- Cookie已过期
- IP被限制
- 账号被封禁

**解决方法:**
1. 重新登录或导入Cookie
2. 更换网络或使用代理
3. 联系KOOK客服

### 2. 消息转发延迟大？

**可能原因:**
- 消息队列积压
- 目标平台限流
- 网络不稳定

**解决方法:**
1. 查看队列状态
2. 降低频道映射数量
3. 检查网络连接

### 3. 图片转发失败？

**可能原因:**
- 图片被防盗链
- 图片过大
- 目标平台限制

**解决方法:**
1. 系统会自动处理，重试即可
2. 图片会自动压缩
3. 使用图床模式

### 4. 验证码如何处理？

**自动识别:**
- 配置2Captcha API（可选）
- 自动后台识别

**手动输入:**
- 弹窗提示输入
- 60秒倒计时
- 支持图片放大查看

---

## 故障排查

### 日志查看

**位置:**
- Windows: `C:\Users\<用户名>\Documents\KookForwarder\logs`
- macOS: `~/Documents/KookForwarder/logs`
- Linux: `~/Documents/KookForwarder/logs`

**日志级别:**
- DEBUG: 调试信息
- INFO: 普通信息
- WARNING: 警告信息
- ERROR: 错误信息

### 重置配置

1. 进入"系统设置"
2. 点击"备份与恢复"
3. 创建备份
4. 点击"重置为默认"

### 完全卸载

**Windows:**
1. 控制面板 → 程序 → 卸载
2. 删除数据目录（可选）

**macOS:**
1. 删除应用程序
2. 删除 `~/Documents/KookForwarder`（可选）

**Linux:**
1. 删除AppImage文件
2. 删除 `~/Documents/KookForwarder`（可选）

---

## 高级功能

### 插件系统

#### 安装插件
1. 下载插件文件（.zip）
2. 进入"插件管理"
3. 点击"安装插件"
4. 选择插件文件
5. 重启应用

#### 内置插件
- **消息翻译** - 自动翻译消息
- **敏感词过滤** - 过滤敏感内容
- **自定义模板** - 自定义消息格式

### 消息模板

#### 预设模板
- 默认模板: `{content}`
- 带作者: `**{author}**: {content}`
- 完整模板: `[{time}] **{author}** 在 #{channel}:\n{content}`

#### 自定义模板
```
{variable} - 变量
{{if variable}}...{{endif}} - 条件
{{for item in list}}...{{endfor}} - 循环
```

### 定时任务

#### 创建任务
1. 进入"系统设置" → "定时任务"
2. 点击"添加任务"
3. 输入Cron表达式
4. 选择任务类型
5. 保存

#### Cron示例
- `0 0 * * *` - 每天0点
- `0 */5 * * *` - 每5分钟
- `0 0 12 * * 0` - 每周日12点

### Webhook回调

#### 配置Webhook
1. 进入"系统设置" → "Webhook"
2. 选择事件类型
3. 输入回调URL
4. 保存配置

#### 支持的事件
- 消息接收
- 消息转发
- 消息失败
- 账号上线
- 账号下线
- 系统告警

---

## 技术支持

### 联系方式
- 官网: https://kook-forwarder.com
- 邮箱: support@kook-forwarder.com
- GitHub: https://github.com/kook-forwarder/kook-forwarder
- Discord: https://discord.gg/kook-forwarder

### 文档
- API文档
- 开发指南
- 插件开发文档
- 更新日志

---

**祝使用愉快！** 🎉
