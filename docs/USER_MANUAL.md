# KOOK消息转发系统 - 用户手册

**版本**: v18.0.0  
**更新时间**: 2025-10-30

> 🎉 **v18.0.0 文档优化版** - Electron桌面应用 · 文档简化 · 专业表达 · 客观描述

---

## 📖 目录

1. [系统介绍](#系统介绍)
2. [版本更新](#版本更新)
3. [快速开始](#快速开始)
4. [功能详解](#功能详解)
5. [常见问题](#常见问题)
6. [故障排查](#故障排查)
7. [高级功能](#高级功能)

---

## 系统介绍

KOOK消息转发系统是一款自动化消息转发工具，支持将KOOK平台的消息实时转发到Discord、Telegram、飞书等多个平台。

### 核心特性

- ✅ **多账号支持** - 同时监听多个KOOK账号
- ✅ **多平台转发** - 支持Discord、Telegram、飞书
- ✅ **智能映射** - 可视化频道映射配置
- ✅ **消息过滤** - 灵活的过滤规则系统
- ✅ **实时监控** - 实时日志和性能监控
- ✅ **自动重试** - 失败消息自动重试
- ✅ **插件系统** - 支持功能扩展

### 🆕 最新特性

- 🖥️ **Electron桌面应用** - 真正的原生桌面体验
- 📊 **双视图映射管理** - 表格+流程图自由切换
- 📜 **智能历史消息同步** - 启动时自动同步
- 🎬 **视频教程中心** - 10个精选教程
- 📋 **4步配置向导** - 更简化的配置流程
- 🚀 **一键自动化构建** - 跨平台打包

---

## 版本更新

### v18.0.0 文档优化（2025-10-30）

- 📚 删除所有临时文档（7个，67.8K）
- ✅ 简化文档结构，提升专业性

### v18.0.0 Electron桌面应用（2025-10-30）

现在是真正的桌面应用，不再是Web应用！

#### 系统托盘功能
- **最小化到托盘** - 点击关闭按钮最小化到托盘，不退出程序
- **实时统计显示** - 托盘图标上显示在线账号数和队列消息数
- **智能通知** - 失败率异常时自动提醒
- **快捷菜单** - 右键托盘图标快速操作
  - 显示/隐藏窗口
  - 暂停/继续服务
  - 退出应用

#### 嵌入式服务
- Redis服务完全内置，无需外部安装
- Python后端自动启动和管理
- 跨平台支持（Windows/macOS/Linux）

### 📊 双视图映射管理

提供两种映射管理方式，满足不同使用习惯：

#### 表格视图（适合批量管理）
- **批量操作** - 一次选中多个映射进行启用/禁用/删除
- **高级筛选** - 按服务器、平台、状态筛选
- **关键词搜索** - 快速查找映射
- **分页和排序** - 方便管理大量映射

#### 流程图视图（适合可视化）
- **拖拽布局** - 自由调整节点位置
- **可视化展示** - 直观查看数据流向
- **自动布局** - 一键优化布局
- **缩放控制** - 放大/缩小/适应窗口

#### 使用方法
1. 进入"频道映射"页面
2. 点击顶部的视图切换器（📊 表格视图 / 🎨 流程图视图）
3. 系统会记住您的选择偏好

### 📜 智能历史消息同步

避免重启后消息遗漏！

#### 功能说明
- 启动时自动同步最近N分钟的历史消息
- 自动去重，不会重复转发
- 可配置时间范围和消息数量

#### 配置方法
1. 进入"系统设置"页面
2. 找到"💬 历史消息同步"部分
3. 启用"启动时同步历史消息"开关
4. 设置同步时间范围（5-120分钟）
5. 设置最多同步消息数（10-500条）
6. 点击"保存设置"

### 🎬 视频教程中心

10个精选视频教程，从入门到高级！

#### 教程列表
1. **快速入门指南** - 5分钟上手
2. **Cookie获取详细教程** - 3种方法
3. **Discord Webhook配置** - 2分钟搞定
4. **Telegram Bot配置教程** - 完整演示
5. **飞书自建应用配置** - 详细步骤
6. **智能映射功能详解** - 自动匹配频道
7. **过滤规则使用技巧** - 精准转发
8. **常见问题排查指南** - 自助解决
9. **Chrome扩展使用教程** - 3秒导出Cookie
10. **高级功能完整演示** - 解锁所有特性

#### 使用方法
1. 点击菜单栏"帮助" → "视频教程"
2. 选择您需要的教程
3. 点击播放，支持章节跳转和速度调节
4. 系统会自动记录您的观看进度

### 📋 4步配置向导

全新的4步向导，更符合使用流程：

#### 步骤1：免责声明
- 首次使用必须阅读并同意
- 版本更新时会重新显示
- 记录同意时间和审计日志

#### 步骤2：KOOK账号登录
- 使用Chrome扩展一键导出Cookie
- 或手动输入Cookie
- 或使用密码登录

#### 步骤3：配置目标Bot
- 选择平台（Discord/Telegram/飞书）
- 填写Bot配置
- 测试连接

#### 步骤4：频道映射
- 使用智能映射自动匹配
- 或手动创建映射
- 完成后开始转发

---

## 快速开始

### 安装系统

#### Windows
1. 下载 `KOOK-Forwarder-v2.0-Windows-x64.exe`
2. 双击运行安装程序
3. 按提示完成安装
4. 启动应用

#### macOS
1. 下载 `KOOK-Forwarder-v2.0-macOS.dmg`
2. 打开DMG文件
3. 拖动应用到"应用程序"文件夹
4. 首次打开需要右键 → 打开

#### Linux
1. 下载 `KOOK-Forwarder-v2.0-Linux.AppImage`
2. 赋予执行权限: `chmod +x KOOK-Forwarder-v2.0-Linux.AppImage`
3. 运行: `./KOOK-Forwarder-v2.0-Linux.AppImage`

### 首次配置（4步向导）

#### 第1步：免责声明

首次启动时会自动显示免责声明：
1. 仔细阅读免责声明内容
2. 勾选"我已阅读并同意"
3. 点击"接受并继续"

> 注意：版本更新时会重新显示免责声明，需要重新同意。

#### 第2步：添加KOOK账号

**方式一：Cookie导入（推荐）**
1. 点击"Cookie导入"
2. 安装Chrome扩展（可选）
3. 或手动粘贴Cookie
4. 点击"验证并添加"

**方式二：密码登录**
1. 输入KOOK邮箱
2. 输入密码
3. 如遇验证码，按提示输入
4. 点击"登录"

#### 第3步：配置Bot

**Discord Webhook:**
1. 在Discord频道设置中创建Webhook
2. 复制Webhook URL
3. 粘贴到系统中
4. 点击"测试连接"

**Telegram Bot:**
1. 与 @BotFather 对话创建Bot
2. 获取Bot Token
3. 将Bot添加到目标群组
4. 使用"自动获取Chat ID"功能
5. 或手动输入Chat ID

**飞书自建应用:**
1. 在飞书开放平台创建应用
2. 获取App ID和App Secret
3. 将机器人添加到群组
4. 填入系统配置

#### 第4步：映射频道

**智能映射（推荐）:**
1. 点击"智能映射"
2. 系统自动匹配同名频道
3. 确认映射关系
4. 点击"保存"

**手动映射:**
1. 选择KOOK频道
2. 选择目标平台和Bot
3. 选择目标频道
4. 点击"添加映射"

---

## 功能详解

### 账号管理

#### 添加账号
- 支持Cookie导入和密码登录
- 可添加多个账号
- 实时显示在线状态

#### 账号操作
- **重新连接** - 手动触发重连
- **查看服务器** - 查看监听的服务器和频道
- **编辑** - 修改账号信息
- **删除** - 移除账号

#### 连接状态
- 🟢 在线 - 正常工作
- 🟡 重连中 - 正在尝试重连
- 🔴 离线 - 连接失败

### Bot配置

#### 支持的平台
- **Discord** - 使用Webhook方式
- **Telegram** - 使用Bot API
- **飞书** - 使用自建应用

#### 配置教程
系统内置分步教程：
1. 图文说明
2. 视频教程链接
3. 常见问题解答

### 频道映射

#### 映射类型
- **一对一** - 一个KOOK频道对应一个目标
- **一对多** - 一个KOOK频道对应多个目标

#### 可视化编辑器
- 拖拽式操作
- 实时预览
- 自动布局
- 导入导出配置

### 过滤规则

#### 规则类型
1. **关键词过滤**
   - 黑名单：包含关键词不转发
   - 白名单：仅转发包含关键词的消息

2. **用户过滤**
   - 黑名单用户：不转发指定用户消息
   - 白名单用户：仅转发指定用户消息

3. **消息类型过滤**
   - 文本消息
   - 图片消息
   - 视频消息
   - 文件附件
   - 表情反应

4. **正则表达式**
   - 支持复杂匹配规则
   - 内置测试工具

### 实时监控

#### 日志查看
- 实时消息转发日志
- 成功/失败状态
- 错误信息详情
- 延迟统计

#### 性能监控
- CPU和内存使用率
- 平均响应时间
- 消息吞吐量
- 队列长度

#### 统计分析
- 总消息数
- 成功率
- 平台分布
- 时间趋势

---

## 常见问题

### 1. KOOK账号显示离线？

**可能原因:**
- Cookie已过期
- IP被限制
- 账号被封禁

**解决方法:**
1. 重新登录或导入Cookie
2. 更换网络或使用代理
3. 联系KOOK客服

### 2. 消息转发延迟大？

**可能原因:**
- 消息队列积压
- 目标平台限流
- 网络不稳定

**解决方法:**
1. 查看队列状态
2. 降低频道映射数量
3. 检查网络连接

### 3. 图片转发失败？

**可能原因:**
- 图片被防盗链
- 图片过大
- 目标平台限制

**解决方法:**
1. 系统会自动处理，重试即可
2. 图片会自动压缩
3. 使用图床模式

### 4. 验证码如何处理？

**自动识别:**
- 配置2Captcha API（可选）
- 自动后台识别

**手动输入:**
- 弹窗提示输入
- 60秒倒计时
- 支持图片放大查看

---

## 故障排查

### 日志查看

**位置:**
- Windows: `C:\Users\<用户名>\Documents\KookForwarder\logs`
- macOS: `~/Documents/KookForwarder/logs`
- Linux: `~/Documents/KookForwarder/logs`

**日志级别:**
- DEBUG: 调试信息
- INFO: 普通信息
- WARNING: 警告信息
- ERROR: 错误信息

### 重置配置

1. 进入"系统设置"
2. 点击"备份与恢复"
3. 创建备份
4. 点击"重置为默认"

### 完全卸载

**Windows:**
1. 控制面板 → 程序 → 卸载
2. 删除数据目录（可选）

**macOS:**
1. 删除应用程序
2. 删除 `~/Documents/KookForwarder`（可选）

**Linux:**
1. 删除AppImage文件
2. 删除 `~/Documents/KookForwarder`（可选）

---

## 高级功能

### 插件系统

#### 安装插件
1. 下载插件文件（.zip）
2. 进入"插件管理"
3. 点击"安装插件"
4. 选择插件文件
5. 重启应用

#### 内置插件
- **消息翻译** - 自动翻译消息
- **敏感词过滤** - 过滤敏感内容
- **自定义模板** - 自定义消息格式

### 消息模板

#### 预设模板
- 默认模板: `{content}`
- 带作者: `**{author}**: {content}`
- 完整模板: `[{time}] **{author}** 在 #{channel}:\n{content}`

#### 自定义模板
```
{variable} - 变量
{{if variable}}...{{endif}} - 条件
{{for item in list}}...{{endfor}} - 循环
```

### 定时任务

#### 创建任务
1. 进入"系统设置" → "定时任务"
2. 点击"添加任务"
3. 输入Cron表达式
4. 选择任务类型
5. 保存

#### Cron示例
- `0 0 * * *` - 每天0点
- `0 */5 * * *` - 每5分钟
- `0 0 12 * * 0` - 每周日12点

### Webhook回调

#### 配置Webhook
1. 进入"系统设置" → "Webhook"
2. 选择事件类型
3. 输入回调URL
4. 保存配置

#### 支持的事件
- 消息接收
- 消息转发
- 消息失败
- 账号上线
- 账号下线
- 系统告警

---

## 技术支持

### 联系方式
- 官网: https://kook-forwarder.com
- 邮箱: support@kook-forwarder.com
- GitHub: https://github.com/kook-forwarder/kook-forwarder
- Discord: https://discord.gg/kook-forwarder

### 文档
- API文档
- 开发指南
- 插件开发文档
- 更新日志

---

**祝使用愉快！** 🎉
