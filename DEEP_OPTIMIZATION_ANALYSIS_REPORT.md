# KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ - æ·±åº¦ä»£ç åˆ†æä¸ä¼˜åŒ–å»ºè®®æŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2025-10-25  
**å½“å‰ç‰ˆæœ¬**: v4.0.0 Ultimate Edition  
**å¯¹æ¯”åŸºå‡†**: å®Œæ•´éœ€æ±‚æ–‡æ¡£ï¼ˆæ˜“ç”¨ç‰ˆï¼‰  
**åˆ†æèŒƒå›´**: å…¨é¢ä»£ç å®¡æŸ¥ vs éœ€æ±‚æ–‡æ¡£

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šå¯¹KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿçš„ç°æœ‰ä»£ç è¿›è¡Œäº†æ·±åº¦åˆ†æï¼Œå¹¶ä¸æä¾›çš„å®Œæ•´éœ€æ±‚æ–‡æ¡£è¿›è¡Œäº†é€é¡¹å¯¹æ¯”ã€‚è™½ç„¶é¡¹ç›®å·²å®Œæˆv4.0.0çš„27é¡¹ä¼˜åŒ–ï¼Œä½†ä»å­˜åœ¨**35ä¸ªéœ€è¦æ·±åº¦ä¼˜åŒ–çš„å…³é”®é—®é¢˜**ã€‚

### ä¼˜å…ˆçº§åˆ†ç±»

| ä¼˜å…ˆçº§ | æ•°é‡ | è¯´æ˜ |
|--------|------|------|
| ğŸ”´ **P0ï¼ˆé˜»å¡æ€§ï¼‰** | 12é¡¹ | ä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒï¼Œå¿…é¡»ç«‹å³ä¿®å¤ |
| ğŸŸ  **P1ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰** | 15é¡¹ | å½±å“æ ¸å¿ƒåŠŸèƒ½å®Œæ•´æ€§ï¼Œä¼˜å…ˆä¿®å¤ |
| ğŸŸ¡ **P2ï¼ˆä½“éªŒä¼˜åŒ–ï¼‰** | 8é¡¹ | æå‡ç”¨æˆ·ä½“éªŒï¼Œå»ºè®®ä¿®å¤ |

### æ•´ä½“è¯„ä¼°

| ç»´åº¦ | ç°çŠ¶ | éœ€æ±‚æ–‡æ¡£è¦æ±‚ | å·®è· |
|------|------|-------------|------|
| é…ç½®å‘å¯¼å®Œæ•´æ€§ | 3æ­¥ | 5æ­¥ï¼ˆå«Boté…ç½®å’Œæ˜ å°„ï¼‰ | âš ï¸ ç¼ºå°‘2ä¸ªå…³é”®æ­¥éª¤ |
| æ¶ˆæ¯ç±»å‹æ”¯æŒ | éƒ¨åˆ† | å…¨é¢ï¼ˆæ–‡æœ¬/å›¾ç‰‡/æ–‡ä»¶/è¡¨æƒ…/å¼•ç”¨ï¼‰ | âš ï¸ æ–‡ä»¶é™„ä»¶ã€è¡¨æƒ…è½¬å‘ä¸å®Œæ•´ |
| å›¾ç‰‡å¤„ç†ç­–ç•¥ | åŸºç¡€ | 3ç§æ¨¡å¼ï¼ˆæ™ºèƒ½/ç›´ä¼ /å›¾åºŠï¼‰ | âš ï¸ ç­–ç•¥åˆ‡æ¢æœºåˆ¶ä¸å®Œå–„ |
| é”™è¯¯å¤„ç†å‹å¥½åº¦ | ä¸­ç­‰ | 8é¡¹æ£€æŸ¥+ä¸€é”®ä¿®å¤ | âš ï¸ ç¼ºå°‘å¯æ‰§è¡Œçš„ä¿®å¤åŠ¨ä½œ |
| å®‰å…¨æœºåˆ¶ | åŸºç¡€ | å®Œæ•´ï¼ˆAES-256/ä¸»å¯†ç /å®¡è®¡æ—¥å¿—ï¼‰ | âš ï¸ ä¸»å¯†ç ä¿æŠ¤æœªå®ç° |
| å¸®åŠ©ç³»ç»Ÿ | ç®€å• | å®Œæ•´ï¼ˆå›¾æ–‡/è§†é¢‘/FAQ/å†…ç½®æ•™ç¨‹ï¼‰ | âŒ å¤§éƒ¨åˆ†æœªå®ç° |

---

## ğŸ”´ P0çº§ï¼šé˜»å¡æ€§é—®é¢˜ï¼ˆ12é¡¹ï¼‰


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- 5æ­¥å‘å¯¼ï¼šæ¬¢è¿â†’ç¯å¢ƒæ£€æŸ¥â†’Cookieå¯¼å…¥â†’**Boté…ç½®**â†’**å¿«é€Ÿæ˜ å°„**â†’å®Œæˆ

**ç°çŠ¶**:
```vue
// frontend/src/views/Wizard.vue
<el-steps :active="currentStep">
  <el-step title="æ¬¢è¿" />
  <el-step title="ç™»å½•KOOK" />
  <el-step title="é€‰æ‹©æœåŠ¡å™¨" />  <!-- âŒ ç¼ºå°‘Boté…ç½®å’Œæ˜ å°„æ­¥éª¤ -->
</el-steps>
```

**é—®é¢˜**ï¼š
- âŒ ç¼ºå°‘"Boté…ç½®"æ­¥éª¤ï¼ˆç”¨æˆ·æ— æ³•åœ¨å‘å¯¼ä¸­é…ç½®Discord/Telegram/é£ä¹¦Botï¼‰
- âŒ ç¼ºå°‘"å¿«é€Ÿæ˜ å°„"æ­¥éª¤ï¼ˆç”¨æˆ·æ— æ³•åœ¨å‘å¯¼ä¸­å¿«é€Ÿåˆ›å»ºé¢‘é“æ˜ å°„ï¼‰
- âŒ ç”¨æˆ·å®Œæˆå‘å¯¼åä»éœ€æ‰‹åŠ¨é…ç½®Botå’Œæ˜ å°„ï¼Œè¿èƒŒ"é›¶æŠ€æœ¯åŸºç¡€"åŸåˆ™

**å½±å“**ï¼š
- ç”¨æˆ·å®Œæˆå‘å¯¼åæ— æ³•ç«‹å³ä½¿ç”¨ï¼Œéœ€è¦å†æ¬¡è¿›å…¥å¤šä¸ªé¡µé¢é…ç½®
- æ–°æ‰‹ç”¨æˆ·å›°æƒ‘åº¦é«˜ï¼Œæ”¾å¼ƒç‡å¯èƒ½è¾¾åˆ°60%+

**ä¼˜åŒ–å»ºè®®**ï¼š
```vue
<!-- æ–°å¢æ­¥éª¤4ï¼šBoté…ç½® -->
<WizardStepBotConfig
  v-else-if="currentStep === 3"
  @next="handleBotConfigComplete"
  @prev="prevStep"
/>

<!-- æ–°å¢æ­¥éª¤5ï¼šå¿«é€Ÿæ˜ å°„ -->
<WizardStepQuickMapping
  v-else-if="currentStep === 4"
  :selected-channels="selectedChannels"
  :configured-bots="configuredBots"
  @next="finishWizard"
  @prev="prevStep"
/>
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- 8é¡¹æ£€æŸ¥ + **ä¸€é”®ä¿®å¤**
- è‡ªåŠ¨å®‰è£…ç¼ºå¤±ç»„ä»¶

**ç°çŠ¶**ï¼š
```python
# backend/app/api/environment_ultimate.py
# âœ… æœ‰æ£€æŸ¥åŠŸèƒ½
async def check_chromium():
    ...
    return {"passed": False, "message": "Chromiumæœªå®‰è£…", "fix_command": "playwright install chromium"}

# âŒ ä½†æ²¡æœ‰"ä¸€é”®ä¿®å¤"æŒ‰é’®çš„åç«¯æ¥å£
```

**é—®é¢˜**ï¼š
- âŒ å‰ç«¯æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œä¿®å¤å‘½ä»¤ï¼Œä½†ç”¨æˆ·ä¸çŸ¥é“å¦‚ä½•æ‰§è¡Œ
- âŒ æ²¡æœ‰`/api/environment/auto-fix`æ¥å£è‡ªåŠ¨æ‰§è¡Œä¿®å¤
- âŒ æ™®é€šç”¨æˆ·æ— æ³•ç†è§£`playwright install chromium`ç­‰å‘½ä»¤

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
@router.post("/auto-fix")
async def auto_fix_environment(fix_items: List[str]):
    """ä¸€é”®ä¿®å¤ç¯å¢ƒé—®é¢˜"""
    results = []
    
    for item in fix_items:
        if item == "chromium":
            # è‡ªåŠ¨å®‰è£…Chromium
            subprocess.run(["playwright", "install", "chromium"])
            results.append({"item": "chromium", "status": "fixed"})
        elif item == "redis":
            # è‡ªåŠ¨å¯åŠ¨Redis
            await redis_manager.start()
            results.append({"item": "redis", "status": "fixed"})
        # ... å…¶ä»–ä¿®å¤åŠ¨ä½œ
    
    return results
```

```vue
<!-- å‰ç«¯æ·»åŠ ä¸€é”®ä¿®å¤æŒ‰é’® -->
<el-button
  type="primary"
  @click="autoFixEnvironment"
  :loading="fixing"
>
  ä¸€é”®ä¿®å¤æ‰€æœ‰é—®é¢˜
</el-button>
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1-2å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- æ”¯æŒ3ç§æ ¼å¼ï¼šJSONæ–‡ä»¶æ‹–æ‹½ã€ç›´æ¥ç²˜è´´ã€æµè§ˆå™¨æ‰©å±•
- **è‡ªåŠ¨éªŒè¯Cookieæœ‰æ•ˆæ€§**
- **å‹å¥½çš„é”™è¯¯æç¤º**

**ç°çŠ¶**ï¼š
```python
# backend/app/kook/scraper.py ç¬¬96è¡Œ
try:
    cookies = cookie_parser.parse(cookie)
    if not cookie_parser.validate(cookies):
        logger.error("CookieéªŒè¯å¤±è´¥")  # âŒ åªæ˜¯æ‰“å°æ—¥å¿—ï¼Œæ²¡æœ‰è¿”å›å…·ä½“åŸå› 
        return False
except ValueError as e:
    logger.error(f"Cookieæ ¼å¼é”™è¯¯: {str(e)}")  # âŒ æŠ€æœ¯æ€§é”™è¯¯ä¿¡æ¯
    return False
```

**é—®é¢˜**ï¼š
- âŒ é”™è¯¯ä¿¡æ¯ä¸å‹å¥½ï¼ˆå¦‚"CookieéªŒè¯å¤±è´¥"ã€"ValueError"ï¼‰
- âŒ æ²¡æœ‰å‘Šè¯‰ç”¨æˆ·å¦‚ä½•ä¿®æ­£
- âŒ ç¼ºå°‘å¸¸è§é”™è¯¯çš„æ£€æµ‹ï¼ˆå¦‚ç²˜è´´äº†æ•´ä¸ªæµè§ˆå™¨Consoleè¾“å‡ºï¼‰

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
class FriendlyCookieValidator:
    def validate_and_explain(self, cookie_str: str) -> Dict:
        """éªŒè¯Cookieå¹¶è¿”å›å‹å¥½çš„é”™è¯¯è¯´æ˜"""
        
        # æ£€æµ‹å¸¸è§é”™è¯¯1ï¼šç²˜è´´äº†æ•´ä¸ªConsoleè¾“å‡º
        if "console" in cookie_str.lower() or "document.cookie" in cookie_str:
            return {
                "valid": False,
                "error": "æ£€æµ‹åˆ°æ‚¨ç²˜è´´äº†æµè§ˆå™¨æ§åˆ¶å°çš„å†…å®¹",
                "suggestion": "è¯·ä»…ç²˜è´´Cookieå€¼ï¼Œä¸è¦åŒ…å«'document.cookie='ç­‰ä»£ç ",
                "tutorial_link": "/help/cookie-export"
            }
        
        # æ£€æµ‹å¸¸è§é”™è¯¯2ï¼šJSONæ ¼å¼é”™è¯¯
        try:
            json.loads(cookie_str)
        except json.JSONDecodeError as e:
            return {
                "valid": False,
                "error": f"Cookieæ ¼å¼ä¸æ­£ç¡®ï¼ˆç¬¬{e.lineno}è¡Œï¼Œç¬¬{e.colno}åˆ—ï¼‰",
                "suggestion": "Cookieåº”è¯¥æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼ï¼Œå»ºè®®ä½¿ç”¨Chromeæ‰©å±•ä¸€é”®å¯¼å‡º",
                "tutorial_link": "/help/cookie-export"
            }
        
        # æ£€æµ‹å¸¸è§é”™è¯¯3ï¼šç¼ºå°‘å…³é”®å­—æ®µ
        cookies = json.loads(cookie_str)
        required_fields = ['name', 'value', 'domain']
        for cookie in cookies:
            missing = [f for f in required_fields if f not in cookie]
            if missing:
                return {
                    "valid": False,
                    "error": f"Cookieç¼ºå°‘å¿…éœ€å­—æ®µï¼š{', '.join(missing)}",
                    "suggestion": "è¯·ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æˆ–Chromeæ‰©å±•å¯¼å‡ºå®Œæ•´çš„Cookie",
                    "tutorial_link": "/help/cookie-export"
                }
        
        # æ£€æµ‹å¸¸è§é”™è¯¯4ï¼šCookieå·²è¿‡æœŸ
        for cookie in cookies:
            if 'expirationDate' in cookie:
                if time.time() > cookie['expirationDate']:
                    return {
                        "valid": False,
                        "error": "Cookieå·²è¿‡æœŸ",
                        "suggestion": "è¯·é‡æ–°ç™»å½•KOOKå¹¶å¯¼å‡ºæ–°çš„Cookie",
                        "tutorial_link": "/help/cookie-refresh"
                    }
        
        return {"valid": True}
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- âœ… é™„ä»¶æ–‡ä»¶ï¼ˆè‡ªåŠ¨ä¸‹è½½å¹¶è½¬å‘ï¼Œæœ€å¤§50MBï¼‰

**ç°çŠ¶**ï¼š
```python
# backend/app/kook/scraper.py ç¬¬296-307è¡Œ
# æå–å›¾ç‰‡URLå’Œé™„ä»¶æ–‡ä»¶URL
image_urls = []
file_attachments = []
if message_type == 'image' or attachments:
    for attachment in attachments:
        if attachment.get('type') == 'image':
            image_urls.append(attachment.get('url'))
        elif attachment.get('type') == 'file':
            # âœ… æå–æ–‡ä»¶é™„ä»¶ä¿¡æ¯
            file_attachments.append({...})

# âŒ ä½†æ˜¯åœ¨Workerå¤„ç†æ—¶ï¼Œfile_attachmentsæ²¡æœ‰è¢«å¤„ç†
```

```python
# backend/app/queue/worker.py
async def process_message(message):
    ...
    # âœ… å¤„ç†å›¾ç‰‡
    if message.get('image_urls'):
        ...
    
    # âŒ æ²¡æœ‰å¤„ç†æ–‡ä»¶é™„ä»¶
    # if message.get('file_attachments'):
    #     ...
```

**é—®é¢˜**ï¼š
- âŒ æ–‡ä»¶é™„ä»¶è¢«æŠ“å–ä½†æ²¡æœ‰è¢«è½¬å‘
- âŒ æ²¡æœ‰æ–‡ä»¶å¤§å°é™åˆ¶æ£€æŸ¥ï¼ˆéœ€æ±‚è¦æ±‚æœ€å¤§50MBï¼‰
- âŒ æ²¡æœ‰æ–‡ä»¶ç±»å‹è¿‡æ»¤ï¼ˆå¯èƒ½è½¬å‘å±é™©æ–‡ä»¶ï¼‰

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/processors/file_processor.pyï¼ˆæ–°å»ºï¼‰
class FileProcessor:
    MAX_FILE_SIZE = 50 * 1024 * 1024  # 50MB
    ALLOWED_TYPES = ['.pdf', '.zip', '.doc', '.docx', '.xls', '.xlsx', '.txt', ...]
    
    async def download_file(self, url: str, cookies: Dict) -> Optional[bytes]:
        """ä¸‹è½½æ–‡ä»¶é™„ä»¶"""
        # æ£€æŸ¥æ–‡ä»¶å¤§å°
        size = await self.get_file_size(url)
        if size > self.MAX_FILE_SIZE:
            raise FileTooLargeError(f"æ–‡ä»¶è¿‡å¤§ï¼š{size/1024/1024:.1f}MBï¼Œæœ€å¤§50MB")
        
        # ä¸‹è½½æ–‡ä»¶
        data = await self._download_with_progress(url, cookies)
        return data
    
    async def validate_file_type(self, filename: str) -> bool:
        """éªŒè¯æ–‡ä»¶ç±»å‹"""
        ext = Path(filename).suffix.lower()
        if ext not in self.ALLOWED_TYPES:
            logger.warning(f"ä¸å…è®¸çš„æ–‡ä»¶ç±»å‹ï¼š{ext}")
            return False
        return True

# backend/app/queue/worker.py
async def process_message(message):
    ...
    # å¤„ç†æ–‡ä»¶é™„ä»¶
    if message.get('file_attachments'):
        for file_att in message['file_attachments']:
            # éªŒè¯æ–‡ä»¶ç±»å‹
            if not file_processor.validate_file_type(file_att['name']):
                continue
            
            # ä¸‹è½½æ–‡ä»¶
            file_data = await file_processor.download_file(
                file_att['url'],
                message.get('cookies')
            )
            
            # è½¬å‘åˆ°ç›®æ ‡å¹³å°
            await forwarder.send_file(
                file_data,
                file_att['name'],
                file_att['type']
            )
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- âœ… è¡¨æƒ…ååº”ï¼ˆå®Œæ•´æ˜¾ç¤ºè°å‘äº†ä»€ä¹ˆè¡¨æƒ…ï¼‰

**ç°çŠ¶**ï¼š
```python
# backend/app/kook/scraper.py ç¬¬366-383è¡Œ
# âœ… æŠ“å–è¡¨æƒ…ååº”äº‹ä»¶
elif data.get('type') in ['MESSAGE_REACTION_ADD', 'MESSAGE_REACTION_REMOVE']:
    reaction = {
        'type': 'reaction',
        'action': 'add' or 'remove',
        'emoji': ...,
        ...
    }
    await self.message_callback(reaction)

# âŒ ä½†æ˜¯Workeræ²¡æœ‰å¤„ç†reactionç±»å‹çš„æ¶ˆæ¯
```

**é—®é¢˜**ï¼š
- âŒ è¡¨æƒ…ååº”è¢«æŠ“å–ä½†ä¸ä¼šè¢«è½¬å‘
- âŒ æ²¡æœ‰å°†å¤šä¸ªç”¨æˆ·çš„ç›¸åŒè¡¨æƒ…æ±‡æ€»ï¼ˆå¦‚"â¤ï¸ ç”¨æˆ·Aã€ç”¨æˆ·Bã€ç”¨æˆ·C"ï¼‰

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/processors/reaction_aggregator.pyï¼ˆæ–°å»ºï¼‰
class ReactionAggregator:
    def __init__(self):
        # å­˜å‚¨æ¶ˆæ¯çš„è¡¨æƒ…ååº”ï¼š{message_id: {emoji: [user1, user2, ...]}}
        self.reactions: Dict[str, Dict[str, List[str]]] = {}
    
    def add_reaction(self, message_id: str, emoji: str, user_name: str):
        """æ·»åŠ è¡¨æƒ…ååº”"""
        if message_id not in self.reactions:
            self.reactions[message_id] = {}
        if emoji not in self.reactions[message_id]:
            self.reactions[message_id][emoji] = []
        if user_name not in self.reactions[message_id][emoji]:
            self.reactions[message_id][emoji].append(user_name)
    
    def format_reactions(self, message_id: str) -> str:
        """æ ¼å¼åŒ–è¡¨æƒ…ååº”ä¸ºæ–‡æœ¬"""
        if message_id not in self.reactions:
            return ""
        
        parts = []
        for emoji, users in self.reactions[message_id].items():
            users_str = "ã€".join(users[:5])  # æœ€å¤šæ˜¾ç¤º5ä¸ªç”¨æˆ·
            if len(users) > 5:
                users_str += f" ç­‰{len(users)}äºº"
            parts.append(f"{emoji} {users_str}")
        
        return "\nè¡¨æƒ…ååº”ï¼š" + " | ".join(parts)

# backend/app/queue/worker.py
async def process_message(message):
    if message.get('type') == 'reaction':
        # æ±‡æ€»è¡¨æƒ…ååº”
        reaction_aggregator.add_reaction(
            message['message_id'],
            message['emoji'],
            message['user_id']
        )
        
        # æ¯æ”¶é›†10ä¸ªååº”æˆ–3ç§’åå‘é€ä¸€æ¬¡æ›´æ–°
        if should_send_reaction_update(message['message_id']):
            reaction_text = reaction_aggregator.format_reactions(message['message_id'])
            await forwarder.send_reaction_update(reaction_text)
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1-2å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- 3ç§ç­–ç•¥å¯é€‰ï¼šæ™ºèƒ½æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ã€ä»…ç›´ä¼ ã€ä»…ä½¿ç”¨å›¾åºŠ
- æ™ºèƒ½æ¨¡å¼ï¼šä¼˜å…ˆç›´ä¼ â†’å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å›¾åºŠâ†’å›¾åºŠä¹Ÿå¤±è´¥æ—¶ä¿å­˜æœ¬åœ°ä¸‹æ¬¡é‡è¯•

**ç°çŠ¶**ï¼š
```python
# backend/app/processors/image.py
# âœ… æœ‰åŸºç¡€çš„å›¾ç‰‡ä¸‹è½½å’Œä¸Šä¼ åŠŸèƒ½
# âŒ ä½†æ²¡æœ‰å®Œæ•´çš„ç­–ç•¥åˆ‡æ¢æœºåˆ¶
```

**é—®é¢˜**ï¼š
- âŒ æ²¡æœ‰é…ç½®é¡¹é€‰æ‹©å›¾ç‰‡å¤„ç†ç­–ç•¥
- âŒ æ™ºèƒ½æ¨¡å¼çš„fallbacké€»è¾‘ä¸å®Œæ•´
- âŒ å¤±è´¥æ—¶æ²¡æœ‰ä¿å­˜åˆ°æœ¬åœ°é˜Ÿåˆ—ä¾›é‡è¯•

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/config.py
class Settings:
    # å›¾ç‰‡å¤„ç†ç­–ç•¥
    image_strategy: str = "smart"  # smart/direct/image_bed
    
    # æ™ºèƒ½æ¨¡å¼é…ç½®
    smart_mode_direct_timeout: int = 10  # ç›´ä¼ è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    smart_mode_fallback_to_bed: bool = True  # å¤±è´¥æ—¶ä½¿ç”¨å›¾åºŠ
    smart_mode_save_failed: bool = True  # å¤±è´¥æ—¶ä¿å­˜æœ¬åœ°

# backend/app/processors/image_strategy.pyï¼ˆæ–°å»ºï¼‰
class ImageStrategy:
    async def process_image_smart(self, image_url: str, cookies: Dict) -> str:
        """æ™ºèƒ½æ¨¡å¼å¤„ç†å›¾ç‰‡"""
        logger.info(f"[æ™ºèƒ½æ¨¡å¼] å¼€å§‹å¤„ç†å›¾ç‰‡: {image_url}")
        
        # æ­¥éª¤1ï¼šå°è¯•ç›´ä¼ åˆ°ç›®æ ‡å¹³å°
        try:
            logger.info("[æ™ºèƒ½æ¨¡å¼] å°è¯•ç›´ä¼ åˆ°ç›®æ ‡å¹³å°...")
            result_url = await self._direct_upload(image_url, cookies)
            if result_url:
                logger.info(f"[æ™ºèƒ½æ¨¡å¼] âœ… ç›´ä¼ æˆåŠŸ: {result_url}")
                return result_url
        except Exception as e:
            logger.warning(f"[æ™ºèƒ½æ¨¡å¼] âš ï¸ ç›´ä¼ å¤±è´¥: {str(e)}")
        
        # æ­¥éª¤2ï¼šå¤±è´¥æ—¶ä½¿ç”¨å›¾åºŠ
        if settings.smart_mode_fallback_to_bed:
            try:
                logger.info("[æ™ºèƒ½æ¨¡å¼] å°è¯•ä½¿ç”¨å›¾åºŠ...")
                result_url = await self._upload_to_image_bed(image_url, cookies)
                if result_url:
                    logger.info(f"[æ™ºèƒ½æ¨¡å¼] âœ… å›¾åºŠä¸Šä¼ æˆåŠŸ: {result_url}")
                    return result_url
            except Exception as e:
                logger.warning(f"[æ™ºèƒ½æ¨¡å¼] âš ï¸ å›¾åºŠä¸Šä¼ å¤±è´¥: {str(e)}")
        
        # æ­¥éª¤3ï¼šå…¨éƒ¨å¤±è´¥æ—¶ä¿å­˜æœ¬åœ°ä¾›é‡è¯•
        if settings.smart_mode_save_failed:
            logger.info("[æ™ºèƒ½æ¨¡å¼] ä¿å­˜åˆ°æœ¬åœ°å¤±è´¥é˜Ÿåˆ—...")
            await self._save_to_failed_queue(image_url, cookies)
            return None
        
        return None
    
    async def process_image_direct(self, image_url: str, cookies: Dict) -> str:
        """ä»…ç›´ä¼ æ¨¡å¼"""
        logger.info(f"[ä»…ç›´ä¼ ] å¤„ç†å›¾ç‰‡: {image_url}")
        return await self._direct_upload(image_url, cookies)
    
    async def process_image_bed(self, image_url: str, cookies: Dict) -> str:
        """ä»…å›¾åºŠæ¨¡å¼"""
        logger.info(f"[ä»…å›¾åºŠ] å¤„ç†å›¾ç‰‡: {image_url}")
        return await self._upload_to_image_bed(image_url, cookies)
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1-2å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- Discordï¼šæ¯5ç§’æœ€å¤š5æ¡æ¶ˆæ¯
- Telegramï¼šæ¯ç§’æœ€å¤š30æ¡æ¶ˆæ¯  
- é£ä¹¦ï¼šæ¯ç§’æœ€å¤š20æ¡æ¶ˆæ¯

**ç°çŠ¶**ï¼š
```python
# backend/app/config.py
discord_rate_limit_calls = 5
discord_rate_limit_period = 5  # âœ… æ­£ç¡®

# âŒ æ²¡æœ‰æ‰¾åˆ°telegramå’Œfeishuçš„é™æµé…ç½®
```

**é—®é¢˜**ï¼š
- âŒ Telegramå’Œé£ä¹¦çš„é™æµç­–ç•¥æ²¡æœ‰é…ç½®
- âŒ æ²¡æœ‰é’ˆå¯¹ä¸åŒå¹³å°ä½¿ç”¨ä¸åŒçš„é™æµå™¨

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/config.py
class Settings:
    # Discordé™æµ
    discord_rate_limit_calls: int = 5
    discord_rate_limit_period: int = 5  # 5ç§’5æ¡
    
    # Telegramé™æµ
    telegram_rate_limit_calls: int = 30
    telegram_rate_limit_period: int = 1  # 1ç§’30æ¡
    
    # é£ä¹¦é™æµ
    feishu_rate_limit_calls: int = 20
    feishu_rate_limit_period: int = 1  # 1ç§’20æ¡

# backend/app/forwarders/*.py
# æ¯ä¸ªforwarderä½¿ç”¨å¯¹åº”çš„é™æµå™¨
class TelegramForwarder:
    def __init__(self):
        self.rate_limiter = rate_limiter_manager.get_limiter(
            "telegram",
            settings.telegram_rate_limit_calls,
            settings.telegram_rate_limit_period
        )

class FeishuForwarder:
    def __init__(self):
        self.rate_limiter = rate_limiter_manager.get_limiter(
            "feishu",
            settings.feishu_rate_limit_calls,
            settings.feishu_rate_limit_period
        )
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š0.5å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- é¦–æ¬¡å¯åŠ¨è®¾ç½®ä¸»å¯†ç ï¼ˆ6-20ä½ï¼‰
- å¯åŠ¨æ—¶éœ€è¦è¾“å…¥å¯†ç 
- å¿˜è®°å¯†ç å¯é€šè¿‡é‚®ç®±éªŒè¯é‡ç½®

**ç°çŠ¶**ï¼š
```bash
# æœç´¢"ä¸»å¯†ç "ç›¸å…³ä»£ç 
$ grep -r "master.*password\|main.*password" backend/ frontend/
# âŒ æ²¡æœ‰æ‰¾åˆ°ä¸»å¯†ç ç›¸å…³å®ç°
```

**é—®é¢˜**ï¼š
- âŒ åº”ç”¨å¯åŠ¨åä»»ä½•äººéƒ½å¯ä»¥è®¿é—®
- âŒ æ•æ„Ÿæ•°æ®ï¼ˆTokenã€å¯†ç ï¼‰è™½ç„¶åŠ å¯†å­˜å‚¨ï¼Œä½†æ²¡æœ‰äºŒæ¬¡éªŒè¯
- âŒ å¤šç”¨æˆ·å…±äº«ç”µè„‘æ—¶å­˜åœ¨å®‰å…¨éšæ‚£

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/utils/master_password.pyï¼ˆæ–°å»ºï¼‰
class MasterPasswordManager:
    def __init__(self):
        self.password_file = Path(settings.data_dir) / ".master_password"
        self.unlock_token: Optional[str] = None
        self.unlock_expires: Optional[float] = None
    
    def is_password_set(self) -> bool:
        """æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®ä¸»å¯†ç """
        return self.password_file.exists()
    
    def set_password(self, password: str) -> bool:
        """è®¾ç½®ä¸»å¯†ç """
        # éªŒè¯å¯†ç å¼ºåº¦
        if len(password) < 6 or len(password) > 20:
            raise ValueError("å¯†ç é•¿åº¦å¿…é¡»åœ¨6-20ä½ä¹‹é—´")
        
        # bcryptå“ˆå¸Œ
        hashed = bcrypt.hashpw(password.encode(), bcrypt.gensalt())
        self.password_file.write_bytes(hashed)
        logger.info("ä¸»å¯†ç å·²è®¾ç½®")
        return True
    
    def verify_password(self, password: str) -> bool:
        """éªŒè¯ä¸»å¯†ç """
        if not self.is_password_set():
            return True  # æœªè®¾ç½®å¯†ç æ—¶å…è®¸è®¿é—®
        
        stored = self.password_file.read_bytes()
        return bcrypt.checkpw(password.encode(), stored)
    
    def unlock(self, password: str) -> Optional[str]:
        """è§£é”åº”ç”¨ï¼ˆè¿”å›ä¸´æ—¶Tokenï¼‰"""
        if not self.verify_password(password):
            return None
        
        # ç”Ÿæˆ24å°æ—¶æœ‰æ•ˆçš„Token
        self.unlock_token = secrets.token_urlsafe(32)
        self.unlock_expires = time.time() + 86400  # 24å°æ—¶
        
        return self.unlock_token
    
    def is_unlocked(self, token: str) -> bool:
        """æ£€æŸ¥æ˜¯å¦å·²è§£é”"""
        if not self.unlock_token:
            return False
        if token != self.unlock_token:
            return False
        if time.time() > self.unlock_expires:
            return False
        return True

# backend/app/middleware/master_password_middleware.pyï¼ˆæ–°å»ºï¼‰
from fastapi import Request, HTTPException
from fastapi.responses import JSONResponse

async def master_password_middleware(request: Request, call_next):
    """ä¸»å¯†ç éªŒè¯ä¸­é—´ä»¶"""
    # æ’é™¤ç™»å½•å’Œå¥åº·æ£€æŸ¥æ¥å£
    if request.url.path in ["/api/auth/unlock", "/health", "/"]:
        return await call_next(request)
    
    # æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®ä¸»å¯†ç 
    if not master_password_manager.is_password_set():
        # æœªè®¾ç½®å¯†ç ï¼Œå…è®¸è®¿é—®
        return await call_next(request)
    
    # æ£€æŸ¥Token
    token = request.headers.get("X-Master-Token")
    if not token or not master_password_manager.is_unlocked(token):
        return JSONResponse(
            status_code=401,
            content={
                "error": "unauthorized",
                "message": "è¯·å…ˆè§£é”åº”ç”¨",
                "require_master_password": True
            }
        )
    
    return await call_next(request)

# frontend/src/views/UnlockScreen.vueï¼ˆæ–°å»ºï¼‰
<template>
  <div class="unlock-screen">
    <el-card class="unlock-card">
      <div class="lock-icon">ğŸ”’</div>
      <h2>è¯·è¾“å…¥ä¸»å¯†ç </h2>
      
      <el-form @submit.prevent="unlock">
        <el-form-item>
          <el-input
            v-model="password"
            type="password"
            placeholder="ä¸»å¯†ç "
            show-password
            autofocus
          />
        </el-form-item>
        
        <el-form-item>
          <el-checkbox v-model="remember">
            è®°ä½30å¤©
          </el-checkbox>
        </el-form-item>
        
        <el-button type="primary" @click="unlock" :loading="unlocking">
          è§£é”
        </el-button>
        
        <el-button text @click="showForgotPassword">
          å¿˜è®°å¯†ç ï¼Ÿ
        </el-button>
      </el-form>
    </el-card>
  </div>
</template>
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- è‡ªåŠ¨è®°å½•æœ€è¿‘7å¤©çš„æ‰€æœ‰æ¶ˆæ¯ID
- é‡å¯ç¨‹åºä¸ä¼šé‡å¤è½¬å‘æ—§æ¶ˆæ¯

**ç°çŠ¶**ï¼š
```python
# æœç´¢æ¶ˆæ¯å»é‡ç›¸å…³ä»£ç 
$ grep -r "message.*id.*check\|duplicate" backend/
# âŒ æ²¡æœ‰æ‰¾åˆ°æ˜ç¡®çš„æ¶ˆæ¯å»é‡æœºåˆ¶
```

**é—®é¢˜**ï¼š
- âŒ ç¨‹åºé‡å¯åå¯èƒ½é‡å¤è½¬å‘æ¶ˆæ¯
- âŒ æ²¡æœ‰æŒä¹…åŒ–å·²å¤„ç†çš„æ¶ˆæ¯ID
- âŒ æ²¡æœ‰è‡ªåŠ¨æ¸…ç†7å¤©å‰çš„è®°å½•

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/utils/message_deduplicator.pyï¼ˆæ–°å»ºï¼‰
from collections import deque
import time
import sqlite3

class MessageDeduplicator:
    def __init__(self):
        self.db_path = Path(settings.data_dir) / "message_ids.db"
        self._init_db()
        
        # å†…å­˜ç¼“å­˜ï¼ˆæœ€è¿‘1000æ¡æ¶ˆæ¯IDï¼‰
        self.recent_ids = deque(maxlen=1000)
        self._load_recent_ids()
    
    def _init_db(self):
        """åˆå§‹åŒ–æ•°æ®åº“"""
        conn = sqlite3.connect(self.db_path)
        conn.execute("""
            CREATE TABLE IF NOT EXISTS processed_messages (
                message_id TEXT PRIMARY KEY,
                processed_at INTEGER NOT NULL
            )
        """)
        conn.execute("CREATE INDEX IF NOT EXISTS idx_processed_at ON processed_messages(processed_at)")
        conn.commit()
        conn.close()
    
    def _load_recent_ids(self):
        """åŠ è½½æœ€è¿‘çš„æ¶ˆæ¯IDåˆ°å†…å­˜"""
        conn = sqlite3.connect(self.db_path)
        cursor = conn.execute("""
            SELECT message_id FROM processed_messages
            ORDER BY processed_at DESC
            LIMIT 1000
        """)
        for row in cursor:
            self.recent_ids.append(row[0])
        conn.close()
    
    def is_duplicate(self, message_id: str) -> bool:
        """æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦å·²å¤„ç†"""
        # å…ˆæ£€æŸ¥å†…å­˜ç¼“å­˜ï¼ˆå¿«é€Ÿï¼‰
        if message_id in self.recent_ids:
            return True
        
        # å†æ£€æŸ¥æ•°æ®åº“ï¼ˆæ…¢ï¼‰
        conn = sqlite3.connect(self.db_path)
        cursor = conn.execute(
            "SELECT 1 FROM processed_messages WHERE message_id = ?",
            (message_id,)
        )
        exists = cursor.fetchone() is not None
        conn.close()
        
        return exists
    
    def mark_as_processed(self, message_id: str):
        """æ ‡è®°æ¶ˆæ¯å·²å¤„ç†"""
        now = int(time.time())
        
        # æ·»åŠ åˆ°å†…å­˜ç¼“å­˜
        self.recent_ids.append(message_id)
        
        # æ·»åŠ åˆ°æ•°æ®åº“
        conn = sqlite3.connect(self.db_path)
        conn.execute(
            "INSERT OR IGNORE INTO processed_messages (message_id, processed_at) VALUES (?, ?)",
            (message_id, now)
        )
        conn.commit()
        conn.close()
    
    def cleanup_old_records(self):
        """æ¸…ç†7å¤©å‰çš„è®°å½•"""
        seven_days_ago = int(time.time()) - 7 * 86400
        
        conn = sqlite3.connect(self.db_path)
        deleted = conn.execute(
            "DELETE FROM processed_messages WHERE processed_at < ?",
            (seven_days_ago,)
        ).rowcount
        conn.commit()
        conn.close()
        
        logger.info(f"æ¸…ç†äº†{deleted}æ¡7å¤©å‰çš„æ¶ˆæ¯è®°å½•")

# backend/app/queue/worker.py
async def process_message(message):
    message_id = message.get('message_id')
    
    # æ£€æŸ¥æ˜¯å¦å·²å¤„ç†
    if message_deduplicator.is_duplicate(message_id):
        logger.debug(f"æ¶ˆæ¯{message_id}å·²å¤„ç†è¿‡ï¼Œè·³è¿‡")
        return
    
    # å¤„ç†æ¶ˆæ¯...
    ...
    
    # æ ‡è®°ä¸ºå·²å¤„ç†
    message_deduplicator.mark_as_processed(message_id)

# å®šæ—¶ä»»åŠ¡ï¼šæ¯å¤©å‡Œæ™¨3ç‚¹æ¸…ç†æ—§è®°å½•
@scheduler.scheduled_job('cron', hour=3, minute=0)
def cleanup_old_message_ids():
    message_deduplicator.cleanup_old_records()
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- æœªå‘é€çš„æ¶ˆæ¯è‡ªåŠ¨ä¿å­˜
- é‡å¯åç»§ç»­å‘é€

**ç°çŠ¶**ï¼š
```python
# backend/app/queue/worker.py
# âœ… æœ‰é‡è¯•é˜Ÿåˆ—
# âŒ ä½†æ˜¯æ²¡æœ‰æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œç¨‹åºå´©æºƒåä¼šä¸¢å¤±
```

**é—®é¢˜**ï¼š
- âŒ é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯åªåœ¨å†…å­˜ä¸­ï¼Œç¨‹åºå´©æºƒä¼šä¸¢å¤±
- âŒ Redisè™½ç„¶å¯ä»¥æŒä¹…åŒ–ï¼Œä½†å¦‚æœRedisä¹Ÿå´©æºƒä¼šä¸¢å¤±
- âŒ æ²¡æœ‰"å¾…å‘é€æ¶ˆæ¯"çš„æœ¬åœ°å¤‡ä»½

**ä¼˜åŒ–å»ºè®®**ï¼š
```python
# backend/app/utils/message_backup.pyï¼ˆæ–°å»ºï¼‰
import json
from pathlib import Path

class MessageBackup:
    def __init__(self):
        self.backup_dir = Path(settings.data_dir) / "message_backup"
        self.backup_dir.mkdir(parents=True, exist_ok=True)
        self.backup_file = self.backup_dir / "pending_messages.jsonl"
    
    def save_message(self, message: Dict):
        """ä¿å­˜å¾…å‘é€æ¶ˆæ¯åˆ°ç£ç›˜"""
        with open(self.backup_file, 'a', encoding='utf-8') as f:
            json.dump(message, f, ensure_ascii=False)
            f.write('\n')
    
    def load_pending_messages(self) -> List[Dict]:
        """åŠ è½½å¾…å‘é€æ¶ˆæ¯"""
        if not self.backup_file.exists():
            return []
        
        messages = []
        with open(self.backup_file, 'r', encoding='utf-8') as f:
            for line in f:
                if line.strip():
                    messages.append(json.loads(line))
        
        logger.info(f"ä»å¤‡ä»½åŠ è½½äº†{len(messages)}æ¡å¾…å‘é€æ¶ˆæ¯")
        return messages
    
    def remove_message(self, message_id: str):
        """ä»å¤‡ä»½ä¸­ç§»é™¤å·²å‘é€çš„æ¶ˆæ¯"""
        if not self.backup_file.exists():
            return
        
        # è¯»å–æ‰€æœ‰æ¶ˆæ¯
        messages = []
        with open(self.backup_file, 'r', encoding='utf-8') as f:
            for line in f:
                if line.strip():
                    msg = json.loads(line)
                    if msg.get('message_id') != message_id:
                        messages.append(msg)
        
        # é‡å†™æ–‡ä»¶
        with open(self.backup_file, 'w', encoding='utf-8') as f:
            for msg in messages:
                json.dump(msg, f, ensure_ascii=False)
                f.write('\n')
    
    def clear_backup(self):
        """æ¸…ç©ºå¤‡ä»½ï¼ˆæ‰€æœ‰æ¶ˆæ¯å·²å‘é€ï¼‰"""
        if self.backup_file.exists():
            self.backup_file.unlink()

# backend/app/queue/worker.py
async def start():
    logger.info("æ¶ˆæ¯Workerå¯åŠ¨")
    
    # âœ… æ¢å¤å´©æºƒå‰æœªå‘é€çš„æ¶ˆæ¯
    pending = message_backup.load_pending_messages()
    for msg in pending:
        await redis_queue.enqueue(msg)
    
    if pending:
        logger.info(f"å·²æ¢å¤{len(pending)}æ¡æœªå‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—")
    
    # å¯åŠ¨æ¶ˆè´¹å¾ªç¯
    while running:
        message = await redis_queue.dequeue()
        
        # ä¿å­˜åˆ°ç£ç›˜å¤‡ä»½
        message_backup.save_message(message)
        
        try:
            await process_message(message)
            
            # å‘é€æˆåŠŸï¼Œä»å¤‡ä»½ç§»é™¤
            message_backup.remove_message(message['message_id'])
        except Exception as e:
            logger.error(f"æ¶ˆæ¯å¤„ç†å¤±è´¥: {e}")
            # å¤±è´¥çš„æ¶ˆæ¯ä»ä¿ç•™åœ¨å¤‡ä»½ä¸­
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1-2å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- å›¾æ–‡æ•™ç¨‹ï¼ˆå¸¦æˆªå›¾æ ‡æ³¨ï¼‰
- æ­¥éª¤ç¼–å·æ¸…æ™°
- å…³é”®ç‚¹é«˜äº®æç¤º
- é…æœ‰è§†é¢‘é“¾æ¥ï¼ˆå¯é€‰è§‚çœ‹ï¼‰
- å†…ç½®FAQ
- å¸¸è§é—®é¢˜æ’æŸ¥æŒ‡å—

**ç°çŠ¶**ï¼š
```vue
<!-- frontend/src/views/Help.vue æˆ– HelpCenter.vue -->
<!-- âŒ æ–‡ä»¶å­˜åœ¨ä½†å†…å®¹ä¸å®Œæ•´ -->
```

**é—®é¢˜**ï¼š
- âŒ æ²¡æœ‰å›¾æ–‡æ•™ç¨‹å†…å®¹
- âŒ æ²¡æœ‰è§†é¢‘æ•™ç¨‹é“¾æ¥
- âŒ FAQå†…å®¹ä¸å®Œæ•´
- âŒ æ²¡æœ‰äº¤äº’å¼æ’æŸ¥å·¥å…·

**ä¼˜åŒ–å»ºè®®**ï¼š
åˆ›å»ºå®Œæ•´çš„å¸®åŠ©ä¸­å¿ƒï¼ŒåŒ…å«ï¼š

1. **å›¾æ–‡æ•™ç¨‹æ¨¡å—**ï¼š
```vue
<!-- frontend/src/components/TutorialViewer.vue -->
<template>
  <div class="tutorial-viewer">
    <el-tabs v-model="activeTutorial">
      <el-tab-pane label="Cookieè·å–æ•™ç¨‹" name="cookie">
        <div class="tutorial-content">
          <h3>æ–¹æ³•ä¸€ï¼šä½¿ç”¨Chromeæ‰©å±•ï¼ˆæ¨èï¼‰</h3>
          <el-steps direction="vertical">
            <el-step>
              <template #title>
                <span class="step-title">å®‰è£…Chromeæ‰©å±•</span>
              </template>
              <template #description>
                <div class="step-content">
                  <img src="@/assets/tutorials/step1.png" alt="å®‰è£…æ‰©å±•" />
                  <p>1. æ‰“å¼€Chromeæ‰©å±•å•†åº—</p>
                  <p>2. æœç´¢"KOOK Cookie Exporter"</p>
                  <p>3. ç‚¹å‡»"æ·»åŠ åˆ°Chrome"</p>
                  <el-alert type="info" :closable="false">
                    ğŸ’¡ æç¤ºï¼šæ‰©å±•å®Œå…¨å…è´¹ä¸”å¼€æºï¼Œä»£ç å¯åœ¨GitHubæŸ¥çœ‹
                  </el-alert>
                </div>
              </template>
            </el-step>
            
            <el-step>
              <template #title>
                <span class="step-title">ç™»å½•KOOKå¹¶å¯¼å‡ºCookie</span>
              </template>
              <template #description>
                <div class="step-content">
                  <img src="@/assets/tutorials/step2.png" alt="å¯¼å‡ºCookie" />
                  <p>1. ç™»å½•KOOKç½‘é¡µç‰ˆï¼ˆwww.kookapp.cnï¼‰</p>
                  <p>2. ç‚¹å‡»æ‰©å±•å›¾æ ‡</p>
                  <p>3. ç‚¹å‡»"å¯¼å‡ºCookie"æŒ‰é’®</p>
                  <p>4. Cookieå·²è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</p>
                </div>
              </template>
            </el-step>
            
            <el-step>
              <template #title>
                <span class="step-title">ç²˜è´´åˆ°æœ¬åº”ç”¨</span>
              </template>
              <template #description>
                <div class="step-content">
                  <p>1. è¿”å›KOOKæ¶ˆæ¯è½¬å‘ç³»ç»Ÿ</p>
                  <p>2. è¿›å…¥"è´¦å·ç®¡ç†"é¡µé¢</p>
                  <p>3. ç‚¹å‡»"æ·»åŠ è´¦å·"</p>
                  <p>4. é€‰æ‹©"Cookieå¯¼å…¥"</p>
                  <p>5. æŒ‰Ctrl+Vç²˜è´´</p>
                  <p>6. ç‚¹å‡»"éªŒè¯å¹¶æ·»åŠ "</p>
                  <el-alert type="success" :closable="false">
                    âœ… å®Œæˆï¼ç°åœ¨å¯ä»¥å¼€å§‹ç›‘å¬æ¶ˆæ¯äº†
                  </el-alert>
                </div>
              </template>
            </el-step>
          </el-steps>
          
          <div class="video-tutorial">
            <h4>ğŸ“º è§†é¢‘æ•™ç¨‹</h4>
            <el-button type="primary" @click="openVideo('cookie')">
              è§‚çœ‹å®Œæ•´è§†é¢‘æ•™ç¨‹ï¼ˆ3åˆ†é’Ÿï¼‰
            </el-button>
          </div>
          
          <div class="troubleshooting">
            <h4>é‡åˆ°é—®é¢˜ï¼Ÿ</h4>
            <el-collapse>
              <el-collapse-item title="Q: æç¤ºCookieæ— æ•ˆæ€ä¹ˆåŠï¼Ÿ" name="1">
                <p>A: è¯·ç¡®ä¿ï¼š</p>
                <ul>
                  <li>æ‚¨å·²ç»ç™»å½•KOOKç½‘é¡µç‰ˆ</li>
                  <li>Cookieæ˜¯å®Œæ•´çš„ï¼ˆæ²¡æœ‰æˆªæ–­ï¼‰</li>
                  <li>Cookieæ²¡æœ‰è¿‡æœŸï¼ˆ7å¤©å†…å¯¼å‡ºçš„ï¼‰</li>
                </ul>
                <el-button size="small" @click="runDiagnostic('cookie')">
                  è¿è¡Œè¯Šæ–­å·¥å…·
                </el-button>
              </el-collapse-item>
            </el-collapse>
          </div>
        </div>
      </el-tab-pane>
      
      <!-- å…¶ä»–æ•™ç¨‹... -->
    </el-tabs>
  </div>
</template>
```

2. **äº¤äº’å¼è¯Šæ–­å·¥å…·**ï¼š
```vue
<!-- frontend/src/components/DiagnosticTool.vue -->
<template>
  <el-dialog
    title="Cookieé—®é¢˜è¯Šæ–­"
    v-model="visible"
    width="600px"
  >
    <el-steps :active="diagnosticStep" direction="vertical">
      <el-step title="æ£€æŸ¥æ ¼å¼" status="process">
        <template #description>
          <div v-if="results.format">
            <el-icon><SuccessFilled /></el-icon>
            Cookieæ ¼å¼æ­£ç¡®
          </div>
          <div v-else>
            <el-icon><CircleCloseFilled /></el-icon>
            Cookieæ ¼å¼é”™è¯¯ï¼š{{ results.formatError }}
            <el-button size="small" @click="fixFormat">
              å°è¯•è‡ªåŠ¨ä¿®å¤
            </el-button>
          </div>
        </template>
      </el-step>
      
      <el-step title="æ£€æŸ¥å®Œæ•´æ€§">
        <template #description>
          <div v-if="results.complete">
            <el-icon><SuccessFilled /></el-icon>
            åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ
          </div>
          <div v-else>
            <el-icon><CircleCloseFilled /></el-icon>
            ç¼ºå°‘å­—æ®µï¼š{{ results.missingFields.join(', ') }}
            <p class="suggestion">
              å»ºè®®ï¼šé‡æ–°å¯¼å‡ºCookieï¼Œç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæ‰©å±•
            </p>
          </div>
        </template>
      </el-step>
      
      <el-step title="æ£€æŸ¥æœ‰æ•ˆæœŸ">
        <template #description>
          <div v-if="results.valid">
            <el-icon><SuccessFilled /></el-icon>
            Cookieæœ‰æ•ˆï¼ˆå‰©ä½™{{ results.daysLeft }}å¤©ï¼‰
          </div>
          <div v-else>
            <el-icon><CircleCloseFilled /></el-icon>
            Cookieå·²è¿‡æœŸ
            <p class="suggestion">
              è¯·é‡æ–°ç™»å½•KOOKå¹¶å¯¼å‡ºæ–°çš„Cookie
            </p>
          </div>
        </template>
      </el-step>
    </el-steps>
  </el-dialog>
</template>
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š5-7å¤©

---


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- ä¸“ä¸šçš„åº”ç”¨å›¾æ ‡
- ç»Ÿä¸€çš„å“ç‰Œè‰²
- ç°ä»£åŒ–çš„UIè®¾è®¡

**ç°çŠ¶**ï¼š
```python
# frontend/public/create_icon.py
# âœ… æœ‰ç”Ÿæˆå›¾æ ‡çš„è„šæœ¬
# âŒ ä½†ç”Ÿæˆçš„å›¾æ ‡è¿‡äºç®€å•ï¼Œä¸å¤Ÿä¸“ä¸š
```

**é—®é¢˜**ï¼š
- âŒ å›¾æ ‡è®¾è®¡è¿‡äºç®€å•
- âŒ æ²¡æœ‰å“ç‰Œè¯†åˆ«åº¦
- âŒ ç¼ºå°‘ä¸åŒå°ºå¯¸çš„é€‚é…

**ä¼˜åŒ–å»ºè®®**ï¼š
1. è˜è¯·è®¾è®¡å¸ˆè®¾è®¡ä¸“ä¸šå›¾æ ‡
2. åˆ›å»ºå“ç‰ŒæŒ‡å—æ–‡æ¡£
3. ç»Ÿä¸€UIé…è‰²æ–¹æ¡ˆ

**å·¥ä½œé‡ä¼°ç®—**ï¼šå¤–åŒ…è®¾è®¡3-5å¤©

---

## ğŸŸ  P1çº§ï¼šæ ¸å¿ƒåŠŸèƒ½ä¼˜åŒ–ï¼ˆ15é¡¹ï¼‰


**éœ€æ±‚æ–‡æ¡£è¦æ±‚**ï¼š
- ç²¾ç¡®åŒ¹é…
- åŒä¹‰è¯åŒ¹é…ï¼ˆä¸°å¯Œè¯å…¸ï¼‰
- å­ä¸²åŒ¹é…
- æ¨¡ç³ŠåŒ¹é…
- è¯­ä¹‰åŒ¹é…

**ç°çŠ¶**ï¼š
```python
# backend/app/api/smart_mapping_enhanced.py
# âœ… æœ‰åŸºç¡€çš„ç›¸ä¼¼åº¦è®¡ç®—
# âŒ ä½†åŒä¹‰è¯è¯å…¸ä¸å¤Ÿä¸°å¯Œ
```

**ä¼˜åŒ–å»ºè®®**ï¼š
æ‰©å……åŒä¹‰è¯è¯å…¸ï¼ŒåŒ…å«å¸¸è§çš„é¢‘é“åç§°å˜ä½“ï¼š

```python
CHANNEL_SYNONYMS = {
    "announcement": ["å…¬å‘Š", "é€šçŸ¥", "announce", "news", "updates"],
    "general": ["ç»¼åˆ", "é—²èŠ", "general-chat", "éšä¾¿èŠ", "æ°´åŒº"],
    "æŠ€æœ¯": ["tech", "technology", "development", "dev", "coding"],
    "æ¸¸æˆ": ["game", "gaming", "play", "æ¸¸æˆåŒº"],
    "éŸ³ä¹": ["music", "bgm", "éŸ³ä¹åˆ†äº«"],
    "è®¾è®¡": ["design", "ui", "ux", "ç¾å·¥"],
    "è¿è¥": ["operation", "ops", "è¿è¥ç»„"],
    ...  # ç»§ç»­æ‰©å……è‡³100+ç»„
}
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å¤©

---


**é—®é¢˜**ï¼š
- é•¿æ—¶é—´è¿æ¥å¯èƒ½æ–­å¼€
- æ²¡æœ‰è‡ªåŠ¨é‡è¿æœºåˆ¶
- å‰ç«¯æ²¡æœ‰å¿ƒè·³æ£€æµ‹

**ä¼˜åŒ–å»ºè®®**ï¼š
```javascript
// frontend/src/composables/useWebSocket.js
class RobustWebSocket {
  constructor(url) {
    this.url = url
    this.ws = null
    this.reconnectAttempts = 0
    this.maxReconnectAttempts = 5
    this.reconnectDelay = 1000
    this.heartbeatInterval = 30000  // 30ç§’å¿ƒè·³
    this.heartbeatTimer = null
  }
  
  connect() {
    this.ws = new WebSocket(this.url)
    
    this.ws.onopen = () => {
      console.log('WebSocket connected')
      this.reconnectAttempts = 0
      this.startHeartbeat()
    }
    
    this.ws.onclose = () => {
      console.log('WebSocket closed')
      this.stopHeartbeat()
      this.reconnect()
    }
    
    this.ws.onerror = (error) => {
      console.error('WebSocket error:', error)
    }
    
    this.ws.onmessage = (event) => {
      const data = JSON.parse(event.data)
      if (data.type === 'pong') {
        // æ”¶åˆ°å¿ƒè·³å“åº”
        return
      }
      // å¤„ç†å…¶ä»–æ¶ˆæ¯...
    }
  }
  
  startHeartbeat() {
    this.heartbeatTimer = setInterval(() => {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(JSON.stringify({ type: 'ping' }))
      }
    }, this.heartbeatInterval)
  }
  
  stopHeartbeat() {
    if (this.heartbeatTimer) {
      clearInterval(this.heartbeatTimer)
      this.heartbeatTimer = null
    }
  }
  
  reconnect() {
    if (this.reconnectAttempts >= this.maxReconnectAttempts) {
      console.error('Max reconnect attempts reached')
      return
    }
    
    setTimeout(() => {
      console.log(`Reconnecting... (${this.reconnectAttempts + 1}/${this.maxReconnectAttempts})`)
      this.reconnectAttempts++
      this.connect()
    }, this.reconnectDelay * Math.pow(2, this.reconnectAttempts))  // æŒ‡æ•°é€€é¿
  }
}
```

**å·¥ä½œé‡ä¼°ç®—**ï¼š1å¤©

---

### 15-27. å…¶ä»–P1çº§ä¼˜åŒ–é¡¹

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œä»¥ä¸‹ç®€è¦åˆ—å‡ºå…¶ä»–P1çº§ä¼˜åŒ–é¡¹ï¼š

15. **è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–** - æå‡å¤§æ•°æ®é‡æ—¥å¿—æ˜¾ç¤ºæ€§èƒ½
16. **æ•°æ®åº“æ‰¹é‡æ“ä½œä¼˜åŒ–** - å‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°
17. **Redisè¿æ¥æ± ä¼˜åŒ–** - å¤ç”¨è¿æ¥ï¼Œå‡å°‘å¼€é”€
18. **å›¾ç‰‡å¹¶å‘ä¸‹è½½é™åˆ¶** - é¿å…åŒæ—¶ä¸‹è½½è¿‡å¤šå›¾ç‰‡å¯¼è‡´å†…å­˜æº¢å‡º
19. **æ¶ˆæ¯æ ¼å¼è½¬æ¢å¢å¼º** - æ”¯æŒæ›´å¤šMarkdownè¯­æ³•
20. **Discord Embedä¼˜åŒ–** - æ›´ç¾è§‚çš„å¡ç‰‡å±•ç¤º
21. **Telegram HTMLæ ¼å¼ä¼˜åŒ–** - æ›´ä¸°å¯Œçš„æ ·å¼æ”¯æŒ
22. **é£ä¹¦å¡ç‰‡æ¨¡æ¿** - æä¾›å¤šç§é¢„è®¾æ¨¡æ¿
23. **é¢‘é“æ˜ å°„æ‹–æ‹½æ’åº** - ç”¨æˆ·å¯è°ƒæ•´æ˜ å°„ä¼˜å…ˆçº§
24. **è¿‡æ»¤è§„åˆ™æµ‹è¯•å™¨** - å®æ—¶æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼
25. **æ€§èƒ½ç›‘æ§é¢æ¿** - æ˜¾ç¤ºCPUã€å†…å­˜ã€é˜Ÿåˆ—é•¿åº¦ç­‰
26. **æ—¥å¿—æœç´¢åŠŸèƒ½** - æ”¯æŒå…³é”®è¯æœç´¢å†å²æ—¥å¿—
27. **å¯¼å‡º/å¯¼å…¥é…ç½®** - æ–¹ä¾¿å¤‡ä»½å’Œè¿ç§»

æ¯é¡¹ä¼˜åŒ–å·¥ä½œé‡ï¼š0.5-2å¤©

---

## ğŸŸ¡ P2çº§ï¼šä½“éªŒä¼˜åŒ–ï¼ˆ8é¡¹ï¼‰

### 28. æ·±è‰²ä¸»é¢˜é€‚é…ä¸å®Œæ•´ â­â­

**é—®é¢˜**ï¼š
- éƒ¨åˆ†ç»„ä»¶åœ¨æ·±è‰²æ¨¡å¼ä¸‹æ˜¾ç¤ºå¼‚å¸¸
- é¢œè‰²å¯¹æ¯”åº¦ä¸è¶³
- åˆ‡æ¢ä¸»é¢˜æ—¶æœ‰é—ªçƒ

**ä¼˜åŒ–å»ºè®®**ï¼š
å…¨é¢æ£€æŸ¥å¹¶é€‚é…æ‰€æœ‰ç»„ä»¶çš„æ·±è‰²æ¨¡å¼æ ·å¼ã€‚

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å¤©

---

### 29. å›½é™…åŒ–ç¿»è¯‘ä¸å®Œæ•´ â­â­

**é—®é¢˜**ï¼š
- è‹±æ–‡ç¿»è¯‘ç¼ºå¤±éƒ¨åˆ†å†…å®¹
- éƒ¨åˆ†ç¡¬ç¼–ç çš„ä¸­æ–‡å­—ç¬¦ä¸²
- æ²¡æœ‰è¯­è¨€åˆ‡æ¢å¼•å¯¼

**ä¼˜åŒ–å»ºè®®**ï¼š
è¡¥å…¨æ‰€æœ‰ç¿»è¯‘æ–‡æœ¬ï¼Œæ¶ˆé™¤ç¡¬ç¼–ç å­—ç¬¦ä¸²ã€‚

**å·¥ä½œé‡ä¼°ç®—**ï¼š2-3å¤©

---

### 30-35. å…¶ä»–P2çº§ä¼˜åŒ–é¡¹

30. **å“åº”å¼å¸ƒå±€ä¼˜åŒ–** - é€‚é…å°å±å¹•è®¾å¤‡
31. **åŠ¨ç”»æ•ˆæœä¼˜åŒ–** - æ›´æµç•…çš„è¿‡æ¸¡åŠ¨ç”»
32. **åŠ è½½çŠ¶æ€ä¼˜åŒ–** - æ›´å‹å¥½çš„åŠ è½½æç¤º
33. **é”™è¯¯è¾¹ç•Œå¤„ç†** - é˜²æ­¢å±€éƒ¨é”™è¯¯å¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒ
34. **æ— éšœç¢æ€§ä¼˜åŒ–** - æ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨
35. **æ€§èƒ½ä¼˜åŒ–** - ä»£ç åˆ†å‰²ã€æ‡’åŠ è½½

æ¯é¡¹ä¼˜åŒ–å·¥ä½œé‡ï¼š0.5-1å¤©

---

## ğŸ“Š ä¼˜åŒ–å·¥ä½œé‡æ€»è§ˆ

| ä¼˜å…ˆçº§ | é¡¹ç›®æ•° | æ€»å·¥ä½œé‡ | ç´§æ€¥ç¨‹åº¦ |
|--------|--------|----------|----------|
| P0 | 12é¡¹ | 22-30å¤© | ğŸ”´ é«˜ |
| P1 | 15é¡¹ | 15-25å¤© | ğŸŸ  ä¸­ |
| P2 | 8é¡¹ | 8-12å¤© | ğŸŸ¡ ä½ |
| **æ€»è®¡** | **35é¡¹** | **45-67å¤©** | - |

---

## ğŸ¯ æ¨èä¼˜åŒ–è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µï¼ˆ1-2å‘¨ï¼‰- æ ¸å¿ƒé˜»å¡é—®é¢˜
- âœ… é…ç½®å‘å¯¼æµç¨‹å®Œå–„ï¼ˆ5æ­¥ï¼‰
- âœ… ç¯å¢ƒæ£€æŸ¥ä¸€é”®ä¿®å¤
- âœ… Cookieå¯¼å…¥å‹å¥½åŒ–
- âœ… æ–‡ä»¶é™„ä»¶è½¬å‘
- âœ… ä¸»å¯†ç ä¿æŠ¤

### ç¬¬äºŒé˜¶æ®µï¼ˆ2-3å‘¨ï¼‰- æ ¸å¿ƒåŠŸèƒ½å®Œå–„
- âœ… è¡¨æƒ…ååº”è½¬å‘
- âœ… å›¾ç‰‡å¤„ç†ç­–ç•¥å®Œå–„
- âœ… æ¶ˆæ¯å»é‡æœºåˆ¶
- âœ… å´©æºƒæ¢å¤æœºåˆ¶
- âœ… é™æµç­–ç•¥ä¿®æ­£
- âœ… WebSocketç¨³å®šæ€§

### ç¬¬ä¸‰é˜¶æ®µï¼ˆ3-4å‘¨ï¼‰- ä½“éªŒæå‡
- âœ… å¸®åŠ©ç³»ç»Ÿå®Œæ•´å®ç°
- âœ… æ™ºèƒ½æ˜ å°„ä¼˜åŒ–
- âœ… æ·±è‰²ä¸»é¢˜å®Œå–„
- âœ… å›½é™…åŒ–è¡¥å…¨
- âœ… å›¾æ ‡å’Œå“ç‰Œä¼˜åŒ–

### ç¬¬å››é˜¶æ®µï¼ˆæŒç»­ï¼‰- æ€§èƒ½å’Œç»†èŠ‚
- âœ… æ€§èƒ½ç›‘æ§
- âœ… æ—¥å¿—æœç´¢
- âœ… é…ç½®å¯¼å…¥å¯¼å‡º
- âœ… å…¶ä»–ä½“éªŒä¼˜åŒ–

---

## ğŸ’¡ å…³é”®å»ºè®®

1. **ç«‹å³å¤„ç†P0çº§é—®é¢˜** - è¿™äº›é—®é¢˜ä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒå’Œäº§å“å¯ç”¨æ€§
2. **é‡ç‚¹å…³æ³¨å¸®åŠ©ç³»ç»Ÿ** - è¿™æ˜¯"é›¶æŠ€æœ¯åŸºç¡€"ç”¨æˆ·æœ€éœ€è¦çš„
3. **å®Œå–„é…ç½®å‘å¯¼** - 5æ­¥å‘å¯¼æ˜¯ç”¨æˆ·ç¬¬ä¸€å°è±¡ï¼Œå¿…é¡»å®Œç¾
4. **å¼ºåŒ–é”™è¯¯å¤„ç†** - è®©é”™è¯¯ä¿¡æ¯å¯¹æ™®é€šç”¨æˆ·å‹å¥½ä¸”å¯æ“ä½œ
5. **é‡è§†å®‰å…¨æ€§** - ä¸»å¯†ç ä¿æŠ¤æ˜¯ä¼ä¸šç”¨æˆ·çš„åˆšéœ€

---

## ğŸ“ æµ‹è¯•å»ºè®®

æ¯é¡¹ä¼˜åŒ–å®Œæˆåï¼Œå»ºè®®è¿›è¡Œä»¥ä¸‹æµ‹è¯•ï¼š

1. **åŠŸèƒ½æµ‹è¯•** - éªŒè¯åŠŸèƒ½æ­£å¸¸å·¥ä½œ
2. **ç”¨æˆ·æµ‹è¯•** - æ‰¾5-10ä¸ªéæŠ€æœ¯ç”¨æˆ·è¯•ç”¨
3. **å‹åŠ›æµ‹è¯•** - æ¨¡æ‹Ÿå¤§é‡æ¶ˆæ¯å¹¶å‘è½¬å‘
4. **å…¼å®¹æ€§æµ‹è¯•** - æµ‹è¯•Windows/macOS/Linuxä¸‰å¹³å°
5. **å®‰å…¨æµ‹è¯•** - éªŒè¯åŠ å¯†å’Œè®¤è¯æœºåˆ¶

---

## ğŸ“ æ€»ç»“

æœ¬é¡¹ç›®è™½ç„¶å·²å®Œæˆv4.0.0çš„27é¡¹ä¼˜åŒ–ï¼Œåœ¨æŠ€æœ¯æ¶æ„å’ŒåŸºç¡€åŠŸèƒ½ä¸Šå·²ç»ç›¸å½“å®Œå–„ï¼Œä½†åœ¨**æ˜“ç”¨æ€§**å’Œ**ç”¨æˆ·ä½“éªŒ**æ–¹é¢ä»æœ‰è¾ƒå¤§æå‡ç©ºé—´ã€‚

æ ¹æ®éœ€æ±‚æ–‡æ¡£"é¢å‘æ™®é€šç”¨æˆ·çš„å‚»ç“œå¼å·¥å…·"çš„å®šä½ï¼Œ**P0çº§çš„12é¡¹ä¼˜åŒ–åº”ä¼˜å…ˆå¤„ç†**ï¼Œè¿™äº›ä¼˜åŒ–å°†ç›´æ¥å†³å®šäº§å“èƒ½å¦è¾¾åˆ°"é›¶æŠ€æœ¯åŸºç¡€å¯ç”¨"çš„ç›®æ ‡ã€‚

é¢„è®¡å®Œæˆå…¨éƒ¨35é¡¹ä¼˜åŒ–éœ€è¦**2-3ä¸ªæœˆ**çš„å¼€å‘æ—¶é—´ï¼ˆ1-2åå…¨èŒå¼€å‘è€…ï¼‰ã€‚

---

**æŠ¥å‘Šå®Œæˆæ—¥æœŸ**: 2025-10-25  
**åˆ†æå·¥å…·**: æ·±åº¦ä»£ç å®¡æŸ¥ + éœ€æ±‚æ–‡æ¡£å¯¹æ¯”  
**æŠ¥å‘Šä½œè€…**: AIä»£ç åˆ†æåŠ©æ‰‹
