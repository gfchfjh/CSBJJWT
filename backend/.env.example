# KOOK消息转发系统 - 后端环境配置示例
# 复制此文件为 .env 并根据需要修改配置

# ========================================
# 应用基础配置
# ========================================
APP_NAME=KOOK消息转发系统
APP_VERSION=1.8.1
APP_ENV=production

# API服务配置
API_HOST=127.0.0.1
API_PORT=9527

# ========================================
# Redis配置
# ========================================
# Redis服务器地址
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=

# Redis数据库编号
REDIS_DB=0

# ========================================
# 数据库配置
# ========================================
# 数据存储目录（SQLite数据库、图片缓存等）
# Windows示例: C:/Users/YourName/Documents/KookForwarder/data
# Linux/macOS示例: ~/Documents/KookForwarder/data
DATA_DIR=

# ========================================
# 图片处理配置
# ========================================
# 图片存储策略: smart/direct/imgbed
IMAGE_STRATEGY=smart

# 图片最大存储空间（GB）
IMAGE_MAX_SIZE_GB=10

# 图片自动清理天数
IMAGE_CLEANUP_DAYS=7

# 图床服务器端口
IMAGE_SERVER_PORT=9528

# ========================================
# v1.8.1 性能优化配置
# ========================================
# 是否启用缓存（强烈推荐）
CACHE_ENABLED=true

# 缓存TTL配置（秒）
CACHE_TTL_LOGS=30
CACHE_TTL_STATS=60
CACHE_TTL_SYSTEM=5

# 是否启用浏览器共享上下文（内存优化-60%）
USE_SHARED_BROWSER=true

# 图片处理进程池大小（0=自动检测为CPU核心数-1）
IMAGE_PROCESS_POOL_SIZE=0

# ========================================
# Discord配置（v1.8.0池化支持）
# ========================================
# 多个Webhook用逗号分隔，可提升吞吐量+900%
# 示例: DISCORD_WEBHOOKS=url1,url2,url3
DISCORD_WEBHOOKS=

# Discord限流配置
DISCORD_RATE_LIMIT_CALLS=5
DISCORD_RATE_LIMIT_PERIOD=5

# ========================================
# Telegram配置（v1.8.0池化支持）
# ========================================
# 多个Bot Token用逗号分隔，可提升吞吐量+200%
# 示例: TELEGRAM_BOTS=token1,token2,token3
TELEGRAM_BOTS=

# Telegram限流配置
TELEGRAM_RATE_LIMIT_CALLS=30
TELEGRAM_RATE_LIMIT_PERIOD=1

# ========================================
# 飞书配置（v1.8.0池化支持）
# ========================================
# 多个应用配置用分号分隔，格式: app_id:app_secret
# 示例: FEISHU_APPS=id1:secret1;id2:secret2
FEISHU_APPS=

# 飞书限流配置
FEISHU_RATE_LIMIT_CALLS=20
FEISHU_RATE_LIMIT_PERIOD=1

# ========================================
# 验证码配置
# ========================================
# 2Captcha API Key（可选，用于自动识别验证码）
# 获取地址: https://2captcha.com
CAPTCHA_2CAPTCHA_API_KEY=

# 是否启用本地OCR识别（ddddocr）
CAPTCHA_USE_LOCAL_OCR=true

# ========================================
# 日志配置
# ========================================
# 日志级别: DEBUG/INFO/WARNING/ERROR
LOG_LEVEL=INFO

# 日志保留天数
LOG_RETENTION_DAYS=3

# 是否启用日志脱敏（推荐）
LOG_SANITIZE=true

# ========================================
# 安全配置
# ========================================
# API认证Token（建议设置，保护API安全）
# 生成方式: python -c "import secrets; print(secrets.token_urlsafe(32))"
API_TOKEN=

# 主密码哈希（由应用自动生成，无需手动配置）
# 用户首次启动时设置主密码后自动写入
MASTER_PASSWORD_HASH=

# 加密密钥（由应用自动生成，无需手动配置）
ENCRYPTION_KEY=

# ========================================
# 健康检查配置
# ========================================
# 是否启用健康检查
HEALTH_CHECK_ENABLED=true

# 健康检查间隔（秒）
HEALTH_CHECK_INTERVAL=300

# ========================================
# 邮件告警配置（可选）
# ========================================
# SMTP服务器配置
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=

# 告警接收邮箱
ALERT_EMAIL_TO=

# ========================================
# 更新检查配置
# ========================================
# 是否启用自动更新检查
AUTO_UPDATE_ENABLED=true

# 更新检查间隔（秒）
UPDATE_CHECK_INTERVAL=86400

# GitHub仓库（用于检查更新）
GITHUB_REPO=gfchfjh/CSBJJWT

# ========================================
# 消息队列配置
# ========================================
# 消息队列名称
QUEUE_NAME=kook_messages

# 最大队列长度（0=无限制）
MAX_QUEUE_SIZE=10000

# Worker并发数
WORKER_CONCURRENCY=1

# ========================================
# 消息去重配置
# ========================================
# 去重LRU缓存大小
DEDUP_CACHE_SIZE=10000

# Redis去重过期时间（秒）
DEDUP_REDIS_EXPIRE=604800

# ========================================
# 消息过滤配置
# ========================================
# 默认关键词黑名单（逗号分隔）
DEFAULT_KEYWORD_BLACKLIST=

# 默认关键词白名单（逗号分隔）
DEFAULT_KEYWORD_WHITELIST=

# ========================================
# 选择器配置
# ========================================
# 选择器配置文件路径
SELECTOR_CONFIG_FILE=backend/data/selectors.yaml

# 是否启用选择器自动重载
SELECTOR_AUTO_RELOAD=true

# ========================================
# 开发调试配置
# ========================================
# 是否启用调试模式
DEBUG=false

# 是否启用API文档（Swagger UI）
ENABLE_API_DOCS=true

# API文档路径
API_DOCS_PATH=/docs

# 是否允许跨域（开发时可启用）
ENABLE_CORS=true

# 允许的跨域来源
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# ========================================
# Playwright配置
# ========================================
# Playwright浏览器可执行文件路径（可选，留空则使用默认）
PLAYWRIGHT_BROWSER_PATH=

# 是否启用无头模式
PLAYWRIGHT_HEADLESS=true

# 浏览器启动参数
PLAYWRIGHT_ARGS=--no-sandbox,--disable-setuid-sandbox

# ========================================
# 性能监控配置（可选）
# ========================================
# 是否启用性能监控
ENABLE_PERFORMANCE_MONITORING=false

# 性能数据收集间隔（秒）
PERFORMANCE_COLLECT_INTERVAL=60

# ========================================
# 备份配置
# ========================================
# 是否启用自动备份
AUTO_BACKUP_ENABLED=true

# 备份间隔（秒）
BACKUP_INTERVAL=86400

# 备份保留数量
BACKUP_RETENTION_COUNT=7

# 备份存储路径
BACKUP_DIR=

# ========================================
# 特性开关（实验性功能）
# ========================================
# 是否启用历史消息同步
ENABLE_HISTORY_SYNC=false

# 历史消息同步时间范围（分钟）
HISTORY_SYNC_MINUTES=10

# 是否启用消息重试
ENABLE_MESSAGE_RETRY=true

# 消息重试次数
MESSAGE_RETRY_COUNT=3

# 消息重试间隔（秒）
MESSAGE_RETRY_INTERVAL=60

# ========================================
# 注意事项
# ========================================
# 1. 所有配置项均为可选，未设置时将使用默认值
# 2. 修改配置后需要重启后端服务
# 3. 生产环境请务必设置API_TOKEN以保护API安全
# 4. 敏感信息（密码、Token）请勿提交到代码仓库
# 5. v1.8.1新增性能优化配置，建议启用CACHE_ENABLED和USE_SHARED_BROWSER
# 6. 多Webhook/Bot配置可显著提升转发吞吐量
